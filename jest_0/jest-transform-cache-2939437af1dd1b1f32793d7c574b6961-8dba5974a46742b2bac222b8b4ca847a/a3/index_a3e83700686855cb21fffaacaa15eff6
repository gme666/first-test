34a21e2297059a55e866c7720b072a7d
Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _react=require('react');var _react2=_interopRequireDefault(_react);
var _reactNative=require('react-native');






var _propTypes=require('prop-types');var _propTypes2=_interopRequireDefault(_propTypes);
var _xdate=require('xdate');var _xdate2=_interopRequireDefault(_xdate);

var _interface=require('../interface');
var _dateutils=require('../dateutils');var _dateutils2=_interopRequireDefault(_dateutils);
var _calendarList=require('../calendar-list');var _calendarList2=_interopRequireDefault(_calendarList);
var _reservationList=require('./reservation-list');var _reservationList2=_interopRequireDefault(_reservationList);
var _style=require('./style');var _style2=_interopRequireDefault(_style);
var _input=require('../input');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}

var HEADER_HEIGHT=104;
var KNOB_HEIGHT=24;


var viewPropTypes=_reactNative.ViewPropTypes||_reactNative.View.propTypes;var

AgendaView=function(_Component){_inherits(AgendaView,_Component);





















































function AgendaView(props){_classCallCheck(this,AgendaView);var _this=_possibleConstructorReturn(this,(AgendaView.__proto__||Object.getPrototypeOf(AgendaView)).call(this,
props));
_this.styles=(0,_style2.default)(props.theme);
var windowSize=_reactNative.Dimensions.get('window');
_this.viewHeight=windowSize.height;
_this.viewWidth=windowSize.width;
_this.scrollTimeout=undefined;
_this.headerState='idle';
_this.state={
scrollY:new _reactNative.Animated.Value(0),
calendarScrollable:false,
firstResevationLoad:false,
selectedDay:(0,_interface.parseDate)(_this.props.selected)||(0,_xdate2.default)(true),
topDay:(0,_interface.parseDate)(_this.props.selected)||(0,_xdate2.default)(true)};

_this.currentMonth=_this.state.selectedDay.clone();
_this.onLayout=_this.onLayout.bind(_this);
_this.onScrollPadLayout=_this.onScrollPadLayout.bind(_this);
_this.onTouchStart=_this.onTouchStart.bind(_this);
_this.onTouchEnd=_this.onTouchEnd.bind(_this);
_this.onStartDrag=_this.onStartDrag.bind(_this);
_this.onSnapAfterDrag=_this.onSnapAfterDrag.bind(_this);
_this.knobTracker=new _input.VelocityTracker();
_this.state.scrollY.addListener(function(_ref){var value=_ref.value;return _this.knobTracker.add(value);});return _this;
}_createClass(AgendaView,[{key:'calendarOffset',value:function calendarOffset()

{
return 90-this.viewHeight/2;
}},{key:'initialScrollPadPosition',value:function initialScrollPadPosition()

{
return Math.max(0,this.viewHeight-HEADER_HEIGHT);
}},{key:'setScrollPadPosition',value:function setScrollPadPosition(

y,animated){
this.scrollPad._component.scrollTo({x:0,y:y,animated:animated});
}},{key:'onScrollPadLayout',value:function onScrollPadLayout()

{



this.setScrollPadPosition(this.initialScrollPadPosition(),false);
}},{key:'onLayout',value:function onLayout(

event){
this.viewHeight=event.nativeEvent.layout.height;
this.viewWidth=event.nativeEvent.layout.width;
this.calendar.scrollToDay(this.state.selectedDay.clone(),this.calendarOffset(),false);
this.forceUpdate();
}},{key:'onTouchStart',value:function onTouchStart()

{
this.headerState='touched';
if(this.knob){
this.knob.setNativeProps({style:{opacity:0.5}});
}
}},{key:'onTouchEnd',value:function onTouchEnd()

{
if(this.knob){
this.knob.setNativeProps({style:{opacity:1}});
}

if(this.headerState==='touched'){
this.setScrollPadPosition(0,true);
this.enableCalendarScrolling();
}
this.headerState='idle';
}},{key:'onStartDrag',value:function onStartDrag()

{
this.headerState='dragged';
this.knobTracker.reset();
}},{key:'onSnapAfterDrag',value:function onSnapAfterDrag(

e){

this.onTouchEnd();
var currentY=e.nativeEvent.contentOffset.y;
this.knobTracker.add(currentY);
var projectedY=currentY+this.knobTracker.estimateSpeed()*250;
var maxY=this.initialScrollPadPosition();
var snapY=projectedY>maxY/2?maxY:0;
this.setScrollPadPosition(snapY,true);
if(snapY===0){
this.enableCalendarScrolling();
}
}},{key:'onVisibleMonthsChange',value:function onVisibleMonthsChange(

months){var _this2=this;
if(this.props.items&&!this.state.firstResevationLoad){
clearTimeout(this.scrollTimeout);
this.scrollTimeout=setTimeout(function(){
if(_this2.props.loadItemsForMonth&&_this2._isMounted){
_this2.props.loadItemsForMonth(months[0]);
}
},200);
}
}},{key:'loadReservations',value:function loadReservations(

props){var _this3=this;
if((!props.items||!Object.keys(props.items).length)&&!this.state.firstResevationLoad){
this.setState({
firstResevationLoad:true},
function(){
if(_this3.props.loadItemsForMonth){
_this3.props.loadItemsForMonth((0,_interface.xdateToData)(_this3.state.selectedDay));
}
});
}
}},{key:'componentWillMount',value:function componentWillMount()

{
this._isMounted=true;
this.loadReservations(this.props);
}},{key:'componentWillUnmount',value:function componentWillUnmount()

{
this._isMounted=false;
}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(

props){
if(props.items){
this.setState({
firstResevationLoad:false});

}else{
this.loadReservations(props);
}
}},{key:'enableCalendarScrolling',value:function enableCalendarScrolling()

{
this.setState({
calendarScrollable:true});









this.calendar.scrollToDay(this.state.selectedDay,this.calendarOffset()+1,true);
}},{key:'_chooseDayFromCalendar',value:function _chooseDayFromCalendar(

d){
this.chooseDay(d,!this.state.calendarScrollable);
}},{key:'chooseDay',value:function chooseDay(

d,optimisticScroll){
var day=(0,_interface.parseDate)(d);
this.setState({
calendarScrollable:false,
selectedDay:day.clone()});

if(!optimisticScroll){
this.setState({
topDay:day.clone()});

}
this.setScrollPadPosition(this.initialScrollPadPosition(),true);
this.calendar.scrollToDay(day,this.calendarOffset(),true);
if(this.props.loadItemsForMonth){
this.props.loadItemsForMonth((0,_interface.xdateToData)(day));
}
if(this.props.onDayPress){
this.props.onDayPress((0,_interface.xdateToData)(day));
}
}},{key:'renderReservations',value:function renderReservations()

{var _this4=this;
return(
_react2.default.createElement(_reservationList2.default,{
rowHasChanged:this.props.rowHasChanged,
renderItem:this.props.renderItem,
renderDay:this.props.renderDay,
renderEmptyDate:this.props.renderEmptyDate,
reservations:this.props.items,
selectedDay:this.state.selectedDay,
topDay:this.state.topDay,
onDayChange:this.onDayChange.bind(this),
onScroll:function onScroll(){},
ref:function ref(c){return _this4.list=c;},
theme:this.props.theme}));


}},{key:'onDayChange',value:function onDayChange(

day){
var newDate=(0,_interface.parseDate)(day);
var withAnimation=_dateutils2.default.sameMonth(newDate,this.state.selectedDay);
this.calendar.scrollToDay(day,this.calendarOffset(),withAnimation);
this.setState({
selectedDay:(0,_interface.parseDate)(day)});


if(this.props.onDayChange){
this.props.onDayChange((0,_interface.xdateToData)(newDate));
}
}},{key:'render',value:function render()

{var _this5=this;
var agendaHeight=Math.max(0,this.viewHeight-HEADER_HEIGHT);
var weekDaysNames=_dateutils2.default.weekDayNames(this.props.firstDay);
var weekdaysStyle=[this.styles.weekdays,{
opacity:this.state.scrollY.interpolate({
inputRange:[agendaHeight-HEADER_HEIGHT,agendaHeight],
outputRange:[0,1],
extrapolate:'clamp'}),

transform:[{translateY:this.state.scrollY.interpolate({
inputRange:[Math.max(0,agendaHeight-HEADER_HEIGHT),agendaHeight],
outputRange:[-HEADER_HEIGHT,0],
extrapolate:'clamp'})}]}];



var headerTranslate=this.state.scrollY.interpolate({
inputRange:[0,agendaHeight],
outputRange:[agendaHeight,0],
extrapolate:'clamp'});


var contentTranslate=this.state.scrollY.interpolate({
inputRange:[0,agendaHeight],
outputRange:[0,agendaHeight/2],
extrapolate:'clamp'});


var headerStyle=[
this.styles.header,
{bottom:agendaHeight,transform:[{translateY:headerTranslate}]}];


var shouldAllowDragging=!this.props.hideKnob&&!this.state.calendarScrollable;
var scrollPadPosition=(shouldAllowDragging?HEADER_HEIGHT:0)-KNOB_HEIGHT;

var scrollPadStyle={
position:'absolute',
width:80,
height:KNOB_HEIGHT,
top:scrollPadPosition,
left:(this.viewWidth-80)/2};


var knob=_react2.default.createElement(_reactNative.View,{style:this.styles.knobContainer});

if(!this.props.hideKnob){
var knobView=this.props.renderKnob?this.props.renderKnob():_react2.default.createElement(_reactNative.View,{style:this.styles.knob});
knob=this.state.calendarScrollable?null:
_react2.default.createElement(_reactNative.View,{style:this.styles.knobContainer},
_react2.default.createElement(_reactNative.View,{ref:function ref(c){return _this5.knob=c;}},knobView));


}

return(
_react2.default.createElement(_reactNative.View,{onLayout:this.onLayout,style:[this.props.style,{flex:1,overflow:'hidden'}]},
_react2.default.createElement(_reactNative.View,{style:this.styles.reservations},
this.renderReservations()),

_react2.default.createElement(_reactNative.Animated.View,{style:headerStyle},
_react2.default.createElement(_reactNative.Animated.View,{style:{flex:1,transform:[{translateY:contentTranslate}]}},
_react2.default.createElement(_calendarList2.default,{
theme:this.props.theme,
onVisibleMonthsChange:this.onVisibleMonthsChange.bind(this),
ref:function ref(c){return _this5.calendar=c;},
minDate:this.props.minDate,
maxDate:this.props.maxDate,
selected:[this.state.selectedDay],
current:this.currentMonth,
markedDates:this.props.markedDates||this.props.items,
markingType:this.props.markingType,
onDayPress:this._chooseDayFromCalendar.bind(this),
scrollingEnabled:this.state.calendarScrollable,
hideExtraDays:this.state.calendarScrollable,
firstDay:this.props.firstDay,
monthFormat:this.props.monthFormat,
pastScrollRange:this.props.pastScrollRange,
futureScrollRange:this.props.futureScrollRange})),


knob),

_react2.default.createElement(_reactNative.Animated.View,{style:weekdaysStyle},
weekDaysNames.map(function(day){return(
_react2.default.createElement(_reactNative.Text,{key:day,style:_this5.styles.weekday,numberOfLines:1},day));})),


_react2.default.createElement(_reactNative.Animated.ScrollView,{
ref:function ref(c){return _this5.scrollPad=c;},
overScrollMode:'never',
showsHorizontalScrollIndicator:false,
showsVerticalScrollIndicator:false,
style:scrollPadStyle,
scrollEventThrottle:1,
onTouchStart:this.onTouchStart,
onTouchEnd:this.onTouchEnd,
onScrollBeginDrag:this.onStartDrag,
onScrollEndDrag:this.onSnapAfterDrag,
onScroll:_reactNative.Animated.event(
[{nativeEvent:{contentOffset:{y:this.state.scrollY}}}],
{useNativeDriver:true})},


_react2.default.createElement(_reactNative.View,{style:{height:agendaHeight+KNOB_HEIGHT},onLayout:this.onScrollPadLayout}))));



}}]);return AgendaView;}(_react.Component);AgendaView.propTypes={theme:_propTypes2.default.object,style:viewPropTypes.style,items:_propTypes2.default.object,loadItemsForMonth:_propTypes2.default.func,onDayPress:_propTypes2.default.func,onDaychange:_propTypes2.default.func,renderItem:_propTypes2.default.func,renderDay:_propTypes2.default.func,renderKnob:_propTypes2.default.func,renderEmptyDay:_propTypes2.default.func,rowHasChanged:_propTypes2.default.func,pastScrollRange:_propTypes2.default.number,futureScrollRange:_propTypes2.default.number,selected:_propTypes2.default.any,minDate:_propTypes2.default.any,maxDate:_propTypes2.default.any,markedDates:_propTypes2.default.object,markingType:_propTypes2.default.string,hideKnob:_propTypes2.default.bool,monthFormat:_propTypes2.default.string};exports.default=AgendaView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkhFQURFUl9IRUlHSFQiLCJLTk9CX0hFSUdIVCIsInZpZXdQcm9wVHlwZXMiLCJwcm9wVHlwZXMiLCJBZ2VuZGFWaWV3IiwicHJvcHMiLCJzdHlsZXMiLCJ0aGVtZSIsIndpbmRvd1NpemUiLCJnZXQiLCJ2aWV3SGVpZ2h0IiwiaGVpZ2h0Iiwidmlld1dpZHRoIiwid2lkdGgiLCJzY3JvbGxUaW1lb3V0IiwidW5kZWZpbmVkIiwiaGVhZGVyU3RhdGUiLCJzdGF0ZSIsInNjcm9sbFkiLCJWYWx1ZSIsImNhbGVuZGFyU2Nyb2xsYWJsZSIsImZpcnN0UmVzZXZhdGlvbkxvYWQiLCJzZWxlY3RlZERheSIsInNlbGVjdGVkIiwidG9wRGF5IiwiY3VycmVudE1vbnRoIiwiY2xvbmUiLCJvbkxheW91dCIsImJpbmQiLCJvblNjcm9sbFBhZExheW91dCIsIm9uVG91Y2hTdGFydCIsIm9uVG91Y2hFbmQiLCJvblN0YXJ0RHJhZyIsIm9uU25hcEFmdGVyRHJhZyIsImtub2JUcmFja2VyIiwiYWRkTGlzdGVuZXIiLCJ2YWx1ZSIsImFkZCIsIk1hdGgiLCJtYXgiLCJ5IiwiYW5pbWF0ZWQiLCJzY3JvbGxQYWQiLCJfY29tcG9uZW50Iiwic2Nyb2xsVG8iLCJ4Iiwic2V0U2Nyb2xsUGFkUG9zaXRpb24iLCJpbml0aWFsU2Nyb2xsUGFkUG9zaXRpb24iLCJldmVudCIsIm5hdGl2ZUV2ZW50IiwibGF5b3V0IiwiY2FsZW5kYXIiLCJzY3JvbGxUb0RheSIsImNhbGVuZGFyT2Zmc2V0IiwiZm9yY2VVcGRhdGUiLCJrbm9iIiwic2V0TmF0aXZlUHJvcHMiLCJzdHlsZSIsIm9wYWNpdHkiLCJlbmFibGVDYWxlbmRhclNjcm9sbGluZyIsInJlc2V0IiwiZSIsImN1cnJlbnRZIiwiY29udGVudE9mZnNldCIsInByb2plY3RlZFkiLCJlc3RpbWF0ZVNwZWVkIiwibWF4WSIsInNuYXBZIiwibW9udGhzIiwiaXRlbXMiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwibG9hZEl0ZW1zRm9yTW9udGgiLCJfaXNNb3VudGVkIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInNldFN0YXRlIiwibG9hZFJlc2VydmF0aW9ucyIsImQiLCJjaG9vc2VEYXkiLCJvcHRpbWlzdGljU2Nyb2xsIiwiZGF5Iiwib25EYXlQcmVzcyIsInJvd0hhc0NoYW5nZWQiLCJyZW5kZXJJdGVtIiwicmVuZGVyRGF5IiwicmVuZGVyRW1wdHlEYXRlIiwib25EYXlDaGFuZ2UiLCJjIiwibGlzdCIsIm5ld0RhdGUiLCJ3aXRoQW5pbWF0aW9uIiwic2FtZU1vbnRoIiwiYWdlbmRhSGVpZ2h0Iiwid2Vla0RheXNOYW1lcyIsIndlZWtEYXlOYW1lcyIsImZpcnN0RGF5Iiwid2Vla2RheXNTdHlsZSIsIndlZWtkYXlzIiwiaW50ZXJwb2xhdGUiLCJpbnB1dFJhbmdlIiwib3V0cHV0UmFuZ2UiLCJleHRyYXBvbGF0ZSIsInRyYW5zZm9ybSIsInRyYW5zbGF0ZVkiLCJoZWFkZXJUcmFuc2xhdGUiLCJjb250ZW50VHJhbnNsYXRlIiwiaGVhZGVyU3R5bGUiLCJoZWFkZXIiLCJib3R0b20iLCJzaG91bGRBbGxvd0RyYWdnaW5nIiwiaGlkZUtub2IiLCJzY3JvbGxQYWRQb3NpdGlvbiIsInNjcm9sbFBhZFN0eWxlIiwicG9zaXRpb24iLCJ0b3AiLCJsZWZ0Iiwia25vYkNvbnRhaW5lciIsImtub2JWaWV3IiwicmVuZGVyS25vYiIsImZsZXgiLCJvdmVyZmxvdyIsInJlc2VydmF0aW9ucyIsInJlbmRlclJlc2VydmF0aW9ucyIsIm9uVmlzaWJsZU1vbnRoc0NoYW5nZSIsIm1pbkRhdGUiLCJtYXhEYXRlIiwibWFya2VkRGF0ZXMiLCJtYXJraW5nVHlwZSIsIl9jaG9vc2VEYXlGcm9tQ2FsZW5kYXIiLCJtb250aEZvcm1hdCIsInBhc3RTY3JvbGxSYW5nZSIsImZ1dHVyZVNjcm9sbFJhbmdlIiwibWFwIiwid2Vla2RheSIsInVzZU5hdGl2ZURyaXZlciIsIm9iamVjdCIsImZ1bmMiLCJvbkRheWNoYW5nZSIsInJlbmRlckVtcHR5RGF5IiwibnVtYmVyIiwiYW55Iiwic3RyaW5nIiwiYm9vbCJdLCJtYXBwaW5ncyI6InVqQkFBQSw0QjtBQUNBOzs7Ozs7O0FBT0EscUM7QUFDQSw0Qjs7QUFFQTtBQUNBLHVDO0FBQ0EsOEM7QUFDQSxtRDtBQUNBLDhCO0FBQ0EsK0I7O0FBRUEsR0FBTUEsZUFBZ0IsR0FBdEI7QUFDQSxHQUFNQyxhQUFjLEVBQXBCOzs7QUFHQSxHQUFNQyxlQUFnQiw0QkFBaUIsa0JBQUtDLFNBQTVDLEM7O0FBRXFCQyxVOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFzRG5CLG9CQUFZQyxLQUFaLENBQW1CO0FBQ1hBLEtBRFc7QUFFakIsTUFBS0MsTUFBTCxDQUFjLG9CQUFpQkQsTUFBTUUsS0FBdkIsQ0FBZDtBQUNBLEdBQU1DLFlBQWEsd0JBQVdDLEdBQVgsQ0FBZSxRQUFmLENBQW5CO0FBQ0EsTUFBS0MsVUFBTCxDQUFrQkYsV0FBV0csTUFBN0I7QUFDQSxNQUFLQyxTQUFMLENBQWlCSixXQUFXSyxLQUE1QjtBQUNBLE1BQUtDLGFBQUwsQ0FBcUJDLFNBQXJCO0FBQ0EsTUFBS0MsV0FBTCxDQUFtQixNQUFuQjtBQUNBLE1BQUtDLEtBQUwsQ0FBYTtBQUNYQyxRQUFTLEdBQUksdUJBQVNDLEtBQWIsQ0FBbUIsQ0FBbkIsQ0FERTtBQUVYQyxtQkFBb0IsS0FGVDtBQUdYQyxvQkFBcUIsS0FIVjtBQUlYQyxZQUFhLHlCQUFVLE1BQUtqQixLQUFMLENBQVdrQixRQUFyQixHQUFrQyxvQkFBTSxJQUFOLENBSnBDO0FBS1hDLE9BQVEseUJBQVUsTUFBS25CLEtBQUwsQ0FBV2tCLFFBQXJCLEdBQWtDLG9CQUFNLElBQU4sQ0FML0IsQ0FBYjs7QUFPQSxNQUFLRSxZQUFMLENBQW9CLE1BQUtSLEtBQUwsQ0FBV0ssV0FBWCxDQUF1QkksS0FBdkIsRUFBcEI7QUFDQSxNQUFLQyxRQUFMLENBQWdCLE1BQUtBLFFBQUwsQ0FBY0MsSUFB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QixvQkFBVWtFLElBYlosQ0FlakJ2RCxXQUFZLG9CQUFVdUQsSUFmTCxDQWlCakJDLFlBQWEsb0JBQVVELElBakJOLENBbUJqQnJELFdBQVksb0JBQVVxRCxJQW5CTCxDQXFCakJwRCxVQUFXLG9CQUFVb0QsSUFyQkosQ0F1QmpCbEIsV0FBWSxvQkFBVWtCLElBdkJMLENBeUJqQkUsZUFBZ0Isb0JBQVVGLElBekJULENBMkJqQnRELGNBQWUsb0JBQVVzRCxJQTNCUixDQThCakJOLGdCQUFpQixvQkFBVVMsTUE5QlYsQ0FpQ2pCUixrQkFBbUIsb0JBQVVRLE1BakNaLENBb0NqQnRILFNBQVUsb0JBQVV1SCxHQXBDSCxDQXNDakJoQixRQUFTLG9CQUFVZ0IsR0F0Q0YsQ0F3Q2pCZixRQUFTLG9CQUFVZSxHQXhDRixDQTJDakJkLFlBQWEsb0JBQVVTLE1BM0NOLENBNkNqQlIsWUFBYSxvQkFBVWMsTUE3Q04sQ0FnRGpCL0IsU0FBVSxvQkFBVWdDLElBaERILENBa0RqQmIsWUFBYSxvQkFBVVksTUFsRE4sQyxpQkFEQTNJLFUiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHtDb21wb25lbnR9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG4gIFRleHQsXG4gIFZpZXcsXG4gIERpbWVuc2lvbnMsXG4gIEFuaW1hdGVkLFxuICBWaWV3UHJvcFR5cGVzLFxufSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBYRGF0ZSBmcm9tICd4ZGF0ZSc7XG5cbmltcG9ydCB7cGFyc2VEYXRlLCB4ZGF0ZVRvRGF0YX0gZnJvbSAnLi4vaW50ZXJmYWNlJztcbmltcG9ydCBkYXRldXRpbHMgZnJvbSAnLi4vZGF0ZXV0aWxzJztcbmltcG9ydCBDYWxlbmRhckxpc3QgZnJvbSAnLi4vY2FsZW5kYXItbGlzdCc7XG5pbXBvcnQgUmVzZXJ2YXRpb25zTGlzdCBmcm9tICcuL3Jlc2VydmF0aW9uLWxpc3QnO1xuaW1wb3J0IHN0eWxlQ29uc3RydWN0b3IgZnJvbSAnLi9zdHlsZSc7XG5pbXBvcnQgeyBWZWxvY2l0eVRyYWNrZXIgfSBmcm9tICcuLi9pbnB1dCc7XG5cbmNvbnN0IEhFQURFUl9IRUlHSFQgPSAxMDQ7XG5jb25zdCBLTk9CX0hFSUdIVCA9IDI0O1xuXG4vL0ZhbGxiYWNrIHdoZW4gUk4gdmVyc2lvbiBpcyA8IDAuNDRcbmNvbnN0IHZpZXdQcm9wVHlwZXMgPSBWaWV3UHJvcFR5cGVzIHx8IFZpZXcucHJvcFR5cGVzO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBZ2VuZGFWaWV3IGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAvLyBTcGVjaWZ5IHRoZW1lIHByb3BlcnRpZXMgdG8gb3ZlcnJpZGUgc3BlY2lmaWMgc3R5bGVzIGZvciBjYWxlbmRhciBwYXJ0cy4gRGVmYXVsdCA9IHt9XG4gICAgdGhlbWU6IFByb3BUeXBlcy5vYmplY3QsXG5cbiAgICAvLyBhZ2VuZGEgY29udGFpbmVyIHN0eWxlXG4gICAgc3R5bGU6IHZpZXdQcm9wVHlwZXMuc3R5bGUsXG5cbiAgICAvLyB0aGUgbGlzdCBvZiBpdGVtcyB0aGF0IGhhdmUgdG8gYmUgZGlzcGxheWVkIGluIGFnZW5kYS4gSWYgeW91IHdhbnQgdG8gcmVuZGVyIGl0ZW0gYXMgZW1wdHkgZGF0ZVxuICAgIC8vIHRoZSB2YWx1ZSBvZiBkYXRlIGtleSBoYXMgdG8gYmUgYW4gZW1wdHkgYXJyYXkgW10uIElmIHRoZXJlIGV4aXN0cyBubyB2YWx1ZSBmb3IgZGF0ZSBrZXkgaXQgaXNcbiAgICAvLyBjb25zaWRlcmVkIHRoYXQgdGhlIGRhdGUgaW4gcXVlc3Rpb24gaXMgbm90IHlldCBsb2FkZWRcbiAgICBpdGVtczogUHJvcFR5cGVzLm9iamVjdCxcblxuICAgIC8vIGNhbGxiYWNrIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiBpdGVtcyBmb3IgYSBjZXJ0YWluIG1vbnRoIHNob3VsZCBiZSBsb2FkZWQgKG1vbnRoIGJlY2FtZSB2aXNpYmxlKVxuICAgIGxvYWRJdGVtc0Zvck1vbnRoOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAvLyBjYWxsYmFjayB0aGF0IGdldHMgY2FsbGVkIG9uIGRheSBwcmVzc1xuICAgIG9uRGF5UHJlc3M6IFByb3BUeXBlcy5mdW5jLFxuICAgIC8vIGNhbGxiYWNrIHRoYXQgZ2V0cyBjYWxsZWQgd2hlbiBkYXkgY2hhbmdlcyB3aGlsZSBzY3JvbGxpbmcgYWdlbmRhIGxpc3RcbiAgICBvbkRheWNoYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLy8gc3BlY2lmeSBob3cgZWFjaCBpdGVtIHNob3VsZCBiZSByZW5kZXJlZCBpbiBhZ2VuZGFcbiAgICByZW5kZXJJdGVtOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAvLyBzcGVjaWZ5IGhvdyBlYWNoIGRhdGUgc2hvdWxkIGJlIHJlbmRlcmVkLiBkYXkgY2FuIGJlIHVuZGVmaW5lZCBpZiB0aGUgaXRlbSBpcyBub3QgZmlyc3QgaW4gdGhhdCBkYXkuXG4gICAgcmVuZGVyRGF5OiBQcm9wVHlwZXMuZnVuYyxcbiAgICAvLyBzcGVjaWZ5IGhvdyBhZ2VuZGEga25vYiBzaG91bGQgbG9vayBsaWtlXG4gICAgcmVuZGVyS25vYjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLy8gc3BlY2lmeSBob3cgZW1wdHkgZGF0ZSBjb250ZW50IHdpdGggbm8gaXRlbXMgc2hvdWxkIGJlIHJlbmRlcmVkXG4gICAgcmVuZGVyRW1wdHlEYXk6IFByb3BUeXBlcy5mdW5jLFxuICAgIC8vIHNwZWNpZnkgeW91ciBpdGVtIGNvbXBhcmlzb24gZnVuY3Rpb24gZm9yIGluY3JlYXNlZCBwZXJmb3JtYW5jZVxuICAgIHJvd0hhc0NoYW5nZWQ6IFByb3BUeXBlcy5mdW5jLFxuICAgIFxuICAgIC8vIE1heCBhbW91bnQgb2YgbW9udGhzIGFsbG93ZWQgdG8gc2Nyb2xsIHRvIHRoZSBwYXN0LiBEZWZhdWx0ID0gNTBcbiAgICBwYXN0U2Nyb2xsUmFuZ2U6IFByb3BUeXBlcy5udW1iZXIsXG5cbiAgICAvLyBNYXggYW1vdW50IG9mIG1vbnRocyBhbGxvd2VkIHRvIHNjcm9sbCB0byB0aGUgZnV0dXJlLiBEZWZhdWx0ID0gNTBcbiAgICBmdXR1cmVTY3JvbGxSYW5nZTogUHJvcFR5cGVzLm51bWJlcixcblxuICAgIC8vIGluaXRpYWxseSBzZWxlY3RlZCBkYXlcbiAgICBzZWxlY3RlZDogUHJvcFR5cGVzLmFueSxcbiAgICAvLyBNaW5pbXVtIGRhdGUgdGhhdCBjYW4gYmUgc2VsZWN0ZWQsIGRhdGVzIGJlZm9yZSBtaW5EYXRlIHdpbGwgYmUgZ3JheWVkIG91dC4gRGVmYXVsdCA9IHVuZGVmaW5lZFxuICAgIG1pbkRhdGU6IFByb3BUeXBlcy5hbnksXG4gICAgLy8gTWF4aW11bSBkYXRlIHRoYXQgY2FuIGJlIHNlbGVjdGVkLCBkYXRlcyBhZnRlciBtYXhEYXRlIHdpbGwgYmUgZ3JheWVkIG91dC4gRGVmYXVsdCA9IHVuZGVmaW5lZFxuICAgIG1heERhdGU6IFByb3BUeXBlcy5hbnksXG4gICAgXG4gICAgLy8gQ29sbGVjdGlvbiBvZiBkYXRlcyB0aGF0IGhhdmUgdG8gYmUgbWFya2VkLiBEZWZhdWx0ID0gaXRlbXNcbiAgICBtYXJrZWREYXRlczogUHJvcFR5cGVzLm9iamVjdCxcbiAgICAvLyBPcHRpb25hbCBtYXJraW5nIHR5cGUgaWYgY3VzdG9tIG1hcmtlZERhdGVzIGFyZSBwcm92aWRlZFxuICAgIG1hcmtpbmdUeXBlOiBQcm9wVHlwZXMuc3RyaW5nLFxuXG4gICAgLy8gSGlkZSBrbm9iIGJ1dHRvbi4gRGVmYXVsdCA9IGZhbHNlXG4gICAgaGlkZUtub2I6IFByb3BUeXBlcy5ib29sLFxuICAgIC8vIE1vbnRoIGZvcm1hdCBpbiBjYWxlbmRhciB0aXRsZS4gRm9ybWF0dGluZyB2YWx1ZXM6IGh0dHA6Ly9hcnNoYXcuY29tL3hkYXRlLyNGb3JtYXR0aW5nXG4gICAgbW9udGhGb3JtYXQ6IFByb3BUeXBlcy5zdHJpbmdcbiAgfTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0eWxlcyA9IHN0eWxlQ29uc3RydWN0b3IocHJvcHMudGhlbWUpO1xuICAgIGNvbnN0IHdpbmRvd1NpemUgPSBEaW1lbnNpb25zLmdldCgnd2luZG93Jyk7XG4gICAgdGhpcy52aWV3SGVpZ2h0ID0gd2luZG93U2l6ZS5oZWlnaHQ7XG4gICAgdGhpcy52aWV3V2lkdGggPSB3aW5kb3dTaXplLndpZHRoO1xuICAgIHRoaXMuc2Nyb2xsVGltZW91dCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhlYWRlclN0YXRlID0gJ2lkbGUnO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBzY3JvbGxZOiBuZXcgQW5pbWF0ZWQuVmFsdWUoMCksXG4gICAgICBjYWxlbmRhclNjcm9sbGFibGU6IGZhbHNlLFxuICAgICAgZmlyc3RSZXNldmF0aW9uTG9hZDogZmFsc2UsXG4gICAgICBzZWxlY3RlZERheTogcGFyc2VEYXRlKHRoaXMucHJvcHMuc2VsZWN0ZWQpIHx8IFhEYXRlKHRydWUpLFxuICAgICAgdG9wRGF5OiBwYXJzZURhdGUodGhpcy5wcm9wcy5zZWxlY3RlZCkgfHwgWERhdGUodHJ1ZSksXG4gICAgfTtcbiAgICB0aGlzLmN1cnJlbnRNb250aCA9IHRoaXMuc3RhdGUuc2VsZWN0ZWREYXkuY2xvbmUoKTtcbiAgICB0aGlzLm9uTGF5b3V0ID0gdGhpcy5vbkxheW91dC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25TY3JvbGxQYWRMYXlvdXQgPSB0aGlzLm9uU2Nyb2xsUGFkTGF5b3V0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5vblRvdWNoU3RhcnQgPSB0aGlzLm9uVG91Y2hTdGFydC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25Ub3VjaEVuZCA9IHRoaXMub25Ub3VjaEVuZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25TdGFydERyYWcgPSB0aGlzLm9uU3RhcnREcmFnLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vblNuYXBBZnRlckRyYWcgPSB0aGlzLm9uU25hcEFmdGVyRHJhZy5iaW5kKHRoaXMpO1xuICAgIHRoaXMua25vYlRyYWNrZXIgPSBuZXcgVmVsb2NpdHlUcmFja2VyKCk7XG4gICAgdGhpcy5zdGF0ZS5zY3JvbGxZLmFkZExpc3RlbmVyKCh7dmFsdWV9KSA9PiB0aGlzLmtub2JUcmFja2VyLmFkZCh2YWx1ZSkpO1xuICB9XG5cbiAgY2FsZW5kYXJPZmZzZXQoKSB7XG4gICAgcmV0dXJuIDkwIC0gKHRoaXMudmlld0hlaWdodCAvIDIpO1xuICB9XG5cbiAgaW5pdGlhbFNjcm9sbFBhZFBvc2l0aW9uKCkge1xuICAgIHJldHVybiBNYXRoLm1heCgwLCB0aGlzLnZpZXdIZWlnaHQgLSBIRUFERVJfSEVJR0hUKTtcbiAgfVxuXG4gIHNldFNjcm9sbFBhZFBvc2l0aW9uKHksIGFuaW1hdGVkKSB7XG4gICAgdGhpcy5zY3JvbGxQYWQuX2NvbXBvbmVudC5zY3JvbGxUbyh7eDogMCwgeSwgYW5pbWF0ZWR9KTtcbiAgfVxuXG4gIG9uU2Nyb2xsUGFkTGF5b3V0KCkge1xuICAgIC8vIFdoZW4gdXNlciB0b3VjaGVzIGtub2IsIHRoZSBhY3R1YWwgY29tcG9uZW50IHRoYXQgcmVjZWl2ZXMgdG91Y2ggZXZlbnRzIGlzIGEgU2Nyb2xsVmlldy5cbiAgICAvLyBJdCBuZWVkcyB0byBiZSBzY3JvbGxlZCB0byB0aGUgYm90dG9tLCBzbyB0aGF0IHdoZW4gdXNlciBtb3ZlcyBmaW5nZXIgZG93bndhcmRzLFxuICAgIC8vIHNjcm9sbCBwb3NpdGlvbiBhY3R1YWxseSBjaGFuZ2VzIChpdCB3b3VsZCBzdGF5IGF0IDAsIHdoZW4gc2Nyb2xsZWQgdG8gdGhlIHRvcCkuXG4gICAgdGhpcy5zZXRTY3JvbGxQYWRQb3NpdGlvbih0aGlzLmluaXRpYWxTY3JvbGxQYWRQb3NpdGlvbigpLCBmYWxzZSk7XG4gIH1cblxuICBvbkxheW91dChldmVudCkge1xuICAgIHRoaXMudmlld0hlaWdodCA9IGV2ZW50Lm5hdGl2ZUV2ZW50LmxheW91dC5oZWlnaHQ7XG4gICAgdGhpcy52aWV3V2lkdGggPSBldmVudC5uYXRpdmVFdmVudC5sYXlvdXQud2lkdGg7XG4gICAgdGhpcy5jYWxlbmRhci5zY3JvbGxUb0RheSh0aGlzLnN0YXRlLnNlbGVjdGVkRGF5LmNsb25lKCksIHRoaXMuY2FsZW5kYXJPZmZzZXQoKSwgZmFsc2UpO1xuICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcbiAgfVxuXG4gIG9uVG91Y2hTdGFydCgpIHtcbiAgICB0aGlzLmhlYWRlclN0YXRlID0gJ3RvdWNoZWQnO1xuICAgIGlmICh0aGlzLmtub2IpIHtcbiAgICAgIHRoaXMua25vYi5zZXROYXRpdmVQcm9wcyh7c3R5bGU6IHsgb3BhY2l0eTogMC41IH19KTtcbiAgICB9XG4gIH1cblxuICBvblRvdWNoRW5kKCkge1xuICAgIGlmICh0aGlzLmtub2IpIHtcbiAgICAgIHRoaXMua25vYi5zZXROYXRpdmVQcm9wcyh7c3R5bGU6IHsgb3BhY2l0eTogMSB9fSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaGVhZGVyU3RhdGUgPT09ICd0b3VjaGVkJykge1xuICAgICAgdGhpcy5zZXRTY3JvbGxQYWRQb3NpdGlvbigwLCB0cnVlKTtcbiAgICAgIHRoaXMuZW5hYmxlQ2FsZW5kYXJTY3JvbGxpbmcoKTtcbiAgICB9XG4gICAgdGhpcy5oZWFkZXJTdGF0ZSA9ICdpZGxlJztcbiAgfVxuXG4gIG9uU3RhcnREcmFnKCkge1xuICAgIHRoaXMuaGVhZGVyU3RhdGUgPSAnZHJhZ2dlZCc7XG4gICAgdGhpcy5rbm9iVHJhY2tlci5yZXNldCgpO1xuICB9XG5cbiAgb25TbmFwQWZ0ZXJEcmFnKGUpIHtcbiAgICAvLyBvbiBBbmRyb2lkIG9uVG91Y2hFbmQgaXMgbm90IGNhbGxlZCBpZiBkcmFnZ2luZyB3YXMgc3RhcnRlZFxuICAgIHRoaXMub25Ub3VjaEVuZCgpO1xuICAgIGNvbnN0IGN1cnJlbnRZID0gZS5uYXRpdmVFdmVudC5jb250ZW50T2Zmc2V0Lnk7XG4gICAgdGhpcy5rbm9iVHJhY2tlci5hZGQoY3VycmVudFkpO1xuICAgIGNvbnN0IHByb2plY3RlZFkgPSBjdXJyZW50WSArIHRoaXMua25vYlRyYWNrZXIuZXN0aW1hdGVTcGVlZCgpICogMjUwLyptcyovO1xuICAgIGNvbnN0IG1heFkgPSB0aGlzLmluaXRpYWxTY3JvbGxQYWRQb3NpdGlvbigpO1xuICAgIGNvbnN0IHNuYXBZID0gKHByb2plY3RlZFkgPiBtYXhZIC8gMikgPyBtYXhZIDogMDtcbiAgICB0aGlzLnNldFNjcm9sbFBhZFBvc2l0aW9uKHNuYXBZLCB0cnVlKTtcbiAgICBpZiAoc25hcFkgPT09IDApIHtcbiAgICAgIHRoaXMuZW5hYmxlQ2FsZW5kYXJTY3JvbGxpbmcoKTtcbiAgICB9XG4gIH1cblxuICBvblZpc2libGVNb250aHNDaGFuZ2UobW9udGhzKSB7XG4gICAgaWYgKHRoaXMucHJvcHMuaXRlbXMgJiYgIXRoaXMuc3RhdGUuZmlyc3RSZXNldmF0aW9uTG9hZCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2Nyb2xsVGltZW91dCk7XG4gICAgICB0aGlzLnNjcm9sbFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMubG9hZEl0ZW1zRm9yTW9udGggJiYgdGhpcy5faXNNb3VudGVkKSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5sb2FkSXRlbXNGb3JNb250aChtb250aHNbMF0pO1xuICAgICAgICB9XG4gICAgICB9LCAyMDApO1xuICAgIH1cbiAgfVxuXG4gIGxvYWRSZXNlcnZhdGlvbnMocHJvcHMpIHtcbiAgICBpZiAoKCFwcm9wcy5pdGVtcyB8fCAhT2JqZWN0LmtleXMocHJvcHMuaXRlbXMpLmxlbmd0aCkgJiYgIXRoaXMuc3RhdGUuZmlyc3RSZXNldmF0aW9uTG9hZCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGZpcnN0UmVzZXZhdGlvbkxvYWQ6IHRydWVcbiAgICAgIH0sICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMubG9hZEl0ZW1zRm9yTW9udGgpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLmxvYWRJdGVtc0Zvck1vbnRoKHhkYXRlVG9EYXRhKHRoaXMuc3RhdGUuc2VsZWN0ZWREYXkpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgIHRoaXMuX2lzTW91bnRlZCA9IHRydWU7XG4gICAgdGhpcy5sb2FkUmVzZXJ2YXRpb25zKHRoaXMucHJvcHMpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5faXNNb3VudGVkID0gZmFsc2U7XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKHByb3BzKSB7XG4gICAgaWYgKHByb3BzLml0ZW1zKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgZmlyc3RSZXNldmF0aW9uTG9hZDogZmFsc2VcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmxvYWRSZXNlcnZhdGlvbnMocHJvcHMpO1xuICAgIH1cbiAgfVxuXG4gIGVuYWJsZUNhbGVuZGFyU2Nyb2xsaW5nKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgY2FsZW5kYXJTY3JvbGxhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLy8gRW5sYXJnZSBjYWxlbmRhck9mZnNldCBoZXJlIGFzIGEgd29ya2Fyb3VuZCBvbiBpT1MgdG8gZm9yY2UgcmVwYWludC5cbiAgICAvLyBPdGhlcndpc2UgdGhlIG1vbnRoIGFmdGVyIGN1cnJlbnQgb25lIG9yIGJlZm9yZSBjdXJyZW50IG9uZSByZW1haW5zIGludmlzaWJsZS5cbiAgICAvLyBUaGUgcHJvYmxlbSBpcyBjYXVzZWQgYnkgb3ZlcmZsb3c6ICdoaWRkZW4nIHN0eWxlLCB3aGljaCB3ZSBuZWVkIGZvciBkcmFnZ2luZ1xuICAgIC8vIHRvIGJlIHBlcmZvcm1hbnQuXG4gICAgLy8gQW5vdGhlciB3b3JraW5nIHNvbHV0aW9uIGZvciB0aGlzIGJ1ZyB3b3VsZCBiZSB0byBzZXQgcmVtb3ZlQ2xpcHBlZFN1YnZpZXdzPXtmYWxzZX1cbiAgICAvLyBpbiBDYWxlbmRhckxpc3QgbGlzdFZpZXcsIGJ1dCB0aGF0IG1pZ2h0IGltcGFjdCBwZXJmb3JtYW5jZSB3aGVuIHNjcm9sbGluZ1xuICAgIC8vIG1vbnRoIGxpc3QgaW4gZXhwYW5kZWQgQ2FsZW5kYXJMaXN0LlxuICAgIC8vIEZ1cnRoZXIgaW5mbyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svcmVhY3QtbmF0aXZlL2lzc3Vlcy8xODMxXG4gICAgdGhpcy5jYWxlbmRhci5zY3JvbGxUb0RheSh0aGlzLnN0YXRlLnNlbGVjdGVkRGF5LCB0aGlzLmNhbGVuZGFyT2Zmc2V0KCkgKyAxLCB0cnVlKTtcbiAgfVxuXG4gIF9jaG9vc2VEYXlGcm9tQ2FsZW5kYXIoZCkge1xuICAgIHRoaXMuY2hvb3NlRGF5KGQsICF0aGlzLnN0YXRlLmNhbGVuZGFyU2Nyb2xsYWJsZSk7XG4gIH1cblxuICBjaG9vc2VEYXkoZCwgb3B0aW1pc3RpY1Njcm9sbCkge1xuICAgIGNvbnN0IGRheSA9IHBhcnNlRGF0ZShkKTtcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGNhbGVuZGFyU2Nyb2xsYWJsZTogZmFsc2UsXG4gICAgICBzZWxlY3RlZERheTogZGF5LmNsb25lKClcbiAgICB9KTtcbiAgICBpZiAoIW9wdGltaXN0aWNTY3JvbGwpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICB0b3BEYXk6IGRheS5jbG9uZSgpXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5zZXRTY3JvbGxQYWRQb3NpdGlvbih0aGlzLmluaXRpYWxTY3JvbGxQYWRQb3NpdGlvbigpLCB0cnVlKTtcbiAgICB0aGlzLmNhbGVuZGFyLnNjcm9sbFRvRGF5KGRheSwgdGhpcy5jYWxlbmRhck9mZnNldCgpLCB0cnVlKTtcbiAgICBpZiAodGhpcy5wcm9wcy5sb2FkSXRlbXNGb3JNb250aCkge1xuICAgICAgdGhpcy5wcm9wcy5sb2FkSXRlbXNGb3JNb250aCh4ZGF0ZVRvRGF0YShkYXkpKTtcbiAgICB9XG4gICAgaWYgKHRoaXMucHJvcHMub25EYXlQcmVzcykge1xuICAgICAgdGhpcy5wcm9wcy5vbkRheVByZXNzKHhkYXRlVG9EYXRhKGRheSkpO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlclJlc2VydmF0aW9ucygpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPFJlc2VydmF0aW9uc0xpc3RcbiAgICAgICAgcm93SGFzQ2hhbmdlZD17dGhpcy5wcm9wcy5yb3dIYXNDaGFuZ2VkfVxuICAgICAgICByZW5kZXJJdGVtPXt0aGlzLnByb3BzLnJlbmRlckl0ZW19XG4gICAgICAgIHJlbmRlckRheT17dGhpcy5wcm9wcy5yZW5kZXJEYXl9XG4gICAgICAgIHJlbmRlckVtcHR5RGF0ZT17dGhpcy5wcm9wcy5yZW5kZXJFbXB0eURhdGV9XG4gICAgICAgIHJlc2VydmF0aW9ucz17dGhpcy5wcm9wcy5pdGVtc31cbiAgICAgICAgc2VsZWN0ZWREYXk9e3RoaXMuc3RhdGUuc2VsZWN0ZWREYXl9XG4gICAgICAgIHRvcERheT17dGhpcy5zdGF0ZS50b3BEYXl9XG4gICAgICAgIG9uRGF5Q2hhbmdlPXt0aGlzLm9uRGF5Q2hhbmdlLmJpbmQodGhpcyl9XG4gICAgICAgIG9uU2Nyb2xsPXsoKSA9PiB7fX1cbiAgICAgICAgcmVmPXsoYykgPT4gdGhpcy5saXN0ID0gY31cbiAgICAgICAgdGhlbWU9e3RoaXMucHJvcHMudGhlbWV9XG4gICAgICAvPlxuICAgICk7XG4gIH1cblxuICBvbkRheUNoYW5nZShkYXkpIHtcbiAgICBjb25zdCBuZXdEYXRlID0gcGFyc2VEYXRlKGRheSk7XG4gICAgY29uc3Qgd2l0aEFuaW1hdGlvbiA9IGRhdGV1dGlscy5zYW1lTW9udGgobmV3RGF0ZSwgdGhpcy5zdGF0ZS5zZWxlY3RlZERheSk7XG4gICAgdGhpcy5jYWxlbmRhci5zY3JvbGxUb0RheShkYXksIHRoaXMuY2FsZW5kYXJPZmZzZXQoKSwgd2l0aEFuaW1hdGlvbik7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzZWxlY3RlZERheTogcGFyc2VEYXRlKGRheSlcbiAgICB9KTtcblxuICAgIGlmICh0aGlzLnByb3BzLm9uRGF5Q2hhbmdlKSB7XG4gICAgICB0aGlzLnByb3BzLm9uRGF5Q2hhbmdlKHhkYXRlVG9EYXRhKG5ld0RhdGUpKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgYWdlbmRhSGVpZ2h0ID0gTWF0aC5tYXgoMCwgdGhpcy52aWV3SGVpZ2h0IC0gSEVBREVSX0hFSUdIVCk7XG4gICAgY29uc3Qgd2Vla0RheXNOYW1lcyA9IGRhdGV1dGlscy53ZWVrRGF5TmFtZXModGhpcy5wcm9wcy5maXJzdERheSk7XG4gICAgY29uc3Qgd2Vla2RheXNTdHlsZSA9IFt0aGlzLnN0eWxlcy53ZWVrZGF5cywge1xuICAgICAgb3BhY2l0eTogdGhpcy5zdGF0ZS5zY3JvbGxZLmludGVycG9sYXRlKHtcbiAgICAgICAgaW5wdXRSYW5nZTogW2FnZW5kYUhlaWdodCAtIEhFQURFUl9IRUlHSFQsIGFnZW5kYUhlaWdodF0sXG4gICAgICAgIG91dHB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgICAgfSksXG4gICAgICB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVk6IHRoaXMuc3RhdGUuc2Nyb2xsWS5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFtNYXRoLm1heCgwLCBhZ2VuZGFIZWlnaHQgLSBIRUFERVJfSEVJR0hUKSwgYWdlbmRhSGVpZ2h0XSxcbiAgICAgICAgb3V0cHV0UmFuZ2U6IFstSEVBREVSX0hFSUdIVCwgMF0sXG4gICAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgICAgfSl9XVxuICAgIH1dO1xuXG4gICAgY29uc3QgaGVhZGVyVHJhbnNsYXRlID0gdGhpcy5zdGF0ZS5zY3JvbGxZLmludGVycG9sYXRlKHtcbiAgICAgIGlucHV0UmFuZ2U6IFswLCBhZ2VuZGFIZWlnaHRdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFthZ2VuZGFIZWlnaHQsIDBdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSk7XG5cbiAgICBjb25zdCBjb250ZW50VHJhbnNsYXRlID0gdGhpcy5zdGF0ZS5zY3JvbGxZLmludGVycG9sYXRlKHtcbiAgICAgIGlucHV0UmFuZ2U6IFswLCBhZ2VuZGFIZWlnaHRdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFswLCBhZ2VuZGFIZWlnaHQvMl0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KTtcblxuICAgIGNvbnN0IGhlYWRlclN0eWxlID0gW1xuICAgICAgdGhpcy5zdHlsZXMuaGVhZGVyLFxuICAgICAgeyBib3R0b206IGFnZW5kYUhlaWdodCwgdHJhbnNmb3JtOiBbeyB0cmFuc2xhdGVZOiBoZWFkZXJUcmFuc2xhdGUgfV0gfSxcbiAgICBdO1xuXG4gICAgY29uc3Qgc2hvdWxkQWxsb3dEcmFnZ2luZyA9ICF0aGlzLnByb3BzLmhpZGVLbm9iICYmICF0aGlzLnN0YXRlLmNhbGVuZGFyU2Nyb2xsYWJsZTtcbiAgICBjb25zdCBzY3JvbGxQYWRQb3NpdGlvbiA9IChzaG91bGRBbGxvd0RyYWdnaW5nID8gSEVBREVSX0hFSUdIVCAgOiAwKSAtIEtOT0JfSEVJR0hUO1xuXG4gICAgY29uc3Qgc2Nyb2xsUGFkU3R5bGUgPSB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJyxcbiAgICAgIHdpZHRoOiA4MCxcbiAgICAgIGhlaWdodDogS05PQl9IRUlHSFQsXG4gICAgICB0b3A6IHNjcm9sbFBhZFBvc2l0aW9uLFxuICAgICAgbGVmdDogKHRoaXMudmlld1dpZHRoIC0gODApIC8gMixcbiAgICB9O1xuXG4gICAgbGV0IGtub2IgPSAoPFZpZXcgc3R5bGU9e3RoaXMuc3R5bGVzLmtub2JDb250YWluZXJ9Lz4pO1xuXG4gICAgaWYgKCF0aGlzLnByb3BzLmhpZGVLbm9iKSB7XG4gICAgICBjb25zdCBrbm9iVmlldyA9IHRoaXMucHJvcHMucmVuZGVyS25vYiA/IHRoaXMucHJvcHMucmVuZGVyS25vYigpIDogKDxWaWV3IHN0eWxlPXt0aGlzLnN0eWxlcy5rbm9ifS8+KTtcbiAgICAgIGtub2IgPSB0aGlzLnN0YXRlLmNhbGVuZGFyU2Nyb2xsYWJsZSA/IG51bGwgOiAoXG4gICAgICAgIDxWaWV3IHN0eWxlPXt0aGlzLnN0eWxlcy5rbm9iQ29udGFpbmVyfT5cbiAgICAgICAgICA8VmlldyByZWY9eyhjKSA9PiB0aGlzLmtub2IgPSBjfT57a25vYlZpZXd9PC9WaWV3PlxuICAgICAgICA8L1ZpZXc+XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiAoXG4gICAgICA8VmlldyBvbkxheW91dD17dGhpcy5vbkxheW91dH0gc3R5bGU9e1t0aGlzLnByb3BzLnN0eWxlLCB7ZmxleDogMSwgb3ZlcmZsb3c6ICdoaWRkZW4nfV19PlxuICAgICAgICA8VmlldyBzdHlsZT17dGhpcy5zdHlsZXMucmVzZXJ2YXRpb25zfT5cbiAgICAgICAgICB7dGhpcy5yZW5kZXJSZXNlcnZhdGlvbnMoKX1cbiAgICAgICAgPC9WaWV3PlxuICAgICAgICA8QW5pbWF0ZWQuVmlldyBzdHlsZT17aGVhZGVyU3R5bGV9PlxuICAgICAgICAgIDxBbmltYXRlZC5WaWV3IHN0eWxlPXt7ZmxleDoxLCB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVk6IGNvbnRlbnRUcmFuc2xhdGUgfV19fT5cbiAgICAgICAgICAgIDxDYWxlbmRhckxpc3RcbiAgICAgICAgICAgICAgdGhlbWU9e3RoaXMucHJvcHMudGhlbWV9XG4gICAgICAgICAgICAgIG9uVmlzaWJsZU1vbnRoc0NoYW5nZT17dGhpcy5vblZpc2libGVNb250aHNDaGFuZ2UuYmluZCh0aGlzKX1cbiAgICAgICAgICAgICAgcmVmPXsoYykgPT4gdGhpcy5jYWxlbmRhciA9IGN9XG4gICAgICAgICAgICAgIG1pbkRhdGU9e3RoaXMucHJvcHMubWluRGF0ZX1cbiAgICAgICAgICAgICAgbWF4RGF0ZT17dGhpcy5wcm9wcy5tYXhEYXRlfVxuICAgICAgICAgICAgICBzZWxlY3RlZD17W3RoaXMuc3RhdGUuc2VsZWN0ZWREYXldfVxuICAgICAgICAgICAgICBjdXJyZW50PXt0aGlzLmN1cnJlbnRNb250aH1cbiAgICAgICAgICAgICAgbWFya2VkRGF0ZXM9e3RoaXMucHJvcHMubWFya2VkRGF0ZXMgfHwgdGhpcy5wcm9wcy5pdGVtc31cbiAgICAgICAgICAgICAgbWFya2luZ1R5cGU9e3RoaXMucHJvcHMubWFya2luZ1R5cGV9XG4gICAgICAgICAgICAgIG9uRGF5UHJlc3M9e3RoaXMuX2Nob29zZURheUZyb21DYWxlbmRhci5iaW5kKHRoaXMpfVxuICAgICAgICAgICAgICBzY3JvbGxpbmdFbmFibGVkPXt0aGlzLnN0YXRlLmNhbGVuZGFyU2Nyb2xsYWJsZX1cbiAgICAgICAgICAgICAgaGlkZUV4dHJhRGF5cz17dGhpcy5zdGF0ZS5jYWxlbmRhclNjcm9sbGFibGV9XG4gICAgICAgICAgICAgIGZpcnN0RGF5PXt0aGlzLnByb3BzLmZpcnN0RGF5fVxuICAgICAgICAgICAgICBtb250aEZvcm1hdD17dGhpcy5wcm9wcy5tb250aEZvcm1hdH1cbiAgICAgICAgICAgICAgcGFzdFNjcm9sbFJhbmdlPXt0aGlzLnByb3BzLnBhc3RTY3JvbGxSYW5nZX1cbiAgICAgICAgICAgICAgZnV0dXJlU2Nyb2xsUmFuZ2U9e3RoaXMucHJvcHMuZnV0dXJlU2Nyb2xsUmFuZ2V9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgICAgICAgICB7a25vYn1cbiAgICAgICAgPC9BbmltYXRlZC5WaWV3PlxuICAgICAgICA8QW5pbWF0ZWQuVmlldyBzdHlsZT17d2Vla2RheXNTdHlsZX0+XG4gICAgICAgICAge3dlZWtEYXlzTmFtZXMubWFwKChkYXkpID0+IChcbiAgICAgICAgICAgIDxUZXh0IGtleT17ZGF5fSBzdHlsZT17dGhpcy5zdHlsZXMud2Vla2RheX0gbnVtYmVyT2ZMaW5lcz17MX0+e2RheX08L1RleHQ+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvQW5pbWF0ZWQuVmlldz5cbiAgICAgICAgPEFuaW1hdGVkLlNjcm9sbFZpZXdcbiAgICAgICAgICByZWY9e2MgPT4gdGhpcy5zY3JvbGxQYWQgPSBjfVxuICAgICAgICAgIG92ZXJTY3JvbGxNb2RlPSduZXZlcidcbiAgICAgICAgICBzaG93c0hvcml6b250YWxTY3JvbGxJbmRpY2F0b3I9e2ZhbHNlfVxuICAgICAgICAgIHNob3dzVmVydGljYWxTY3JvbGxJbmRpY2F0b3I9e2ZhbHNlfVxuICAgICAgICAgIHN0eWxlPXtzY3JvbGxQYWRTdHlsZX1cbiAgICAgICAgICBzY3JvbGxFdmVudFRocm90dGxlPXsxfVxuICAgICAgICAgIG9uVG91Y2hTdGFydD17dGhpcy5vblRvdWNoU3RhcnR9XG4gICAgICAgICAgb25Ub3VjaEVuZD17dGhpcy5vblRvdWNoRW5kfVxuICAgICAgICAgIG9uU2Nyb2xsQmVnaW5EcmFnPXt0aGlzLm9uU3RhcnREcmFnfVxuICAgICAgICAgIG9uU2Nyb2xsRW5kRHJhZz17dGhpcy5vblNuYXBBZnRlckRyYWd9XG4gICAgICAgICAgb25TY3JvbGw9e0FuaW1hdGVkLmV2ZW50KFxuICAgICAgICAgICAgW3sgbmF0aXZlRXZlbnQ6IHsgY29udGVudE9mZnNldDogeyB5OiB0aGlzLnN0YXRlLnNjcm9sbFkgfSB9IH1dLFxuICAgICAgICAgICAgeyB1c2VOYXRpdmVEcml2ZXI6IHRydWUgfSxcbiAgICAgICAgICApfVxuICAgICAgICA+XG4gICAgICAgICAgPFZpZXcgc3R5bGU9e3toZWlnaHQ6IGFnZW5kYUhlaWdodCArIEtOT0JfSEVJR0hUfX0gb25MYXlvdXQ9e3RoaXMub25TY3JvbGxQYWRMYXlvdXR9IC8+XG4gICAgICAgIDwvQW5pbWF0ZWQuU2Nyb2xsVmlldz5cbiAgICAgIDwvVmlldz5cbiAgICApO1xuICB9XG59XG4iXX0=