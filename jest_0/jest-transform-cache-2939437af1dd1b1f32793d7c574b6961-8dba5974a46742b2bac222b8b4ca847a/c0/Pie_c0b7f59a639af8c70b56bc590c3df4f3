6f3c0223e52ae7ac6fcd61d80aa93f9d
Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[typeof Symbol==='function'?Symbol.iterator:'@@iterator'](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if((typeof Symbol==='function'?Symbol.iterator:'@@iterator')in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();














var _react=require('react');var _react2=_interopRequireDefault(_react);
var _reactNative=require('react-native');
var _reactNativeSvg=require('react-native-svg');var _reactNativeSvg2=_interopRequireDefault(_reactNativeSvg);
var _util=require('./util');
var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);
require('babel-polyfill');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}
var Pie=require('paths-js/pie');var

PieChart=function(_Component){_inherits(PieChart,_Component);function PieChart(){_classCallCheck(this,PieChart);return _possibleConstructorReturn(this,(PieChart.__proto__||Object.getPrototypeOf(PieChart)).apply(this,arguments));}_createClass(PieChart,[{key:'color',value:function color(
























i){
var color=this.props.color||this.props.options&&this.props.options.color;
if(Array.isArray(color)){
if(i>=color.length){
var pallete=_util.Colors.mix(color[i%color.length]);
return _util.Colors.string((0,_util.cyclic)(pallete,i));
}
return color[i];
}else{
if(color&&!_lodash2.default.isString(color))color=color.color;
var _pallete=this.props.pallete||this.props.options&&this.props.options.pallete||_util.Colors.mix(color||'#9ac7f7');
return _util.Colors.string((0,_util.cyclic)(_pallete,i));
}
}},{key:'render',value:function render()





{var _this2=this;
var noDataMsg=this.props.noDataMessage||'No data available';
if(this.props.data===undefined)return _react2.default.createElement(_reactNative.Text,null,noDataMsg);

var options=new _util.Options(this.props);

var x=options.chartWidth/2-(options.margin.left||0);
var y=options.chartHeight/2-(options.margin.top||0);

var radius=Math.min(x,y);

var r=this.props.r;
r=isNaN(r)?this.props.options&&this.props.options.r:r;
r=isNaN(r)?radius/2:r;

var R=this.props.R;
R=R||this.props.options&&this.props.options.R;
R=R||radius;var _ref=

this.props.center||this.props.options&&this.props.options.center||[x,y],_ref2=_slicedToArray(_ref,2),centerX=_ref2[0],centerY=_ref2[1];

var textStyle=(0,_util.fontAdapt)(options.label);

var slices=void 0;

if(this.props.data.length===1){
var item=this.props.data[0];
var outerFill=item.color&&_util.Colors.string(item.color)||this.color(0);
var innerFill=this.props.monoItemInnerFillColor||'#fff';
var stroke=typeof fill==='string'?outerFill:_util.Colors.darkenColor(outerFill);
slices=
_react2.default.createElement(_reactNativeSvg.G,null,
_react2.default.createElement(_reactNativeSvg.Circle,{r:R,cx:centerX,cy:centerY,stroke:stroke,fill:outerFill}),
_react2.default.createElement(_reactNativeSvg.Circle,{r:r,cx:centerX,cy:centerY,stroke:stroke,fill:innerFill}),
_react2.default.createElement(_reactNativeSvg.Text,{fontFamily:textStyle.fontFamily,
fontSize:textStyle.fontSize,
fontWeight:textStyle.fontWeight,
fontStyle:textStyle.fontStyle,
fill:textStyle.fill,
textAnchor:'middle',
x:centerX,
y:centerY-R+(R-r)/2},item.name));


}else{
var chart=Pie({
center:[centerX,centerY],
r:r,
R:R,
data:this.props.data,
accessor:this.props.accessor||(0,_util.identity)(this.props.accessorKey)});


slices=chart.curves.map(function(c,i){
var fill=c.item.color&&_util.Colors.string(c.item.color)||_this2.color(i);
var stroke=typeof fill==='string'?fill:_util.Colors.darkenColor(fill);
return(
_react2.default.createElement(_reactNativeSvg.G,{key:i},
_react2.default.createElement(_reactNativeSvg.Path,{d:c.sector.path.print(),stroke:stroke,fill:fill,fillOpacity:1}),
_react2.default.createElement(_reactNativeSvg.G,{x:options.margin.left,y:options.margin.top},
_react2.default.createElement(_reactNativeSvg.Text,{fontFamily:textStyle.fontFamily,
fontSize:textStyle.fontSize,
fontWeight:textStyle.fontWeight,
fontStyle:textStyle.fontStyle,
fill:textStyle.fill,
textAnchor:'middle',
x:c.sector.centroid[0],
y:c.sector.centroid[1]},c.item.name))));



});
}

var returnValue=_react2.default.createElement(_reactNativeSvg2.default,{width:options.width,height:options.height},
_react2.default.createElement(_reactNativeSvg.G,{x:options.margin.left,y:options.margin.top},
slices));



return returnValue;
}},{key:'defaultRange',get:function get(){return _lodash2.default.map(Array(this.props.data&&this.props.data.length),function(){return 0;});}}]);return PieChart;}(_react.Component);PieChart.defaultProps={options:{margin:{top:20,left:20,right:20,bottom:20},width:600,height:600,color:'#2980B9',r:100,R:200,legendPosition:'topLeft',animate:{type:'oneByOne',duration:200,fillTransition:3},label:{fontFamily:'Arial',fontSize:14,bold:true,color:'#ECF0F1'}}};exports.default=PieChart;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBpZS5qcyJdLCJuYW1lcyI6WyJQaWUiLCJyZXF1aXJlIiwiUGllQ2hhcnQiLCJpIiwiY29sb3IiLCJwcm9wcyIsIm9wdGlvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJwYWxsZXRlIiwibWl4Iiwic3RyaW5nIiwiaXNTdHJpbmciLCJub0RhdGFNc2ciLCJub0RhdGFNZXNzYWdlIiwiZGF0YSIsInVuZGVmaW5lZCIsIngiLCJjaGFydFdpZHRoIiwibWFyZ2luIiwibGVmdCIsInkiLCJjaGFydEhlaWdodCIsInRvcCIsInJhZGl1cyIsIk1hdGgiLCJtaW4iLCJyIiwiaXNOYU4iLCJSIiwiY2VudGVyIiwiY2VudGVyWCIsImNlbnRlclkiLCJ0ZXh0U3R5bGUiLCJsYWJlbCIsInNsaWNlcyIsIml0ZW0iLCJvdXRlckZpbGwiLCJpbm5lckZpbGwiLCJtb25vSXRlbUlubmVyRmlsbENvbG9yIiwic3Ryb2tlIiwiZmlsbCIsImRhcmtlbkNvbG9yIiwiZm9udEZhbWlseSIsImZvbnRTaXplIiwiZm9udFdlaWdodCIsImZvbnRTdHlsZSIsIm5hbWUiLCJjaGFydCIsImFjY2Vzc29yIiwiYWNjZXNzb3JLZXkiLCJjdXJ2ZXMiLCJtYXAiLCJjIiwic2VjdG9yIiwicGF0aCIsInByaW50IiwiY2VudHJvaWQiLCJyZXR1cm5WYWx1ZSIsIndpZHRoIiwiaGVpZ2h0IiwiZGVmYXVsdFByb3BzIiwicmlnaHQiLCJib3R0b20iLCJsZWdlbmRQb3NpdGlvbiIsImFuaW1hdGUiLCJ0eXBlIiwiZHVyYXRpb24iLCJmaWxsVHJhbnNpdGlvbiIsImJvbGQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQWVBLDRCO0FBQ0E7QUFDQSxnRDtBQUNBO0FBQ0EsOEI7QUFDQSwwQjtBQUNBLEdBQU1BLEtBQU1DLFFBQVEsY0FBUixDQUFaLEM7O0FBRXFCQyxROzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBeUJiQyxDLENBQUc7QUFDUCxHQUFJQyxPQUFRLEtBQUtDLEtB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QUFRYyxNQUFSLENBQWVJLEdBQTdDO0FBQ01ZLE1BRE4sQ0FEVSxDQUFsQjs7OztBQU1BLE1BQU91QixZQUFQO0FBQ0QsQyx3Q0FyRmtCLENBQ2pCLE1BQU8sa0JBQUVOLEdBQUYsQ0FBTTlDLE1BQU0sS0FBS0YsS0FBTCxDQUFXVyxJQUFYLEVBQW1CLEtBQUtYLEtBQUwsQ0FBV1csSUFBWCxDQUFnQlAsTUFBekMsQ0FBTixDQUF1RCxVQUFVLENBQUMsTUFBTyxFQUFQLENBQVMsQ0FBM0UsQ0FBUCxDQUNELEMsd0NBMUNrQlAsUSxDQUVaNEQsWSxDQUFlLENBQ3BCeEQsUUFBUyxDQUNQYyxPQUFRLENBQUNJLElBQUssRUFBTixDQUFVSCxLQUFNLEVBQWhCLENBQW9CMEMsTUFBTyxFQUEzQixDQUErQkMsT0FBUSxFQUF2QyxDQURELENBRVBKLE1BQU8sR0FGQSxDQUdQQyxPQUFRLEdBSEQsQ0FJUHpELE1BQU8sU0FKQSxDQUtQd0IsRUFBRyxHQUxJLENBTVBFLEVBQUcsR0FOSSxDQU9QbUMsZUFBZ0IsU0FQVCxDQVFQQyxRQUFTLENBQ1BDLEtBQU0sVUFEQyxDQUVQQyxTQUFVLEdBRkgsQ0FHUEMsZUFBZ0IsQ0FIVCxDQVJGLENBYVBsQyxNQUFPLENBQ0xTLFdBQVksT0FEUCxDQUVMQyxTQUFVLEVBRkwsQ0FHTHlCLEtBQU0sSUFIRCxDQUlMbEUsTUFBTyxTQUpGLENBYkEsQ0FEVyxDLGlCQUZIRixRIiwiZmlsZSI6IlBpZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNiBDYXBpdGFsIE9uZSBTZXJ2aWNlcywgTExDXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cblNQRFgtQ29weXJpZ2h0OiBDb3B5cmlnaHQgKGMpIENhcGl0YWwgT25lIFNlcnZpY2VzLCBMTENcblNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4qL1xuXG5pbXBvcnQgUmVhY3QsIHtDb21wb25lbnR9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHtUZXh0IGFzIFJlYWN0VGV4dH0gIGZyb20gJ3JlYWN0LW5hdGl2ZSdcbmltcG9ydCBTdmcseyBHLCBQYXRoLCBUZXh0LCBDaXJjbGV9IGZyb20gJ3JlYWN0LW5hdGl2ZS1zdmcnXG5pbXBvcnQgeyBDb2xvcnMsIE9wdGlvbnMsIGN5Y2xpYywgaWRlbnRpdHksIGZvbnRBZGFwdCB9IGZyb20gJy4vdXRpbCdcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCAnYmFiZWwtcG9seWZpbGwnXG5jb25zdCBQaWUgPSByZXF1aXJlKCdwYXRocy1qcy9waWUnKVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQaWVDaGFydCBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBvcHRpb25zOiB7XG4gICAgICBtYXJnaW46IHt0b3A6IDIwLCBsZWZ0OiAyMCwgcmlnaHQ6IDIwLCBib3R0b206IDIwfSxcbiAgICAgIHdpZHRoOiA2MDAsXG4gICAgICBoZWlnaHQ6IDYwMCxcbiAgICAgIGNvbG9yOiAnIzI5ODBCOScsXG4gICAgICByOiAxMDAsXG4gICAgICBSOiAyMDAsXG4gICAgICBsZWdlbmRQb3NpdGlvbjogJ3RvcExlZnQnLFxuICAgICAgYW5pbWF0ZToge1xuICAgICAgICB0eXBlOiAnb25lQnlPbmUnLFxuICAgICAgICBkdXJhdGlvbjogMjAwLFxuICAgICAgICBmaWxsVHJhbnNpdGlvbjogM1xuICAgICAgfSxcbiAgICAgIGxhYmVsOiB7XG4gICAgICAgIGZvbnRGYW1pbHk6ICdBcmlhbCcsXG4gICAgICAgIGZvbnRTaXplOiAxNCxcbiAgICAgICAgYm9sZDogdHJ1ZSxcbiAgICAgICAgY29sb3I6ICcjRUNGMEYxJ1xuICAgICAgfVxuICAgIH0sXG4gIH1cblxuICBjb2xvcihpKSB7XG4gICAgbGV0IGNvbG9yID0gdGhpcy5wcm9wcy5jb2xvciB8fCAodGhpcy5wcm9wcy5vcHRpb25zICYmIHRoaXMucHJvcHMub3B0aW9ucy5jb2xvcilcbiAgICBpZiAoQXJyYXkuaXNBcnJheShjb2xvcikpIHtcbiAgICAgIGlmIChpID49IGNvbG9yLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBwYWxsZXRlID0gQ29sb3JzLm1peChjb2xvcltpICUgY29sb3IubGVuZ3RoXSlcbiAgICAgICAgcmV0dXJuIENvbG9ycy5zdHJpbmcoY3ljbGljKHBhbGxldGUsIGkpKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbG9yW2ldO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoY29sb3IgJiYgIV8uaXNTdHJpbmcoY29sb3IpKSBjb2xvciA9IGNvbG9yLmNvbG9yXG4gICAgICBsZXQgcGFsbGV0ZSA9IHRoaXMucHJvcHMucGFsbGV0ZSB8fCAodGhpcy5wcm9wcy5vcHRpb25zICYmIHRoaXMucHJvcHMub3B0aW9ucy5wYWxsZXRlKSB8fCBDb2xvcnMubWl4KGNvbG9yIHx8ICcjOWFjN2Y3JylcbiAgICAgIHJldHVybiBDb2xvcnMuc3RyaW5nKGN5Y2xpYyhwYWxsZXRlLCBpKSlcbiAgICB9XG4gIH1cblxuICBnZXQgZGVmYXVsdFJhbmdlKCkge1xuICAgIHJldHVybiBfLm1hcChBcnJheSh0aGlzLnByb3BzLmRhdGEgJiYgdGhpcy5wcm9wcy5kYXRhLmxlbmd0aCksZnVuY3Rpb24oKXtyZXR1cm4gMH0pXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qgbm9EYXRhTXNnID0gdGhpcy5wcm9wcy5ub0RhdGFNZXNzYWdlIHx8ICdObyBkYXRhIGF2YWlsYWJsZSdcbiAgICBpZiAodGhpcy5wcm9wcy5kYXRhID09PSB1bmRlZmluZWQpIHJldHVybiAoPFJlYWN0VGV4dD57bm9EYXRhTXNnfTwvUmVhY3RUZXh0PilcblxuICAgIGxldCBvcHRpb25zID0gbmV3IE9wdGlvbnModGhpcy5wcm9wcylcblxuICAgIGxldCB4ID0gKG9wdGlvbnMuY2hhcnRXaWR0aCAvIDIpIC0gKG9wdGlvbnMubWFyZ2luLmxlZnQgfHwgMClcbiAgICBsZXQgeSA9IChvcHRpb25zLmNoYXJ0SGVpZ2h0IC8gMikgLSAob3B0aW9ucy5tYXJnaW4udG9wIHx8IDApXG5cbiAgICBsZXQgcmFkaXVzID0gTWF0aC5taW4oeCwgeSlcblxuICAgIGxldCByID0gdGhpcy5wcm9wcy5yXG4gICAgciA9IChpc05hTihyKSA/ICh0aGlzLnByb3BzLm9wdGlvbnMgJiYgdGhpcy5wcm9wcy5vcHRpb25zLnIpIDogcilcbiAgICByID0gKGlzTmFOKHIpID8gKHJhZGl1cyAvIDIpIDogcilcblxuICAgIGxldCBSID0gdGhpcy5wcm9wcy5SXG4gICAgUiA9IChSIHx8ICh0aGlzLnByb3BzLm9wdGlvbnMgJiYgdGhpcy5wcm9wcy5vcHRpb25zLlIpKVxuICAgIFIgPSAoUiB8fCByYWRpdXMpXG5cbiAgICBsZXQgW2NlbnRlclgsIGNlbnRlclldID0gdGhpcy5wcm9wcy5jZW50ZXIgfHwgKHRoaXMucHJvcHMub3B0aW9ucyAmJiB0aGlzLnByb3BzLm9wdGlvbnMuY2VudGVyKSB8fCBbeCwgeV1cblxuICAgIGxldCB0ZXh0U3R5bGUgPSBmb250QWRhcHQob3B0aW9ucy5sYWJlbClcblxuICAgIGxldCBzbGljZXNcblxuICAgIGlmICh0aGlzLnByb3BzLmRhdGEubGVuZ3RoID09PSAxKSB7XG4gICAgICBsZXQgaXRlbSA9IHRoaXMucHJvcHMuZGF0YVswXVxuICAgICAgbGV0IG91dGVyRmlsbCA9IChpdGVtLmNvbG9yICYmIENvbG9ycy5zdHJpbmcoaXRlbS5jb2xvcikpIHx8IHRoaXMuY29sb3IoMClcbiAgICAgIGxldCBpbm5lckZpbGwgPSB0aGlzLnByb3BzLm1vbm9JdGVtSW5uZXJGaWxsQ29sb3IgfHwgJyNmZmYnXG4gICAgICBsZXQgc3Ryb2tlID0gdHlwZW9mIGZpbGwgPT09ICdzdHJpbmcnID8gb3V0ZXJGaWxsIDogQ29sb3JzLmRhcmtlbkNvbG9yKG91dGVyRmlsbClcbiAgICAgIHNsaWNlcyA9IChcbiAgICAgICAgPEc+XG4gICAgICAgICAgPENpcmNsZSByPXtSfSBjeD17Y2VudGVyWH0gY3k9e2NlbnRlcll9IHN0cm9rZT17c3Ryb2tlfSBmaWxsPXtvdXRlckZpbGx9Lz5cbiAgICAgICAgICA8Q2lyY2xlIHI9e3J9IGN4PXtjZW50ZXJYfSBjeT17Y2VudGVyWX0gc3Ryb2tlPXtzdHJva2V9IGZpbGw9e2lubmVyRmlsbH0vPlxuICAgICAgICAgIDxUZXh0IGZvbnRGYW1pbHk9e3RleHRTdHlsZS5mb250RmFtaWx5fVxuICAgICAgICAgICAgICAgIGZvbnRTaXplPXt0ZXh0U3R5bGUuZm9udFNpemV9XG4gICAgICAgICAgICAgICAgZm9udFdlaWdodD17dGV4dFN0eWxlLmZvbnRXZWlnaHR9XG4gICAgICAgICAgICAgICAgZm9udFN0eWxlPXt0ZXh0U3R5bGUuZm9udFN0eWxlfVxuICAgICAgICAgICAgICAgIGZpbGw9e3RleHRTdHlsZS5maWxsfVxuICAgICAgICAgICAgICAgIHRleHRBbmNob3I9XCJtaWRkbGVcIlxuICAgICAgICAgICAgICAgIHg9e2NlbnRlclh9XG4gICAgICAgICAgICAgICAgeT17Y2VudGVyWSAtIFIgKyAoKFItcikvMil9PntpdGVtLm5hbWV9PC9UZXh0PlxuICAgICAgICA8L0c+XG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBjaGFydCA9IFBpZSh7XG4gICAgICAgIGNlbnRlcjogW2NlbnRlclgsIGNlbnRlclldLFxuICAgICAgICByLFxuICAgICAgICBSLFxuICAgICAgICBkYXRhOiB0aGlzLnByb3BzLmRhdGEsXG4gICAgICAgIGFjY2Vzc29yOiB0aGlzLnByb3BzLmFjY2Vzc29yIHx8IGlkZW50aXR5KHRoaXMucHJvcHMuYWNjZXNzb3JLZXkpXG4gICAgICB9KVxuXG4gICAgICBzbGljZXMgPSBjaGFydC5jdXJ2ZXMubWFwKCAoYywgaSkgPT4ge1xuICAgICAgICBsZXQgZmlsbCA9IChjLml0ZW0uY29sb3IgJiYgQ29sb3JzLnN0cmluZyhjLml0ZW0uY29sb3IpKSB8fCB0aGlzLmNvbG9yKGkpXG4gICAgICAgIGxldCBzdHJva2UgPSB0eXBlb2YgZmlsbCA9PT0gJ3N0cmluZycgPyBmaWxsIDogQ29sb3JzLmRhcmtlbkNvbG9yKGZpbGwpXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICAgICA8RyBrZXk9eyBpIH0+XG4gICAgICAgICAgICAgICAgICAgICAgPFBhdGggZD17Yy5zZWN0b3IucGF0aC5wcmludCgpIH0gc3Ryb2tlPXtzdHJva2V9IGZpbGw9e2ZpbGx9IGZpbGxPcGFjaXR5PXsxfSAgLz5cbiAgICAgICAgICAgICAgICAgICAgICA8RyB4PXtvcHRpb25zLm1hcmdpbi5sZWZ0fSB5PXtvcHRpb25zLm1hcmdpbi50b3B9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFRleHQgZm9udEZhbWlseT17dGV4dFN0eWxlLmZvbnRGYW1pbHl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U2l6ZT17dGV4dFN0eWxlLmZvbnRTaXplfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udFdlaWdodD17dGV4dFN0eWxlLmZvbnRXZWlnaHR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250U3R5bGU9e3RleHRTdHlsZS5mb250U3R5bGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxsPXt0ZXh0U3R5bGUuZmlsbH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I9XCJtaWRkbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeD17Yy5zZWN0b3IuY2VudHJvaWRbMF19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5PXtjLnNlY3Rvci5jZW50cm9pZFsxXX0+eyBjLml0ZW0ubmFtZSB9PC9UZXh0PlxuICAgICAgICAgICAgICAgICAgICAgIDwvRz5cbiAgICAgICAgICAgICAgICAgIDwvRz5cbiAgICAgICAgICAgICAgKVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBsZXQgcmV0dXJuVmFsdWUgPSA8U3ZnIHdpZHRoPXtvcHRpb25zLndpZHRofSBoZWlnaHQ9e29wdGlvbnMuaGVpZ2h0fT5cbiAgICAgICAgICAgIDxHIHg9e29wdGlvbnMubWFyZ2luLmxlZnR9IHk9e29wdGlvbnMubWFyZ2luLnRvcH0+XG4gICAgICAgICAgICAgICAgeyBzbGljZXMgfVxuICAgICAgICAgICAgPC9HPlxuICAgICAgICAgIDwvU3ZnPlxuXG4gICAgcmV0dXJuIHJldHVyblZhbHVlXG4gIH1cbn1cbiJdfQ==