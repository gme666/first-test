fcdf31e0396d9a2b8e6fe0c5abeeb7a2
Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();

















var _react=require('react');var _react2=_interopRequireDefault(_react);
var _reactNativeSvg=require('react-native-svg');
var _util=require('./util');
var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}
var Pathjs=require('paths-js/path');var

AxisStruct=function(){

function AxisStruct(scale,options,chartArea,horizontal){_classCallCheck(this,AxisStruct);
this.scale=scale;
this.options=options;
this.chartArea=chartArea;
this.margin=chartArea.margin;
this.horizontal=horizontal;
}_createClass(AxisStruct,[{key:'axis',value:function axis()
































{var _this=this;

var horizontal=this.horizontal;
var xAxis=this.chartArea.x;
var yAxis=this.chartArea.y;
var currentAxis=horizontal?xAxis:yAxis;
var tickInterval=this.options.tickCount||10;
var decimalPlaces=this.options.decimalPlaces||2;
var ticks=this.options.tickValues!==undefined&&this.options.tickValues.length!==0?_lodash2.default.map(this.options.tickValues,function(v){return v.value;}):AxisStruct.getTickValues(currentAxis,tickInterval,decimalPlaces);
var fixed=this.options.zeroAxis?this.scale(0):horizontal?yAxis.min:xAxis.min;
var start={x:horizontal?xAxis.min:fixed,y:horizontal?fixed:yAxis.min};
var end={x:horizontal?xAxis.max:fixed,y:horizontal?fixed:yAxis.max};
var tailLength=this.options.tailLength||10;

var margin=this.margin;
if(margin!==undefined){
if(horizontal){
start.x+=margin.left-tailLength||0;
start.y+=margin.top||0;
end.x+=margin.left||0;
end.y+=margin.top||0;
}else
{
start.x+=margin.left||0;
start.y+=margin.top+tailLength||0;
end.x+=margin.left||0;
end.y+=margin.top-tailLength||0;
}
}

return{
item:currentAxis,
path:Pathjs().moveto(start).lineto(end).closepath(),
ticks:ticks,
lines:ticks.map(function(c,i){
var scaleBase=isNaN(c)?i:c;
var lineStart={x:horizontal?_this.scale(scaleBase)+margin.left:xAxis.min+margin.left,y:horizontal?yAxis.min+margin.top:_this.scale(scaleBase)+margin.top};
return Pathjs().moveto(lineStart).lineto(horizontal?lineStart.x:xAxis.max+margin.left,horizontal?yAxis.max+(margin.top-tailLength):lineStart.y);
},this)};

}}],[{key:'calcStepSize',value:function calcStepSize(range,targetSteps){var tempStep=range/targetSteps;var mag=Math.floor(Math.log(tempStep)/Math.log(10));var magPow=Math.pow(10,mag);var magMsd=Math.round(tempStep/magPow+0.5);if(magMsd>5.0)magMsd=10.0;else if(magMsd>2.0)magMsd=5.0;else if(magMsd>1.0)magMsd=2.0;return magMsd*magPow;}},{key:'roundFloat',value:function roundFloat(floatVal,decimalPlaces){return Math.round(parseFloat((floatVal*Math.pow(10,decimalPlaces)).toFixed(decimalPlaces)))/Math.pow(10,decimalPlaces);}},{key:'getTickValues',value:function getTickValues(axis,tickCount,decimalPlaces){var tickStep=AxisStruct.calcStepSize(axis.maxValue-axis.minValue,tickCount);var maxTick=axis.minValue+tickCount*tickStep;var tickValues=_lodash2.default.range(axis.minValue,maxTick,tickStep);tickValues=tickValues.map(function(tickValue){return AxisStruct.roundFloat(tickValue,decimalPlaces);});return tickValues;}}]);return AxisStruct;}();var


Axis=function(_Component){_inherits(Axis,_Component);function Axis(){_classCallCheck(this,Axis);return _possibleConstructorReturn(this,(Axis.__proto__||Object.getPrototypeOf(Axis)).apply(this,arguments));}_createClass(Axis,[{key:'render',value:function render()

{var _props=
this.props,chartArea=_props.chartArea,options=_props.options,scale=_props.scale;
var horizontal=options.orient==='top'||options.orient==='bottom';

var axis=new AxisStruct(scale,options,chartArea,horizontal).axis();

var textAnchor='start';
if(options.orient==='top'||options.orient==='bottom')textAnchor='middle';
if(options.orient==='left')textAnchor='end';
if(options.orient==='right')textAnchor='start';

var xy=[0,0];
if(options.orient==='top')xy=[0,-5];
if(options.orient==='bottom')xy=[0,5];
if(options.orient==='left')xy=[-5,-10];
if(options.orient==='right')xy=[5,5];

if(typeof options.color!=='string'){
options.color='#3E90F0';
}

if(typeof options.gridColor!=='string'){
options.gridColor='#3E90F0';
}

if(typeof options.opacity!=='number'){
options.opacity=0.5;
}

if(typeof options.strokeWidth!=='number'){
options.strokeWidth=3;
}

if(typeof options.tickSize!=='number'){
options.tickSize=2;
}

if(typeof options.tickColor!=='string'){
options.tickColor='grey';
}

var textStyle=(0,_util.fontAdapt)(options.label);

var ticks=_lodash2.default.map(axis.ticks,function(c,i){
var label=options.labelFunction!==undefined?options.labelFunction.apply(this,[c]):c;
var scaleBase=isNaN(c)?i:c;
var gxy=horizontal?[scale(scaleBase),chartArea.y.min]:[chartArea.x.min,scale(scaleBase)];

var returnValue=void 0;
if(label!==undefined&&label!==null){
returnValue=
_react2.default.createElement(_reactNativeSvg.G,{key:i,x:gxy[0],y:gxy[1]},
options.showTicks&&
_react2.default.createElement(_reactNativeSvg.Circle,{r:options.tickSize,cx:'0',cy:'0',stroke:options.tickColor,fill:options.tickColor}),

options.showLabels&&
_react2.default.createElement(_reactNativeSvg.Text,{x:xy[0],y:xy[1],
fontFamily:textStyle.fontFamily,
fontSize:textStyle.fontSize,
fontWeight:textStyle.fontWeight,
fontStyle:textStyle.fontStyle,
fill:textStyle.fill,
textAnchor:textAnchor},
label));


}

return returnValue;
});


var gridLines=options.showLines?_lodash2.default.map(axis.lines,function(c,i){
return(
_react2.default.createElement(_reactNativeSvg.Path,{key:'gridLines'+i,d:c.print(),strokeOpacity:options.opacity,stroke:options.gridColor,fill:'none'}));

}):[];

var offset={
x:chartArea.margin.left*-1,
y:chartArea.margin.top*-1};




var returnV=_react2.default.createElement(_reactNativeSvg.G,null,
_react2.default.createElement(_reactNativeSvg.G,{x:offset.x,y:offset.y},
options.showAxis?_react2.default.createElement(_reactNativeSvg.Path,{d:axis.path.print(),strokeOpacity:options.opacity,stroke:options.color,strokeWidth:options.strokeWidth,fill:'none'}):null),

ticks,
_react2.default.createElement(_reactNativeSvg.G,{x:offset.x,y:offset.y},
gridLines));



return returnV;

}}]);return Axis;}(_react.Component);exports.default=Axis;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF4aXMuanMiXSwibmFtZXMiOlsiUGF0aGpzIiwicmVxdWlyZSIsIkF4aXNTdHJ1Y3QiLCJzY2FsZSIsIm9wdGlvbnMiLCJjaGFydEFyZWEiLCJob3Jpem9udGFsIiwibWFyZ2luIiwieEF4aXMiLCJ4IiwieUF4aXMiLCJ5IiwiY3VycmVudEF4aXMiLCJ0aWNrSW50ZXJ2YWwiLCJ0aWNrQ291bnQiLCJkZWNpbWFsUGxhY2VzIiwidGlja3MiLCJ0aWNrVmFsdWVzIiwidW5kZWZpbmVkIiwibGVuZ3RoIiwibWFwIiwidiIsInZhbHVlIiwiZ2V0VGlja1ZhbHVlcyIsImZpeGVkIiwiemVyb0F4aXMiLCJtaW4iLCJzdGFydCIsImVuZCIsIm1heCIsInRhaWxMZW5ndGgiLCJsZWZ0IiwidG9wIiwiaXRlbSIsInBhdGgiLCJtb3ZldG8iLCJsaW5ldG8iLCJjbG9zZXBhdGgiLCJsaW5lcyIsImMiLCJpIiwic2NhbGVCYXNlIiwiaXNOYU4iLCJsaW5lU3RhcnQiLCJyYW5nZSIsInRhcmdldFN0ZXBzIiwidGVtcFN0ZXAiLCJtYWciLCJNYXRoIiwiZmxvb3IiLCJsb2ciLCJtYWdQb3ciLCJwb3ciLCJtYWdNc2QiLCJyb3VuZCIsImZsb2F0VmFsIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJheGlzIiwidGlja1N0ZXAiLCJjYWxjU3RlcFNpemUiLCJtYXhWYWx1ZSIsIm1pblZhbHVlIiwibWF4VGljayIsInJvdW5kRmxvYXQiLCJ0aWNrVmFsdWUiLCJBeGlzIiwicHJvcHMiLCJvcmllbnQiLCJ0ZXh0QW5jaG9yIiwieHkiLCJjb2xvciIsImdyaWRDb2xvciIsIm9wYWNpdHkiLCJzdHJva2VXaWR0aCIsInRpY2tTaXplIiwidGlja0NvbG9yIiwidGV4dFN0eWxlIiwibGFiZWwiLCJsYWJlbEZ1bmN0aW9uIiwiYXBwbHkiLCJneHkiLCJyZXR1cm5WYWx1ZSIsInNob3dUaWNrcyIsInNob3dMYWJlbHMiLCJmb250RmFtaWx5IiwiZm9udFNpemUiLCJmb250V2VpZ2h0IiwiZm9udFN0eWxlIiwiZmlsbCIsImdyaWRMaW5lcyIsInNob3dMaW5lcyIsInByaW50Iiwib2Zmc2V0IiwicmV0dXJuViIsInNob3dBeGlzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFrQkEsNEI7QUFDQTtBQUNBO0FBQ0EsOEI7QUFDQSxHQUFNQSxRQUFTQyxRQUFRLGVBQVIsQ0FBZixDOztBQUVNQyxVOztBQUVKLG9CQUFZQyxLQUFaLENBQW1CQyxPQUFuQixDQUE0QkMsU0FBNUIsQ0FBdUNDLFVBQXZDLENBQW1EO0FBQ2pELEtBQUtILEtBQUwsQ0FBYUEsS0FBYjtBQUNBLEtBQUtDLE9BQUwsQ0FBZUEsT0FBZjtBQUNBLEtBQUtDLFNBQUwsQ0FBaUJBLFNBQWpCO0FBQ0EsS0FBS0UsTUFBTCxDQUFjRixVQUFVRSxNQUF4QjtBQUNBLEtBQUtELFVBQUwsQ0FBa0JBLFVBQWxCO0FBQ0QsQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUNNOztBQUVMLEdBQU1BLFlBQWEsS0FBS0EsVUFBeEI7QUFDQSxHQUFNRSxPQUFRLEtBQUtILFNBQUwsQ0FBZUksQ0FBN0I7QUFDQSxHQUFNQyxPQUFRLEtBQUtMLFNBQUwsQ0FBZU0sQ0FBN0I7QUFDQSxHQUFNQyxhQUFjTixXQUFXRSxLQUFYLENBQWlCRSxLQUFyQztBQUNBLEdBQU1HLGNBQWUsS0FBS1QsT0FBTCxDQUFhVSxTQUFiLEVBQTBCLEVBQS9DO0FBQ0EsR0FBTUMsZUFBZ0IsS0FBS1gsT0FBTCxDQUFhVyxhQUFiLEVBQThCLENBQXBEO0FBQ0EsR0FBTUMsT0FBUSxLQUFLWixPQUFMLENBQWFhLFVBQWIsR0FBNEJDLFNBQTVCLEVBQXlDLEtBQUtkLE9BQUwsQ0FBYWEsVUFBYixDQUF3QkUsTUFBeEIsR0FBbUMsQ0FBNUUsQ0FBK0UsaUJBQUVDLEdBQUYsQ0FBTSxLQUFLaEIsT0FBTCxDQUFhYSxVQUFuQixDQUE4QixTQUFTSSxDQUFULENBQVcsQ0FBQyxNQUFPQSxHQUFFQyxLQUFULENBQWdCLENBQTFELENBQS9FLENBQTJJcEIsV0FBV3FCLGFBQVgsQ0FBeUJYLFdBQXpCLENBQXNDQyxZQUF0QyxDQUFvREUsYUFBcEQsQ0FBeko7QUFDQSxHQUFNUyxPQUFRLEtBQUtwQixPQUFMLENBQWFxQixRQUFiLENBQXNCLEtBQUt0QixLQUFMLENBQVcsQ0FBWCxDQUF0QixDQUFvQ0csV0FBV0ksTUFBTWdCLEdBQWpCLENBQXFCbEIsTUFBTWtCLEdBQTdFO0FBQ0EsR0FBTUMsT0FBUSxDQUFDbEIsRUFBR0gsV0FBV0UsTUFBTWtCLEdBQWpCLENBQXFCRixLQUF6QixDQUFnQ2IsRUFBR0wsV0FBV2tCLEtBQVgsQ0FBaUJkLE1BQU1nQixHQUExRCxDQUFkO0FBQ0EsR0FBTUUsS0FBTSxDQUFDbkIsRUFBRUgsV0FBV0UsTUFBTXFCLEdBQWpCLENBQXFCTCxLQUF4QixDQUE4QmIsRUFBR0wsV0FBV2tCLEtBQVgsQ0FBaUJkLE1BQU1tQixHQUF4RCxDQUFaO0FBQ0EsR0FBTUMsWUFBYSxLQUFLMUIsT0FBTCxDQUFhMEIsVUFBYixFQUEyQixFQUE5Qzs7QUFFQSxHQUFNdkIsUUFBUyxLQUFLQSxNQUFwQjtBQUNBLEdBQUlBLFNBQVdXLFNBQWYsQ0FBeUI7QUFDdkIsR0FBSVosVUFBSixDQUFlO0FBQ2JxQixNQUFNbEIsQ0FBTixFQUFZRixPQUFPd0IsSUFBUCxDQUFjRCxVQUFmLEVBQThCLENBQXpDO0FBQ0FILE1BQU1oQixDQUFOLEVBQVdKLE9BQU95QixHQUFQLEVBQWMsQ0FBekI7QUFDQUosSUFBSW5CLENBQUosRUFBVUYsT0FBT3dCLElBQVIsRUFBaUIsQ0FBMUI7QUFDQUgsSUFBSWpCLENBQUosRUFBU0osT0FBT3lCLEdBQVAsRUFBYyxDQUF2QjtBQUNELENBTEQ7QUFNSztBQUNITCxNQUFNbEIsQ0FBTixFQUFXRixPQUFPd0IsSUFBUCxFQUFlLENBQTFCO0FBQ0FKLE1BQU1oQixDQUFOLEVBQVlKLE9BQU95QixHQUFQLENBQWFGLFVBQWQsRUFBNkIsQ0FBeEM7QUFDQUYsSUFBSW5CLENBQUosRUFBU0YsT0FBT3dCLElBQVAsRUFBZSxDQUF4QjtBQUNBSCxJQUFJakIsQ0FBSixFQUFVSixPQUFPeUIsR0FBUCxDQUFhRixVQUFkLEVBQThCLENBQXZDO0FBQ0Q7QUFDRjs7QUFFRCxNQUFPO0FBQ0xHLEtBQU1yQixXQUREO0FBRUxzQixLQUFNbEMsU0FBU21DLE1BQVQsQ0FBZ0JSLEtBQWhCLEVBQXVCUyxNQUF2QixDQUE4QlIsR0FBOUIsRUFBbUNTLFNBQW5DLEVBRkQ7QUFHTHJCLE1BQU9BLEtBSEY7QUFJTHNCLE1BQU90QixNQUFNSSxHQUFOLENBQVUsU0FBQ21CLENBQUQsQ0FBR0MsQ0FBSCxDQUFTO0FBQ3hCLEdBQUlDLFdBQVlDLE1BQU1ILENBQU4sRUFBV0MsQ0FBWCxDQUFlRCxDQUEvQjtBQUNBLEdBQU1JLFdBQVksQ0FBQ2xDLEVBQUdILFdBQWEsTUFBS0gsS0FBTCxDQUFXc0MsU0FBWCxFQUF3QmxDLE9BQU93QixJQUE1QyxDQUFtRHZCLE1BQU1rQixHQUFOLENBQVluQixPQUFPd0IsSUFBMUUsQ0FBZ0ZwQixFQUFHTCxXQUFhSSxNQUFNZ0IsR0FBTixDQUFZbkIsT0FBT3lCLEdBQWhDLENBQXNDLE1BQUs3QixLQUFMLENBQVdzQyxTQUFYLEVBQXdCbEMsT0FBT3lCLEdBQXhKLENBQWxCO0FBQ0EsTUFBT2hDLFVBQVNtQyxNQUFULENBQWdCUSxTQUFoQixFQUEyQlAsTUFBM0IsQ0FBa0M5QixXQUFhcUMsVUFBVWxDLENBQXZCLENBQTJCRCxNQUFNcUIsR0FBTixDQUFZdEIsT0FBT3dCLElBQWhGLENBQXNGekIsV0FBYUksTUFBTW1CLEdBQU4sRUFBYXRCLE9BQU95QixHQUFQLENBQWFGLFVBQTFCLENBQWIsQ0FBcURhLFVBQVVoQyxDQUFySixDQUFQO0FBQ0QsQ0FKTSxDQUlMLElBSkssQ0FKRixDQUFQOztBQVVELEMsb0RBdkVtQmlDLEssQ0FBT0MsVyxDQUMzQixDQUNFLEdBQU1DLFVBQVdGLE1BQVFDLFdBQXpCLENBQ0EsR0FBTUUsS0FBTUMsS0FBS0MsS0FBTCxDQUFXRCxLQUFLRSxHQUFMLENBQVNKLFFBQVQsRUFBc0JFLEtBQUtFLEdBQUwsQ0FBUyxFQUFULENBQWpDLENBQVosQ0FDQSxHQUFNQyxRQUFTSCxLQUFLSSxHQUFMLENBQVMsRUFBVCxDQUFhTCxHQUFiLENBQWYsQ0FDQSxHQUFJTSxRQUFTTCxLQUFLTSxLQUFMLENBQVdSLFNBQVdLLE1BQVgsQ0FBb0IsR0FBL0IsQ0FBYixDQUVBLEdBQUlFLE9BQVMsR0FBYixDQUNFQSxPQUFTLElBQVQsQ0FERixJQUVLLElBQUlBLE9BQVMsR0FBYixDQUNIQSxPQUFTLEdBQVQsQ0FERyxJQUVBLElBQUlBLE9BQVMsR0FBYixDQUNIQSxPQUFTLEdBQVQsQ0FFRixNQUFPQSxRQUFTRixNQUFoQixDQUNELEMsOENBRWlCSSxRLENBQVV4QyxhLENBQWUsQ0FDekMsTUFBT2lDLE1BQUtNLEtBQUwsQ0FBV0UsV0FBVyxDQUFDRCxTQUFXUCxLQUFLSSxHQUFMLENBQVMsRUFBVCxDQUFhckMsYUFBYixDQUFaLEVBQXlDMEMsT0FBekMsQ0FBaUQxQyxhQUFqRCxDQUFYLENBQVgsRUFBMEZpQyxLQUFLSSxHQUFMLENBQVMsRUFBVCxDQUFhckMsYUFBYixDQUFqRyxDQUNELEMsb0RBRW9CMkMsSSxDQUFNNUMsUyxDQUFXQyxhLENBQWUsQ0FDbkQsR0FBTTRDLFVBQVd6RCxXQUFXMEQsWUFBWCxDQUF5QkYsS0FBS0csUUFBTCxDQUFnQkgsS0FBS0ksUUFBOUMsQ0FBd0RoRCxTQUF4RCxDQUFqQixDQUNBLEdBQU1pRCxTQUFVTCxLQUFLSSxRQUFMLENBQWlCaEQsVUFBWTZDLFFBQTdDLENBQ0EsR0FBSTFDLFlBQWEsaUJBQUUyQixLQUFGLENBQVFjLEtBQUtJLFFBQWIsQ0FBdUJDLE9BQXZCLENBQWdDSixRQUFoQyxDQUFqQixDQUNBMUMsV0FBYUEsV0FBV0csR0FBWCxDQUFlLG1CQUFhLENBQ3ZDLE1BQU9sQixZQUFXOEQsVUFBWCxDQUFzQkMsU0FBdEIsQ0FBaUNsRCxhQUFqQyxDQUFQLENBQ0QsQ0FGWSxDQUFiLENBR0EsTUFBT0UsV0FBUCxDQUNELEM7OztBQTZDa0JpRCxJOztBQUVWO0FBQytCLEtBQUtDLEtBRHBDLENBQ0M5RCxTQURELFFBQ0NBLFNBREQsQ0FDWUQsT0FEWixRQUNZQSxPQURaLENBQ3FCRCxLQURyQixRQUNxQkEsS0FEckI7QUFFUCxHQUFNRyxZQUFhRixRQUFRZ0UsTUFBUixHQUFrQixLQUFsQixFQUEyQmhFLFFBQVFnRSxNQUFSLEdBQWtCLFFBQWhFOztBQUVBLEdBQU1WLE1BQU8sR0FBSXhELFdBQUosQ0FBZUMsS0FBZixDQUFxQkMsT0FBckIsQ0FBNkJDLFNBQTdCLENBQXVDQyxVQUF2QyxFQUFtRG9ELElBQW5ELEVBQWI7O0FBRUEsR0FBSVcsWUFBYSxPQUFqQjtBQUNBLEdBQUlqRSxRQUFRZ0UsTUFBUixHQUFtQixLQUFuQixFQUE0QmhFLFFBQVFnRSxNQUFSLEdBQW1CLFFBQW5ELENBQTZEQyxXQUFhLFFBQWI7QUFDN0QsR0FBSWpFLFFBQVFnRSxNQUFSLEdBQW1CLE1BQXZCLENBQStCQyxXQUFhLEtBQWI7QUFDL0IsR0FBSWpFLFFBQVFnRSxNQUFSLEdBQW1CLE9BQXZCLENBQWdDQyxXQUFhLE9BQWI7O0FBRWhDLEdBQUlDLElBQUssQ0FBQyxDQUFELENBQUcsQ0FBSCxDQUFUO0FBQ0EsR0FBSWxFLFFBQVFnRSxNQUFSLEdBQW1CLEtBQXZCLENBQStCRSxHQUFLLENBQUMsQ0FBRCxDQUFHLENBQUMsQ0FBSixDQUFMO0FBQy9CLEdBQUlsRSxRQUFRZ0UsTUFBUixHQUFtQixRQUF2QixDQUFpQ0UsR0FBSyxDQUFDLENBQUQsQ0FBRyxDQUFILENBQUw7QUFDakMsR0FBSWxFLFFBQVFnRSxNQUFSLEdBQW1CLE1BQXZCLENBQWdDRSxHQUFLLENBQUMsQ0FBQyxDQUFGLENBQUksQ0FBQyxFQUFMLENBQUw7QUFDaEMsR0FBSWxFLFFBQVFnRSxNQUFSLEdBQW1CLE9BQXZCLENBQWlDRSxHQUFLLENBQUMsQ0FBRCxDQUFHLENBQUgsQ0FBTDs7QUFFakMsR0FBSSxNQUFPbEUsU0FBUW1FLEtBQWYsR0FBeUIsUUFBN0IsQ0FBdUM7QUFDckNuRSxRQUFRbUUsS0FBUixDQUFnQixTQUFoQjtBQUNEOztBQUVELEdBQUksTUFBT25FLFNBQVFvRSxTQUFmLEdBQTZCLFFBQWpDLENBQTJDO0FBQ3pDcEUsUUFBUW9FLFNBQVIsQ0FBb0IsU0FBcEI7QUFDRDs7QUFFRCxHQUFJLE1BQU9wRSxTQUFRcUUsT0FBZixHQUEyQixRQUEvQixDQUF5QztBQUN2Q3JFLFFBQVFxRSxPQUFSLENBQWtCLEdBQWxCO0FBQ0Q7O0FBRUQsR0FBSSxNQUFPckUsU0FBUXNFLFdBQWYsR0FBK0IsUUFBbkMsQ0FBNkM7QUFDM0N0RSxRQUFRc0UsV0FBUixDQUFzQixDQUF0QjtBQUNEOztBQUVELEdBQUksTUFBT3RFLFNBQVF1RSxRQUFmLEdBQTRCLFFBQWhDLENBQTBDO0FBQ3hDdkUsUUFBUXVFLFFBQVIsQ0FBbUIsQ0FBbkI7QUFDRDs7QUFFRCxHQUFJLE1BQU92RSxTQUFRd0UsU0FBZixHQUE2QixRQUFqQyxDQUEyQztBQUN6Q3hFLFFBQVF3RSxTQUFSLENBQW9CLE1BQXBCO0FBQ0Q7O0FBRUQsR0FBTUMsV0FBWSxvQkFBVXpFLFFBQVEwRSxLQUFsQixDQUFsQjs7QUFFQSxHQUFNOUQsT0FBTyxpQkFBRUksR0FBRixDQUFNc0MsS0FBSzFDLEtBQVgsQ0FBa0IsU0FBVXVCLENBQVYsQ0FBYUMsQ0FBYixDQUFnQjtBQUM3QyxHQUFNc0MsT0FBUTFFLFFBQVEyRSxhQUFSLEdBQTBCN0QsU0FBMUIsQ0FBcUNkLFFBQVEyRSxhQUFSLENBQXNCQyxLQUF0QixDQUE0QixJQUE1QixDQUFrQyxDQUFDekMsQ0FBRCxDQUFsQyxDQUFyQyxDQUE4RUEsQ0FBNUY7QUFDQSxHQUFJRSxXQUFZQyxNQUFNSCxDQUFOLEVBQVdDLENBQVgsQ0FBZUQsQ0FBL0I7QUFDQSxHQUFJMEMsS0FBTTNFLFdBQWEsQ0FBQ0gsTUFBTXNDLFNBQU4sQ0FBRCxDQUFrQnBDLFVBQVVNLENBQVYsQ0FBWWUsR0FBOUIsQ0FBYixDQUFnRCxDQUFDckIsVUFBVUksQ0FBVixDQUFZaUIsR0FBYixDQUFpQnZCLE1BQU1zQyxTQUFOLENBQWpCLENBQTFEOztBQUVBLEdBQUl5QyxtQkFBSjtBQUNBLEdBQUlKLFFBQVU1RCxTQUFWLEVBQXVCNEQsUUFBVSxJQUFyQyxDQUEyQztBQUN6Q0k7QUFDRSxpREFBRyxJQUFLMUMsQ0FBUixDQUFXLEVBQUd5QyxJQUFJLENBQUosQ0FBZCxDQUFzQixFQUFHQSxJQUFJLENBQUosQ0FBekI7QUFDSzdFLFFBQVErRSxTQUFSO0FBQ0Msc0RBQVEsRUFBRy9FLFFBQVF1RSxRQUFuQixDQUE2QixHQUFHLEdBQWhDLENBQW9DLEdBQUcsR0FBdkMsQ0FBMkMsT0FBUXZFLFFBQVF3RSxTQUEzRCxDQUFzRSxLQUFNeEUsUUFBUXdFLFNBQXBGLEVBRk47O0FBSUt4RSxRQUFRZ0YsVUFBUjtBQUNDLG9EQUFNLEVBQUdkLEdBQUcsQ0FBSCxDQUFULENBQWdCLEVBQUdBLEdBQUcsQ0FBSCxDQUFuQjtBQUNNLFdBQVlPLFVBQVVRLFVBRDVCO0FBRU0sU0FBVVIsVUFBVVMsUUFGMUI7QUFHTSxXQUFZVCxVQUFVVSxVQUg1QjtBQUlNLFVBQVdWLFVBQVVXLFNBSjNCO0FBS00sS0FBTVgsVUFBVVksSUFMdEI7QUFNTSxXQUFZcEIsVUFObEI7QUFPT1MsS0FQUCxDQUxOLENBREY7OztBQWdCRDs7QUFFRCxNQUFPSSxZQUFQO0FBQ0QsQ0ExQlksQ0FBYjs7O0FBNkJBLEdBQU1RLFdBQVl0RixRQUFRdUYsU0FBUixDQUFvQixpQkFBRXZFLEdBQUYsQ0FBTXNDLEtBQUtwQixLQUFYLENBQWtCLFNBQVVDLENBQVYsQ0FBYUMsQ0FBYixDQUFnQjtBQUN0RTtBQUNTLG9EQUFNLElBQUssWUFBY0EsQ0FBekIsQ0FBNEIsRUFBR0QsRUFBRXFELEtBQUYsRUFBL0IsQ0FBMEMsY0FBZXhGLFFBQVFxRSxPQUFqRSxDQUEwRSxPQUFRckUsUUFBUW9FLFNBQTFGLENBQXFHLEtBQUssTUFBMUcsRUFEVDs7QUFHRCxDQUpxQyxDQUFwQixDQUliLEVBSkw7O0FBTUEsR0FBSXFCLFFBQVM7QUFDWHBGLEVBQUdKLFVBQVVFLE1BQVYsQ0FBaUJ3QixJQUFqQixDQUF3QixDQUFDLENBRGpCO0FBRVhwQixFQUFHTixVQUFVRSxNQUFWLENBQWlCeUIsR0FBakIsQ0FBdUIsQ0FBQyxDQUZoQixDQUFiOzs7OztBQU9BLEdBQUk4RCxTQUFVO0FBQ0osaURBQUcsRUFBR0QsT0FBT3BGLENBQWIsQ0FBZ0IsRUFBR29GLE9BQU9sRixDQUExQjtBQUNHUCxRQUFRMkYsUUFBUixDQUFtQixvREFBTSxFQUFHckMsS0FBS3hCLElBQUwsQ0FBVTBELEtBQVYsRUFBVCxDQUE0QixjQUFleEYsUUFBUXFFLE9BQW5ELENBQTRELE9BQVFyRSxRQUFRbUUsS0FBNUUsQ0FBbUYsWUFBYW5FLFFBQVFzRSxXQUF4RyxDQUFxSCxLQUFLLE1BQTFILEVBQW5CLENBQXdKLElBRDNKLENBREk7O0FBSUgxRCxLQUpHO0FBS0osaURBQUcsRUFBRzZFLE9BQU9wRixDQUFiLENBQWdCLEVBQUdvRixPQUFPbEYsQ0FBMUI7QUFDRytFLFNBREgsQ0FMSSxDQUFkOzs7O0FBVUEsTUFBT0ksUUFBUDs7QUFFRCxDLG9EQW5Ha0I1QixJIiwiZmlsZSI6IkF4aXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuQ29weXJpZ2h0IDIwMTYgQ2FwaXRhbCBPbmUgU2VydmljZXMsIExMQ1xuXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG5cbiAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcblxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5TUERYLUNvcHlyaWdodDogQ29weXJpZ2h0IChjKSBDYXBpdGFsIE9uZSBTZXJ2aWNlcywgTExDXG5TUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuKi9cblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IENpcmNsZSwgRywgUGF0aCwgVGV4dCB9IGZyb20gJ3JlYWN0LW5hdGl2ZS1zdmcnXG5pbXBvcnQgeyBmb250QWRhcHQgfSBmcm9tICcuL3V0aWwnXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXG5jb25zdCBQYXRoanMgPSByZXF1aXJlKCdwYXRocy1qcy9wYXRoJylcblxuY2xhc3MgQXhpc1N0cnVjdCB7XG5cbiAgY29uc3RydWN0b3Ioc2NhbGUsIG9wdGlvbnMsIGNoYXJ0QXJlYSwgaG9yaXpvbnRhbCkge1xuICAgIHRoaXMuc2NhbGUgPSBzY2FsZVxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnNcbiAgICB0aGlzLmNoYXJ0QXJlYSA9IGNoYXJ0QXJlYVxuICAgIHRoaXMubWFyZ2luID0gY2hhcnRBcmVhLm1hcmdpblxuICAgIHRoaXMuaG9yaXpvbnRhbCA9IGhvcml6b250YWxcbiAgfVxuXG4gIHN0YXRpYyBjYWxjU3RlcFNpemUocmFuZ2UsIHRhcmdldFN0ZXBzKVxuICB7XG4gICAgY29uc3QgdGVtcFN0ZXAgPSByYW5nZSAvIHRhcmdldFN0ZXBzXG4gICAgY29uc3QgbWFnID0gTWF0aC5mbG9vcihNYXRoLmxvZyh0ZW1wU3RlcCkgLyAgTWF0aC5sb2coMTApKVxuICAgIGNvbnN0IG1hZ1BvdyA9IE1hdGgucG93KDEwLCBtYWcpXG4gICAgbGV0IG1hZ01zZCA9IE1hdGgucm91bmQodGVtcFN0ZXAgLyBtYWdQb3cgKyAwLjUpXG5cbiAgICBpZiAobWFnTXNkID4gNS4wKVxuICAgICAgbWFnTXNkID0gMTAuMFxuICAgIGVsc2UgaWYgKG1hZ01zZCA+IDIuMClcbiAgICAgIG1hZ01zZCA9IDUuMFxuICAgIGVsc2UgaWYgKG1hZ01zZCA+IDEuMClcbiAgICAgIG1hZ01zZCA9IDIuMFxuXG4gICAgcmV0dXJuIG1hZ01zZCAqIG1hZ1Bvd1xuICB9XG5cbiAgc3RhdGljIHJvdW5kRmxvYXQoZmxvYXRWYWwsIGRlY2ltYWxQbGFjZXMpIHtcbiAgICByZXR1cm4gTWF0aC5yb3VuZChwYXJzZUZsb2F0KChmbG9hdFZhbCAqIE1hdGgucG93KDEwLCBkZWNpbWFsUGxhY2VzKSkudG9GaXhlZChkZWNpbWFsUGxhY2VzKSkpIC8gTWF0aC5wb3coMTAsIGRlY2ltYWxQbGFjZXMpXG4gIH1cblxuICBzdGF0aWMgZ2V0VGlja1ZhbHVlcyhheGlzLCB0aWNrQ291bnQsIGRlY2ltYWxQbGFjZXMpIHtcbiAgICBjb25zdCB0aWNrU3RlcCA9IEF4aXNTdHJ1Y3QuY2FsY1N0ZXBTaXplKChheGlzLm1heFZhbHVlIC0gYXhpcy5taW5WYWx1ZSksdGlja0NvdW50KVxuICAgIGNvbnN0IG1heFRpY2sgPSBheGlzLm1pblZhbHVlICsgKHRpY2tDb3VudCAqIHRpY2tTdGVwKVxuICAgIGxldCB0aWNrVmFsdWVzID0gXy5yYW5nZShheGlzLm1pblZhbHVlLCBtYXhUaWNrLCB0aWNrU3RlcClcbiAgICB0aWNrVmFsdWVzID0gdGlja1ZhbHVlcy5tYXAodGlja1ZhbHVlID0+IHtcbiAgICAgIHJldHVybiBBeGlzU3RydWN0LnJvdW5kRmxvYXQodGlja1ZhbHVlLCBkZWNpbWFsUGxhY2VzKVxuICAgIH0pXG4gICAgcmV0dXJuIHRpY2tWYWx1ZXNcbiAgfVxuXG4gIGF4aXMoKSB7XG5cbiAgICBjb25zdCBob3Jpem9udGFsID0gdGhpcy5ob3Jpem9udGFsXG4gICAgY29uc3QgeEF4aXMgPSB0aGlzLmNoYXJ0QXJlYS54XG4gICAgY29uc3QgeUF4aXMgPSB0aGlzLmNoYXJ0QXJlYS55XG4gICAgY29uc3QgY3VycmVudEF4aXMgPSBob3Jpem9udGFsP3hBeGlzOnlBeGlzXG4gICAgY29uc3QgdGlja0ludGVydmFsID0gdGhpcy5vcHRpb25zLnRpY2tDb3VudCB8fCAxMFxuICAgIGNvbnN0IGRlY2ltYWxQbGFjZXMgPSB0aGlzLm9wdGlvbnMuZGVjaW1hbFBsYWNlcyB8fCAyXG4gICAgY29uc3QgdGlja3MgPSB0aGlzLm9wdGlvbnMudGlja1ZhbHVlcyAhPT0gdW5kZWZpbmVkICYmIHRoaXMub3B0aW9ucy50aWNrVmFsdWVzLmxlbmd0aCAhPT0gMD8gXy5tYXAodGhpcy5vcHRpb25zLnRpY2tWYWx1ZXMsZnVuY3Rpb24odil7cmV0dXJuIHYudmFsdWUgfSk6QXhpc1N0cnVjdC5nZXRUaWNrVmFsdWVzKGN1cnJlbnRBeGlzLCB0aWNrSW50ZXJ2YWwsIGRlY2ltYWxQbGFjZXMpXG4gICAgY29uc3QgZml4ZWQgPSB0aGlzLm9wdGlvbnMuemVyb0F4aXM/dGhpcy5zY2FsZSgwKTpob3Jpem9udGFsP3lBeGlzLm1pbjp4QXhpcy5taW5cbiAgICBjb25zdCBzdGFydCA9IHt4OiBob3Jpem9udGFsP3hBeGlzLm1pbjpmaXhlZCwgeTogaG9yaXpvbnRhbD9maXhlZDp5QXhpcy5taW59XG4gICAgY29uc3QgZW5kID0ge3g6aG9yaXpvbnRhbD94QXhpcy5tYXg6Zml4ZWQseTogaG9yaXpvbnRhbD9maXhlZDp5QXhpcy5tYXh9XG4gICAgY29uc3QgdGFpbExlbmd0aCA9IHRoaXMub3B0aW9ucy50YWlsTGVuZ3RoIHx8IDEwXG5cbiAgICBjb25zdCBtYXJnaW4gPSB0aGlzLm1hcmdpblxuICAgIGlmIChtYXJnaW4gIT09IHVuZGVmaW5lZCl7XG4gICAgICBpZiAoaG9yaXpvbnRhbCl7XG4gICAgICAgIHN0YXJ0LnggKz0gKG1hcmdpbi5sZWZ0IC0gdGFpbExlbmd0aCkgfHwgMFxuICAgICAgICBzdGFydC55ICs9IG1hcmdpbi50b3AgfHwgMFxuICAgICAgICBlbmQueCArPSAobWFyZ2luLmxlZnQpIHx8IDBcbiAgICAgICAgZW5kLnkgKz0gbWFyZ2luLnRvcCB8fCAwXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgc3RhcnQueCArPSBtYXJnaW4ubGVmdCB8fCAwXG4gICAgICAgIHN0YXJ0LnkgKz0gKG1hcmdpbi50b3AgKyB0YWlsTGVuZ3RoKSB8fCAwXG4gICAgICAgIGVuZC54ICs9IG1hcmdpbi5sZWZ0IHx8IDBcbiAgICAgICAgZW5kLnkgKz0gKG1hcmdpbi50b3AgLSB0YWlsTGVuZ3RoKSAgfHwgMFxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpdGVtOiBjdXJyZW50QXhpcyxcbiAgICAgIHBhdGg6IFBhdGhqcygpLm1vdmV0byhzdGFydCkubGluZXRvKGVuZCkuY2xvc2VwYXRoKCksXG4gICAgICB0aWNrczogdGlja3MsXG4gICAgICBsaW5lczogdGlja3MubWFwKChjLGkpID0+IHtcbiAgICAgICAgbGV0IHNjYWxlQmFzZSA9IGlzTmFOKGMpID8gaSA6IGNcbiAgICAgICAgY29uc3QgbGluZVN0YXJ0ID0ge3g6IGhvcml6b250YWwgPyB0aGlzLnNjYWxlKHNjYWxlQmFzZSkgKyBtYXJnaW4ubGVmdCA6IHhBeGlzLm1pbiArIG1hcmdpbi5sZWZ0LCB5OiBob3Jpem9udGFsID8geUF4aXMubWluICsgbWFyZ2luLnRvcCA6IHRoaXMuc2NhbGUoc2NhbGVCYXNlKSArIG1hcmdpbi50b3B9XG4gICAgICAgIHJldHVybiBQYXRoanMoKS5tb3ZldG8obGluZVN0YXJ0KS5saW5ldG8oaG9yaXpvbnRhbCA/IGxpbmVTdGFydC54IDogeEF4aXMubWF4ICsgbWFyZ2luLmxlZnQsIGhvcml6b250YWwgPyB5QXhpcy5tYXggKyAobWFyZ2luLnRvcCAtIHRhaWxMZW5ndGgpIDogbGluZVN0YXJ0LnkpXG4gICAgICB9LHRoaXMpXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF4aXMgZXh0ZW5kcyBDb21wb25lbnQge1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGNoYXJ0QXJlYSwgb3B0aW9ucywgc2NhbGUgfSA9IHRoaXMucHJvcHNcbiAgICBjb25zdCBob3Jpem9udGFsID0gb3B0aW9ucy5vcmllbnQgPT09J3RvcCcgfHwgb3B0aW9ucy5vcmllbnQgPT09J2JvdHRvbSdcblxuICAgIGNvbnN0IGF4aXMgPSBuZXcgQXhpc1N0cnVjdChzY2FsZSxvcHRpb25zLGNoYXJ0QXJlYSxob3Jpem9udGFsKS5heGlzKClcblxuICAgIGxldCB0ZXh0QW5jaG9yID0gJ3N0YXJ0J1xuICAgIGlmIChvcHRpb25zLm9yaWVudCA9PT0gJ3RvcCcgfHwgb3B0aW9ucy5vcmllbnQgPT09ICdib3R0b20nKSB0ZXh0QW5jaG9yID0gJ21pZGRsZSdcbiAgICBpZiAob3B0aW9ucy5vcmllbnQgPT09ICdsZWZ0JykgdGV4dEFuY2hvciA9ICdlbmQnXG4gICAgaWYgKG9wdGlvbnMub3JpZW50ID09PSAncmlnaHQnKSB0ZXh0QW5jaG9yID0gJ3N0YXJ0J1xuXG4gICAgbGV0IHh5ID0gWzAsMF1cbiAgICBpZiAob3B0aW9ucy5vcmllbnQgPT09ICd0b3AnKSAgeHkgPSBbMCwtNV1cbiAgICBpZiAob3B0aW9ucy5vcmllbnQgPT09ICdib3R0b20nKSB4eSA9IFswLDVdXG4gICAgaWYgKG9wdGlvbnMub3JpZW50ID09PSAnbGVmdCcpICB4eSA9IFstNSwtMTBdXG4gICAgaWYgKG9wdGlvbnMub3JpZW50ID09PSAncmlnaHQnKSAgeHkgPSBbNSw1XVxuXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLmNvbG9yICE9PSAnc3RyaW5nJykge1xuICAgICAgb3B0aW9ucy5jb2xvciA9ICcjM0U5MEYwJ1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5ncmlkQ29sb3IgIT09ICdzdHJpbmcnKSB7XG4gICAgICBvcHRpb25zLmdyaWRDb2xvciA9ICcjM0U5MEYwJ1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5vcGFjaXR5ICE9PSAnbnVtYmVyJykge1xuICAgICAgb3B0aW9ucy5vcGFjaXR5ID0gMC41XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLnN0cm9rZVdpZHRoICE9PSAnbnVtYmVyJykge1xuICAgICAgb3B0aW9ucy5zdHJva2VXaWR0aCA9IDNcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMudGlja1NpemUgIT09ICdudW1iZXInKSB7XG4gICAgICBvcHRpb25zLnRpY2tTaXplID0gMlxuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy50aWNrQ29sb3IgIT09ICdzdHJpbmcnKSB7XG4gICAgICBvcHRpb25zLnRpY2tDb2xvciA9ICdncmV5J1xuICAgIH1cblxuICAgIGNvbnN0IHRleHRTdHlsZSA9IGZvbnRBZGFwdChvcHRpb25zLmxhYmVsKVxuXG4gICAgY29uc3QgdGlja3MgPV8ubWFwKGF4aXMudGlja3MsIGZ1bmN0aW9uIChjLCBpKSB7XG4gICAgICBjb25zdCBsYWJlbCA9IG9wdGlvbnMubGFiZWxGdW5jdGlvbiAhPT0gdW5kZWZpbmVkPyBvcHRpb25zLmxhYmVsRnVuY3Rpb24uYXBwbHkodGhpcywgW2NdKSA6IGNcbiAgICAgIGxldCBzY2FsZUJhc2UgPSBpc05hTihjKSA/IGkgOiBjXG4gICAgICBsZXQgZ3h5ID0gaG9yaXpvbnRhbCA/IFtzY2FsZShzY2FsZUJhc2UpLGNoYXJ0QXJlYS55Lm1pbl06W2NoYXJ0QXJlYS54Lm1pbixzY2FsZShzY2FsZUJhc2UpXVxuXG4gICAgICBsZXQgcmV0dXJuVmFsdWVcbiAgICAgIGlmIChsYWJlbCAhPT0gdW5kZWZpbmVkICYmIGxhYmVsICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVyblZhbHVlID1cbiAgICAgICAgICA8RyBrZXk9e2l9IHg9e2d4eVswXX0geT17Z3h5WzFdfT5cbiAgICAgICAgICAgICAge29wdGlvbnMuc2hvd1RpY2tzICYmXG4gICAgICAgICAgICAgICAgPENpcmNsZSByPXtvcHRpb25zLnRpY2tTaXplfSBjeD1cIjBcIiBjeT1cIjBcIiBzdHJva2U9e29wdGlvbnMudGlja0NvbG9yfSBmaWxsPXtvcHRpb25zLnRpY2tDb2xvcn0gLz5cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB7b3B0aW9ucy5zaG93TGFiZWxzICYmXG4gICAgICAgICAgICAgICAgPFRleHQgeD17eHlbMF19IHk9e3h5WzFdfVxuICAgICAgICAgICAgICAgICAgICAgIGZvbnRGYW1pbHk9e3RleHRTdHlsZS5mb250RmFtaWx5fVxuICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplPXt0ZXh0U3R5bGUuZm9udFNpemV9XG4gICAgICAgICAgICAgICAgICAgICAgZm9udFdlaWdodD17dGV4dFN0eWxlLmZvbnRXZWlnaHR9XG4gICAgICAgICAgICAgICAgICAgICAgZm9udFN0eWxlPXt0ZXh0U3R5bGUuZm9udFN0eWxlfVxuICAgICAgICAgICAgICAgICAgICAgIGZpbGw9e3RleHRTdHlsZS5maWxsfVxuICAgICAgICAgICAgICAgICAgICAgIHRleHRBbmNob3I9e3RleHRBbmNob3J9PlxuICAgICAgICAgICAgICAgICAgICAgIHtsYWJlbH1cbiAgICAgICAgICAgICAgICA8L1RleHQ+fVxuICAgICAgICAgIDwvRz5cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJldHVyblZhbHVlXG4gICAgfSlcblxuXG4gICAgY29uc3QgZ3JpZExpbmVzID0gb3B0aW9ucy5zaG93TGluZXMgPyBfLm1hcChheGlzLmxpbmVzLCBmdW5jdGlvbiAoYywgaSkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgIDxQYXRoIGtleT17J2dyaWRMaW5lcycgKyBpfSBkPXtjLnByaW50KCl9IHN0cm9rZU9wYWNpdHk9e29wdGlvbnMub3BhY2l0eX0gc3Ryb2tlPXtvcHRpb25zLmdyaWRDb2xvcn0gZmlsbD1cIm5vbmVcIi8+XG4gICAgICAgICAgICApXG4gICAgfSkgOiBbXVxuXG4gICAgbGV0IG9mZnNldCA9IHtcbiAgICAgIHg6IGNoYXJ0QXJlYS5tYXJnaW4ubGVmdCAqIC0xLFxuICAgICAgeTogY2hhcnRBcmVhLm1hcmdpbi50b3AgKiAtMVxuICAgICAgLy8geDogMCxcbiAgICAgIC8vIHk6IDBcbiAgICB9XG5cbiAgICBsZXQgcmV0dXJuViA9IDxHPlxuICAgICAgICAgICAgICA8RyB4PXtvZmZzZXQueH0geT17b2Zmc2V0Lnl9PlxuICAgICAgICAgICAgICAgIHtvcHRpb25zLnNob3dBeGlzID8gPFBhdGggZD17YXhpcy5wYXRoLnByaW50KCl9IHN0cm9rZU9wYWNpdHk9e29wdGlvbnMub3BhY2l0eX0gc3Ryb2tlPXtvcHRpb25zLmNvbG9yfSBzdHJva2VXaWR0aD17b3B0aW9ucy5zdHJva2VXaWR0aH0gZmlsbD1cIm5vbmVcIi8+IDogbnVsbH1cbiAgICAgICAgICAgICAgPC9HPlxuICAgICAgICAgICAgICB7dGlja3N9XG4gICAgICAgICAgICAgIDxHIHg9e29mZnNldC54fSB5PXtvZmZzZXQueX0+XG4gICAgICAgICAgICAgICAge2dyaWRMaW5lc31cbiAgICAgICAgICAgICAgPC9HPlxuICAgICAgICAgICAgPC9HPlxuXG4gICAgcmV0dXJuIHJldHVyblZcblxuICB9XG59XG4iXX0=