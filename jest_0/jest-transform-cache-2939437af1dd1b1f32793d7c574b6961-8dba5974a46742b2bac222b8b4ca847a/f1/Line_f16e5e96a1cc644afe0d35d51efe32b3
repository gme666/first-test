42f5d3bd3a5c6a429961ce6d255ad181
Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();

















var _react=require('react');var _react2=_interopRequireDefault(_react);
var _reactNative=require('react-native');
var _reactNativeSvg=require('react-native-svg');var _reactNativeSvg2=_interopRequireDefault(_reactNativeSvg);
var _util=require('./util');
var _Axis=require('./Axis');var _Axis2=_interopRequireDefault(_Axis);
var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var

LineChart=function(_Component){_inherits(LineChart,_Component);

function LineChart(props,chartType){_classCallCheck(this,LineChart);var _this=_possibleConstructorReturn(this,(LineChart.__proto__||Object.getPrototypeOf(LineChart)).call(this,
props));
_this.chartType=chartType;return _this;
}_createClass(LineChart,[{key:'getMaxAndMin',value:function getMaxAndMin(

chart,key,scale,chartMin,chartMax){
var maxValue=void 0;
var minValue=void 0;
_lodash2.default.each(chart.curves,function(serie){
var values=_lodash2.default.map(serie.item,function(item){
return item[key];
});

var max=_lodash2.default.max(values);
if(maxValue===undefined||max>maxValue)maxValue=max;
var min=_lodash2.default.min(values);
if(minValue===undefined||min<minValue)minValue=min;

maxValue=chartMax>maxValue?chartMax:maxValue;
minValue=chartMin<minValue?chartMin:minValue;
});

return{
minValue:minValue,
maxValue:maxValue,
min:scale(minValue),
max:scale(maxValue)};

}},{key:'color',value:function color(

i){
var color=this.props.options.color;
if(!_lodash2.default.isString(this.props.options.color))color=color.color;
var pallete=this.props.pallete||_util.Colors.mix(color||'#9ac7f7');
return _util.Colors.string((0,_util.cyclic)(pallete,i));
}},{key:'render',value:function render()

{
var noDataMsg=this.props.noDataMessage||'No data available';
if(this.props.data===undefined)return _react2.default.createElement(_reactNative.Text,null,noDataMsg);

var options=new _util.Options(this.props);

var accessor=function accessor(key){
return function(x){
return x[key];
};
};

var chart=this.chartType({
data:this.props.data,
xaccessor:accessor(this.props.xKey),
yaccessor:accessor(this.props.yKey),
width:options.chartWidth,
height:options.chartHeight,
closed:false,
min:options.min,
max:options.max});


var chartArea={
x:this.getMaxAndMin(chart,this.props.xKey,chart.xscale),
y:this.getMaxAndMin(chart,this.props.yKey,chart.yscale,options.min,options.max),
margin:options.margin};


var showAreas=typeof this.props.options.showAreas!=='undefined'?this.props.options.showAreas:true;
var strokeWidth=typeof this.props.options.strokeWidth!=='undefined'?this.props.options.strokeWidth:'1';
var lines=_lodash2.default.map(chart.curves,function(c,i){
return _react2.default.createElement(_reactNativeSvg.Path,{key:'lines'+i,d:c.line.path.print(),stroke:this.color(i),strokeWidth:strokeWidth,fill:'none'});
}.bind(this));
var areas=null;

if(showAreas){
areas=_lodash2.default.map(chart.curves,function(c,i){
return _react2.default.createElement(_reactNativeSvg.Path,{key:'areas'+i,d:c.area.path.print(),fillOpacity:0.5,stroke:'none',fill:this.color(i)});
}.bind(this));
}

var textStyle=(0,_util.fontAdapt)(options.label);
var regions=void 0;
if(this.props.regions!='undefined'){
var styling=typeof this.props.regionStyling!='undefined'?
this.props.regionStyling:{};
var labelOffsetAllRegions=typeof styling.labelOffset!='undefined'?
styling.labelOffset:{};

regions=_lodash2.default.map(this.props.regions,function(c,i){
var x=void 0,y=void 0,height=void 0,width=void 0,y1=void 0,y2=void 0,labelX=void 0,labelY=void 0;

var labelOffset=typeof c.labelOffset!='undefined'?
c.labelOffset:{};
var labelOffsetLeft=typeof labelOffsetAllRegions.left!='undefined'?
typeof labelOffset.left!='undefined'?
labelOffset.left:labelOffsetAllRegions.left:20;
var labelOffsetTop=typeof labelOffsetAllRegions.top!='undefined'?
typeof labelOffset.top!='undefined'?
labelOffset.top:labelOffsetAllRegions.top:0;
var fillOpacity=typeof styling.fillOpacity!='undefined'?
typeof c.fillOpacity!='undefined'?
c.fillOpacity:styling.fillOpacity:0.5;

y1=chart.yscale(c.from);
y2=chart.yscale(c.to);

x=0;
y=y1;
height=y2-y1;
width=chartArea.x.max;

labelX=labelOffsetLeft;
labelY=y2+labelOffsetTop;

var regionLabel=typeof c.label!='undefined'?
_react2.default.createElement(_reactNativeSvg.Text,{fontFamily:textStyle.fontFamily,
fontSize:textStyle.fontSize,
fontWeight:textStyle.fontWeight,
fontStyle:textStyle.fontStyle,
fill:textStyle.fill,
textAnchor:'middle',
x:labelX,
y:labelY},c.label):
null;

return(
_react2.default.createElement(_reactNativeSvg.G,{key:'region'+i},
_react2.default.createElement(_reactNativeSvg.Rect,{key:'region'+i,x:x,y:y,width:width,height:height,
fill:c.fill,fillOpacity:fillOpacity}),
regionLabel));


}.bind(this));
}

var returnValue=_react2.default.createElement(_reactNativeSvg2.default,{width:options.width,height:options.height},
_react2.default.createElement(_reactNativeSvg.G,{x:options.margin.left,y:options.margin.top},
regions,
areas,
lines,
_react2.default.createElement(_Axis2.default,{key:'x',scale:chart.xscale,options:options.axisX,chartArea:chartArea}),
_react2.default.createElement(_Axis2.default,{key:'y',scale:chart.yscale,options:options.axisY,chartArea:chartArea})));



return returnValue;
}}]);return LineChart;}(_react.Component);exports.default=LineChart;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxpbmUuanMiXSwibmFtZXMiOlsiTGluZUNoYXJ0IiwicHJvcHMiLCJjaGFydFR5cGUiLCJjaGFydCIsImtleSIsInNjYWxlIiwiY2hhcnRNaW4iLCJjaGFydE1heCIsIm1heFZhbHVlIiwibWluVmFsdWUiLCJlYWNoIiwiY3VydmVzIiwic2VyaWUiLCJ2YWx1ZXMiLCJtYXAiLCJpdGVtIiwibWF4IiwidW5kZWZpbmVkIiwibWluIiwiaSIsImNvbG9yIiwib3B0aW9ucyIsImlzU3RyaW5nIiwicGFsbGV0ZSIsIm1peCIsInN0cmluZyIsIm5vRGF0YU1zZyIsIm5vRGF0YU1lc3NhZ2UiLCJkYXRhIiwiYWNjZXNzb3IiLCJ4IiwieGFjY2Vzc29yIiwieEtleSIsInlhY2Nlc3NvciIsInlLZXkiLCJ3aWR0aCIsImNoYXJ0V2lkdGgiLCJoZWlnaHQiLCJjaGFydEhlaWdodCIsImNsb3NlZCIsImNoYXJ0QXJlYSIsImdldE1heEFuZE1pbiIsInhzY2FsZSIsInkiLCJ5c2NhbGUiLCJtYXJnaW4iLCJzaG93QXJlYXMiLCJzdHJva2VXaWR0aCIsImxpbmVzIiwiYyIsImxpbmUiLCJwYXRoIiwicHJpbnQiLCJiaW5kIiwiYXJlYXMiLCJhcmVhIiwidGV4dFN0eWxlIiwibGFiZWwiLCJyZWdpb25zIiwic3R5bGluZyIsInJlZ2lvblN0eWxpbmciLCJsYWJlbE9mZnNldEFsbFJlZ2lvbnMiLCJsYWJlbE9mZnNldCIsInkxIiwieTIiLCJsYWJlbFgiLCJsYWJlbFkiLCJsYWJlbE9mZnNldExlZnQiLCJsZWZ0IiwibGFiZWxPZmZzZXRUb3AiLCJ0b3AiLCJmaWxsT3BhY2l0eSIsImZyb20iLCJ0byIsInJlZ2lvbkxhYmVsIiwiZm9udEZhbWlseSIsImZvbnRTaXplIiwiZm9udFdlaWdodCIsImZvbnRTdHlsZSIsImZpbGwiLCJyZXR1cm5WYWx1ZSIsImF4aXNYIiwiYXhpc1kiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQWtCQSw0QjtBQUNBO0FBQ0EsZ0Q7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LFlBQWFSLFdBRDdCLEVBREY7QUFHR0csV0FISCxDQURGOzs7QUFPRCxDQTVDbUMsQ0E0Q2xDckIsSUE1Q2tDLENBNEM3QixJQTVDNkIsQ0FBMUIsQ0FBVjtBQTZDRDs7QUFFRCxHQUFJMkIsYUFBYyx3REFBSyxNQUFPM0QsUUFBUWMsS0FBcEIsQ0FBMkIsT0FBUWQsUUFBUWdCLE1BQTNDO0FBQ0osaURBQUcsRUFBR2hCLFFBQVF3QixNQUFSLENBQWV1QixJQUFyQixDQUEyQixFQUFHL0MsUUFBUXdCLE1BQVIsQ0FBZXlCLEdBQTdDO0FBQ1FaLE9BRFI7QUFFUUosS0FGUjtBQUdRTixLQUhSO0FBSUksOENBQU0sSUFBSSxHQUFWLENBQWMsTUFBTzdDLE1BQU11QyxNQUEzQixDQUFtQyxRQUFTckIsUUFBUTRELEtBQXBELENBQTJELFVBQVd6QyxTQUF0RSxFQUpKO0FBS0ksOENBQU0sSUFBSSxHQUFWLENBQWMsTUFBT3JDLE1BQU15QyxNQUEzQixDQUFtQyxRQUFTdkIsUUFBUTZELEtBQXBELENBQTJELFVBQVcxQyxTQUF0RSxFQUxKLENBREksQ0FBbEI7Ozs7QUFVQSxNQUFPd0MsWUFBUDtBQUNELEMseURBbkprQmhGLFMiLCJmaWxlIjoiTGluZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5Db3B5cmlnaHQgMjAxNiBDYXBpdGFsIE9uZSBTZXJ2aWNlcywgTExDXG5cbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG55b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblxuICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXG5Vbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG5XSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cblNQRFgtQ29weXJpZ2h0OiBDb3B5cmlnaHQgKGMpIENhcGl0YWwgT25lIFNlcnZpY2VzLCBMTENcblNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBBcGFjaGUtMi4wXG4qL1xuXG5pbXBvcnQgUmVhY3Qse0NvbXBvbmVudH0gZnJvbSAncmVhY3QnXG5pbXBvcnQge1RleHQgYXMgUmVhY3RUZXh0fSAgZnJvbSAncmVhY3QtbmF0aXZlJ1xuaW1wb3J0IFN2Zyx7IEcsIFBhdGgsIFJlY3QsIFRleHQgfSBmcm9tICdyZWFjdC1uYXRpdmUtc3ZnJ1xuaW1wb3J0IHsgQ29sb3JzLCBPcHRpb25zLCBjeWNsaWMsIGZvbnRBZGFwdCB9IGZyb20gJy4vdXRpbCdcbmltcG9ydCBBeGlzIGZyb20gJy4vQXhpcydcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGluZUNoYXJ0IGV4dGVuZHMgQ29tcG9uZW50IHtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcywgY2hhcnRUeXBlKSB7XG4gICAgc3VwZXIocHJvcHMpXG4gICAgdGhpcy5jaGFydFR5cGUgPSBjaGFydFR5cGVcbiAgfVxuXG4gIGdldE1heEFuZE1pbihjaGFydCwga2V5LCBzY2FsZSwgY2hhcnRNaW4sIGNoYXJ0TWF4KSB7XG4gICAgbGV0IG1heFZhbHVlXG4gICAgbGV0IG1pblZhbHVlXG4gICAgXy5lYWNoKGNoYXJ0LmN1cnZlcywgZnVuY3Rpb24gKHNlcmllKSB7XG4gICAgICBsZXQgdmFsdWVzID0gXy5tYXAoc2VyaWUuaXRlbSwgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZW1ba2V5XVxuICAgICAgfSlcblxuICAgICAgbGV0IG1heCA9IF8ubWF4KHZhbHVlcylcbiAgICAgIGlmIChtYXhWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IG1heCA+IG1heFZhbHVlKSBtYXhWYWx1ZSA9IG1heFxuICAgICAgbGV0IG1pbiA9IF8ubWluKHZhbHVlcylcbiAgICAgIGlmIChtaW5WYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IG1pbiA8IG1pblZhbHVlKSBtaW5WYWx1ZSA9IG1pblxuXG4gICAgICBtYXhWYWx1ZSA9IGNoYXJ0TWF4ID4gbWF4VmFsdWUgPyBjaGFydE1heCA6IG1heFZhbHVlXG4gICAgICBtaW5WYWx1ZSA9IGNoYXJ0TWluIDwgbWluVmFsdWUgPyBjaGFydE1pbiA6IG1pblZhbHVlXG4gICAgfSlcblxuICAgIHJldHVybiB7XG4gICAgICBtaW5WYWx1ZTogbWluVmFsdWUsXG4gICAgICBtYXhWYWx1ZTogbWF4VmFsdWUsXG4gICAgICBtaW46IHNjYWxlKG1pblZhbHVlKSxcbiAgICAgIG1heDogc2NhbGUobWF4VmFsdWUpXG4gICAgfVxuICB9XG5cbiAgY29sb3IoaSkge1xuICAgIGxldCBjb2xvciA9IHRoaXMucHJvcHMub3B0aW9ucy5jb2xvclxuICAgIGlmICghXy5pc1N0cmluZyh0aGlzLnByb3BzLm9wdGlvbnMuY29sb3IpKSBjb2xvciA9IGNvbG9yLmNvbG9yXG4gICAgbGV0IHBhbGxldGUgPSB0aGlzLnByb3BzLnBhbGxldGUgfHwgQ29sb3JzLm1peChjb2xvciB8fCAnIzlhYzdmNycpXG4gICAgcmV0dXJuIENvbG9ycy5zdHJpbmcoY3ljbGljKHBhbGxldGUsIGkpKVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IG5vRGF0YU1zZyA9IHRoaXMucHJvcHMubm9EYXRhTWVzc2FnZSB8fCAnTm8gZGF0YSBhdmFpbGFibGUnXG4gICAgaWYgKHRoaXMucHJvcHMuZGF0YSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gKDxSZWFjdFRleHQ+e25vRGF0YU1zZ308L1JlYWN0VGV4dD4pXG5cbiAgICBsZXQgb3B0aW9ucyA9IG5ldyBPcHRpb25zKHRoaXMucHJvcHMpXG5cbiAgICBsZXQgYWNjZXNzb3IgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgcmV0dXJuIHhba2V5XVxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBjaGFydCA9IHRoaXMuY2hhcnRUeXBlKHtcbiAgICAgIGRhdGE6IHRoaXMucHJvcHMuZGF0YSxcbiAgICAgIHhhY2Nlc3NvcjogYWNjZXNzb3IodGhpcy5wcm9wcy54S2V5KSxcbiAgICAgIHlhY2Nlc3NvcjogYWNjZXNzb3IodGhpcy5wcm9wcy55S2V5KSxcbiAgICAgIHdpZHRoOiBvcHRpb25zLmNoYXJ0V2lkdGgsXG4gICAgICBoZWlnaHQ6IG9wdGlvbnMuY2hhcnRIZWlnaHQsXG4gICAgICBjbG9zZWQ6IGZhbHNlLFxuICAgICAgbWluOiBvcHRpb25zLm1pbixcbiAgICAgIG1heDogb3B0aW9ucy5tYXhcbiAgICB9KVxuXG4gICAgbGV0IGNoYXJ0QXJlYSA9IHtcbiAgICAgIHg6dGhpcy5nZXRNYXhBbmRNaW4oY2hhcnQsdGhpcy5wcm9wcy54S2V5LGNoYXJ0LnhzY2FsZSksXG4gICAgICB5OnRoaXMuZ2V0TWF4QW5kTWluKGNoYXJ0LHRoaXMucHJvcHMueUtleSxjaGFydC55c2NhbGUsb3B0aW9ucy5taW4sb3B0aW9ucy5tYXgpLFxuICAgICAgbWFyZ2luOm9wdGlvbnMubWFyZ2luXG4gICAgfVxuXG4gICAgbGV0IHNob3dBcmVhcyA9IHR5cGVvZih0aGlzLnByb3BzLm9wdGlvbnMuc2hvd0FyZWFzKSAhPT0gJ3VuZGVmaW5lZCcgPyB0aGlzLnByb3BzLm9wdGlvbnMuc2hvd0FyZWFzIDogdHJ1ZTtcbiAgICBsZXQgc3Ryb2tlV2lkdGggPSB0eXBlb2YodGhpcy5wcm9wcy5vcHRpb25zLnN0cm9rZVdpZHRoKSAhPT0gJ3VuZGVmaW5lZCcgPyB0aGlzLnByb3BzLm9wdGlvbnMuc3Ryb2tlV2lkdGggOiAnMSc7XG4gICAgbGV0IGxpbmVzID0gXy5tYXAoY2hhcnQuY3VydmVzLCBmdW5jdGlvbiAoYywgaSkge1xuICAgICAgcmV0dXJuIDxQYXRoIGtleT17J2xpbmVzJyArIGl9IGQ9eyBjLmxpbmUucGF0aC5wcmludCgpIH0gc3Ryb2tlPXsgdGhpcy5jb2xvcihpKSB9IHN0cm9rZVdpZHRoPXtzdHJva2VXaWR0aH0gZmlsbD1cIm5vbmVcIi8+XG4gICAgfS5iaW5kKHRoaXMpKVxuICAgIGxldCBhcmVhcyA9IG51bGxcblxuICAgIGlmKHNob3dBcmVhcyl7XG4gICAgICBhcmVhcyA9IF8ubWFwKGNoYXJ0LmN1cnZlcywgZnVuY3Rpb24gKGMsIGkpIHtcbiAgICAgICAgcmV0dXJuIDxQYXRoIGtleT17J2FyZWFzJyArIGl9IGQ9eyBjLmFyZWEucGF0aC5wcmludCgpIH0gZmlsbE9wYWNpdHk9ezAuNX0gc3Ryb2tlPVwibm9uZVwiIGZpbGw9eyB0aGlzLmNvbG9yKGkpIH0vPlxuICAgICAgfS5iaW5kKHRoaXMpKVxuICAgIH1cblxuICAgIGxldCB0ZXh0U3R5bGUgPSBmb250QWRhcHQob3B0aW9ucy5sYWJlbClcbiAgICBsZXQgcmVnaW9uc1xuICAgIGlmKHRoaXMucHJvcHMucmVnaW9ucyAhPSAndW5kZWZpbmVkJykge1xuICAgICAgbGV0IHN0eWxpbmcgPSB0eXBlb2YodGhpcy5wcm9wcy5yZWdpb25TdHlsaW5nKSAhPSAndW5kZWZpbmVkJyA/XG4gICAgICAgIHRoaXMucHJvcHMucmVnaW9uU3R5bGluZyA6IHt9XG4gICAgICBsZXQgbGFiZWxPZmZzZXRBbGxSZWdpb25zID0gdHlwZW9mKHN0eWxpbmcubGFiZWxPZmZzZXQpICE9ICd1bmRlZmluZWQnID9cbiAgICAgICAgc3R5bGluZy5sYWJlbE9mZnNldCA6IHt9XG5cbiAgICAgIHJlZ2lvbnMgPSBfLm1hcCh0aGlzLnByb3BzLnJlZ2lvbnMsIGZ1bmN0aW9uIChjLCBpKSB7XG4gICAgICAgIGxldCB4LCB5LCBoZWlnaHQsIHdpZHRoLCB5MSwgeTIsIGxhYmVsWCwgbGFiZWxZXG5cbiAgICAgICAgbGV0IGxhYmVsT2Zmc2V0ID0gdHlwZW9mKGMubGFiZWxPZmZzZXQpICE9ICd1bmRlZmluZWQnID9cbiAgICAgICAgICBjLmxhYmVsT2Zmc2V0IDoge31cbiAgICAgICAgbGV0IGxhYmVsT2Zmc2V0TGVmdCA9IHR5cGVvZihsYWJlbE9mZnNldEFsbFJlZ2lvbnMubGVmdCkgIT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICA/ICh0eXBlb2YobGFiZWxPZmZzZXQubGVmdCkgIT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgICAgPyAgbGFiZWxPZmZzZXQubGVmdCA6IGxhYmVsT2Zmc2V0QWxsUmVnaW9ucy5sZWZ0KSA6IDIwXG4gICAgICAgIGxldCBsYWJlbE9mZnNldFRvcCA9IHR5cGVvZihsYWJlbE9mZnNldEFsbFJlZ2lvbnMudG9wKSAhPSAndW5kZWZpbmVkJ1xuICAgICAgICAgID8gKHR5cGVvZihsYWJlbE9mZnNldC50b3ApICE9ICd1bmRlZmluZWQnXG4gICAgICAgICAgICAgID8gIGxhYmVsT2Zmc2V0LnRvcCA6IGxhYmVsT2Zmc2V0QWxsUmVnaW9ucy50b3ApIDogMFxuICAgICAgICBsZXQgZmlsbE9wYWNpdHkgPSB0eXBlb2Yoc3R5bGluZy5maWxsT3BhY2l0eSkgIT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICA/ICh0eXBlb2YoYy5maWxsT3BhY2l0eSkgIT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgICAgPyAgYy5maWxsT3BhY2l0eSA6IHN0eWxpbmcuZmlsbE9wYWNpdHkpIDogMC41XG5cbiAgICAgICAgeTEgPSBjaGFydC55c2NhbGUoYy5mcm9tKVxuICAgICAgICB5MiA9IGNoYXJ0LnlzY2FsZShjLnRvKVxuXG4gICAgICAgIHggPSAwXG4gICAgICAgIHkgPSB5MVxuICAgICAgICBoZWlnaHQgPSAoeTIgLSB5MSlcbiAgICAgICAgd2lkdGggPSBjaGFydEFyZWEueC5tYXhcblxuICAgICAgICBsYWJlbFggPSBsYWJlbE9mZnNldExlZnRcbiAgICAgICAgbGFiZWxZID0geTIgKyBsYWJlbE9mZnNldFRvcFxuXG4gICAgICAgIGxldCByZWdpb25MYWJlbCA9IHR5cGVvZihjLmxhYmVsKSAhPSAndW5kZWZpbmVkJyA/IChcbiAgICAgICAgICA8VGV4dCBmb250RmFtaWx5PXt0ZXh0U3R5bGUuZm9udEZhbWlseX1cbiAgICAgICAgICAgICAgICBmb250U2l6ZT17dGV4dFN0eWxlLmZvbnRTaXplfVxuICAgICAgICAgICAgICAgIGZvbnRXZWlnaHQ9e3RleHRTdHlsZS5mb250V2VpZ2h0fVxuICAgICAgICAgICAgICAgIGZvbnRTdHlsZT17dGV4dFN0eWxlLmZvbnRTdHlsZX1cbiAgICAgICAgICAgICAgICBmaWxsPXt0ZXh0U3R5bGUuZmlsbH1cbiAgICAgICAgICAgICAgICB0ZXh0QW5jaG9yPVwibWlkZGxlXCJcbiAgICAgICAgICAgICAgICB4PXtsYWJlbFh9XG4gICAgICAgICAgICAgICAgeT17bGFiZWxZfT57IGMubGFiZWwgfTwvVGV4dD5cbiAgICAgICAgKSA6IG51bGxcblxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIDxHIGtleT17J3JlZ2lvbicgKyBpfT5cbiAgICAgICAgICAgIDxSZWN0IGtleT17J3JlZ2lvbicgKyBpfSB4PXt4fSB5PXt5fSB3aWR0aD17d2lkdGh9IGhlaWdodD17aGVpZ2h0fVxuICAgICAgICAgICAgICBmaWxsPXtjLmZpbGx9IGZpbGxPcGFjaXR5PXtmaWxsT3BhY2l0eX0vPlxuICAgICAgICAgICAge3JlZ2lvbkxhYmVsfVxuICAgICAgICAgIDwvRz5cbiAgICAgICAgKVxuICAgICAgfS5iaW5kKHRoaXMpKVxuICAgIH1cblxuICAgIGxldCByZXR1cm5WYWx1ZSA9IDxTdmcgd2lkdGg9e29wdGlvbnMud2lkdGh9IGhlaWdodD17b3B0aW9ucy5oZWlnaHR9PlxuICAgICAgICAgICAgICAgICAgPEcgeD17b3B0aW9ucy5tYXJnaW4ubGVmdH0geT17b3B0aW9ucy5tYXJnaW4udG9wfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgcmVnaW9ucyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB7IGFyZWFzIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHsgbGluZXMgfVxuICAgICAgICAgICAgICAgICAgICAgIDxBeGlzIGtleT1cInhcIiBzY2FsZT17Y2hhcnQueHNjYWxlfSBvcHRpb25zPXtvcHRpb25zLmF4aXNYfSBjaGFydEFyZWE9e2NoYXJ0QXJlYX0gLz5cbiAgICAgICAgICAgICAgICAgICAgICA8QXhpcyBrZXk9XCJ5XCIgc2NhbGU9e2NoYXJ0LnlzY2FsZX0gb3B0aW9ucz17b3B0aW9ucy5heGlzWX0gY2hhcnRBcmVhPXtjaGFydEFyZWF9IC8+XG4gICAgICAgICAgICAgICAgICA8L0c+XG4gICAgICAgICAgICAgIDwvU3ZnPlxuXG4gICAgcmV0dXJuIHJldHVyblZhbHVlXG4gIH1cbn1cbiJdfQ==