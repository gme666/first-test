b1481de188c6d73bcbf37d1818edcbcf
Object.defineProperty(exports,"__esModule",{value:true});exports.default=

















































































function(props,container){var

x=





props.x,y=props.y,dx=props.dx,dy=props.dy,textAnchor=props.textAnchor,startOffset=props.startOffset;


var deltaX=parseDelta(dx);
var deltaY=parseDelta(dy);var
children=props.children;
var content=null;


if(typeof children==='string'||typeof children==='number'){
var childrenString=children.toString();
if(container){
children=_react2.default.createElement(_TSpan2.default,null,childrenString);
}else{
content=childrenString;
children=null;
}
}else if(_react.Children.count(children)>1||Array.isArray(children)){
children=_react.Children.map(children,function(child){
if(typeof child==='string'||typeof child==='number'){
return _react2.default.createElement(_TSpan2.default,null,child.toString());
}else{
return child;
}
});
}

return{
textAnchor:anchors[textAnchor]||0,
font:extractFont(props),
children:children,
content:content,
deltaX:deltaX,
deltaY:deltaY,
startOffset:(startOffset||0).toString(),
positionX:_lodash2.default.isNil(x)?null:x.toString(),
positionY:_lodash2.default.isNil(y)?null:y.toString()};

};var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);var _react=require('react');var _react2=_interopRequireDefault(_react);var _TSpan=require('../../elements/TSpan');var _TSpan2=_interopRequireDefault(_TSpan);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var fontRegExp=/^\s*((?:(?:normal|bold|italic)\s+)*)(?:(\d+(?:\.\d+)?)[ptexm%]*(?:\s*\/.*?)?\s+)?\s*"?([^"]*)/i;var fontFamilyPrefix=/^[\s"']*/;var fontFamilySuffix=/[\s"']*$/;var spaceReg=/\s+/;var commaReg=/,/g;var anchors={auto:0,start:1,middle:2,end:3};var cachedFontObjectsFromString={};function extractSingleFontFamily(fontFamilyString){return fontFamilyString?fontFamilyString.split(commaReg)[0].replace(fontFamilyPrefix,'').replace(fontFamilySuffix,''):null;}function parseFontString(font){if(cachedFontObjectsFromString.hasOwnProperty(font)){return cachedFontObjectsFromString[font];}var match=fontRegExp.exec(font);if(!match){return null;}var fontFamily=extractSingleFontFamily(match[3]);var fontSize=+match[2]||12;var isBold=/bold/.exec(match[1]);var isItalic=/italic/.exec(match[1]);cachedFontObjectsFromString[font]={fontFamily:fontFamily,fontSize:fontSize,fontWeight:isBold?'bold':'normal',fontStyle:isItalic?'italic':'normal'};return cachedFontObjectsFromString[font];}function extractFont(props){var font=props.font;var fontSize=+props.fontSize;var ownedFont={fontFamily:extractSingleFontFamily(props.fontFamily),fontSize:isNaN(fontSize)?null:fontSize,fontWeight:props.fontWeight,fontStyle:props.fontStyle};if(typeof props.font==='string'){font=parseFontString(props.font);}ownedFont=_lodash2.default.pickBy(ownedFont,function(prop){return!_lodash2.default.isNil(prop);});return _lodash2.default.defaults(ownedFont,font);}function parseDelta(delta){if(typeof delta==='string'){if(isNaN(+delta)){return delta.trim().replace(commaReg,' ').split(spaceReg).map(function(d){return+d||0;});}else{return[+delta];}}else if(typeof delta==='number'){return[delta];}else{return[];}}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dHJhY3RUZXh0LmpzIl0sIm5hbWVzIjpbInByb3BzIiwiY29udGFpbmVyIiwieCIsInkiLCJkeCIsImR5IiwidGV4dEFuY2hvciIsInN0YXJ0T2Zmc2V0IiwiZGVsdGFYIiwicGFyc2VEZWx0YSIsImRlbHRhWSIsImNoaWxkcmVuIiwiY29udGVudCIsImNoaWxkcmVuU3RyaW5nIiwidG9TdHJpbmciLCJjb3VudCIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsImNoaWxkIiwiYW5jaG9ycyIsImZvbnQiLCJleHRyYWN0Rm9udCIsInBvc2l0aW9uWCIsImlzTmlsIiwicG9zaXRpb25ZIiwiZm9udFJlZ0V4cCIsImZvbnRGYW1pbHlQcmVmaXgiLCJmb250RmFtaWx5U3VmZml4Iiwic3BhY2VSZWciLCJjb21tYVJlZyIsImF1dG8iLCJzdGFydCIsIm1pZGRsZSIsImVuZCIsImNhY2hlZEZvbnRPYmplY3RzRnJvbVN0cmluZyIsImV4dHJhY3RTaW5nbGVGb250RmFtaWx5IiwiZm9udEZhbWlseVN0cmluZyIsInNwbGl0IiwicmVwbGFjZSIsInBhcnNlRm9udFN0cmluZyIsImhhc093blByb3BlcnR5IiwibWF0Y2giLCJleGVjIiwiZm9udEZhbWlseSIsImZvbnRTaXplIiwiaXNCb2xkIiwiaXNJdGFsaWMiLCJmb250V2VpZ2h0IiwiZm9udFN0eWxlIiwib3duZWRGb250IiwiaXNOYU4iLCJwaWNrQnkiLCJwcm9wIiwiZGVmYXVsdHMiLCJkZWx0YSIsInRyaW0iLCJkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBa0ZlLFNBQVNBLEtBQVQsQ0FBZ0JDLFNBQWhCLENBQTJCOztBQUVsQ0MsQ0FGa0M7Ozs7OztBQVFsQ0YsS0FSa0MsQ0FFbENFLENBRmtDLENBR2xDQyxDQUhrQyxDQVFsQ0gsS0FSa0MsQ0FHbENHLENBSGtDLENBSWxD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LENBQ3ZCLEdBQUksTUFBT0EsTUFBUCxHQUFpQixRQUFyQixDQUErQixDQUMzQixHQUFJSixNQUFNLENBQUNJLEtBQVAsQ0FBSixDQUFtQixDQUNmLE1BQU9BLE9BQU1DLElBQU4sR0FBYWpCLE9BQWIsQ0FBcUJULFFBQXJCLENBQStCLEdBQS9CLEVBQW9DUSxLQUFwQyxDQUEwQ1QsUUFBMUMsRUFBb0RYLEdBQXBELENBQXdELGtCQUFLLENBQUN1QyxDQUFELEVBQU0sQ0FBWCxFQUF4RCxDQUFQLENBQ0gsQ0FGRCxJQUVPLENBQ0gsTUFBTyxDQUFDLENBQUNGLEtBQUYsQ0FBUCxDQUNILENBQ0osQ0FORCxJQU1PLElBQUksTUFBT0EsTUFBUCxHQUFpQixRQUFyQixDQUErQixDQUNsQyxNQUFPLENBQUNBLEtBQUQsQ0FBUCxDQUNILENBRk0sSUFFQSxDQUNILE1BQU8sRUFBUCxDQUNILENBQ0oiLCJmaWxlIjoiZXh0cmFjdFRleHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IFJlYWN0LCB7Q2hpbGRyZW59IGZyb20gJ3JlYWN0JztcbmltcG9ydCBUU3BhbiBmcm9tICcuLi8uLi9lbGVtZW50cy9UU3Bhbic7XG5cbmNvbnN0IGZvbnRSZWdFeHAgPSAvXlxccyooKD86KD86bm9ybWFsfGJvbGR8aXRhbGljKVxccyspKikoPzooXFxkKyg/OlxcLlxcZCspPylbcHRleG0lXSooPzpcXHMqXFwvLio/KT9cXHMrKT9cXHMqXCI/KFteXCJdKikvaTtcbmNvbnN0IGZvbnRGYW1pbHlQcmVmaXggPSAvXltcXHNcIiddKi87XG5jb25zdCBmb250RmFtaWx5U3VmZml4ID0gL1tcXHNcIiddKiQvO1xuY29uc3Qgc3BhY2VSZWcgPSAvXFxzKy87XG5jb25zdCBjb21tYVJlZyA9IC8sL2c7XG5cbmNvbnN0IGFuY2hvcnMgPSB7XG4gICAgYXV0bzogMCxcbiAgICBzdGFydDogMSxcbiAgICBtaWRkbGU6IDIsXG4gICAgZW5kOiAzXG59O1xuXG5sZXQgY2FjaGVkRm9udE9iamVjdHNGcm9tU3RyaW5nID0ge307XG5cbmZ1bmN0aW9uIGV4dHJhY3RTaW5nbGVGb250RmFtaWx5KGZvbnRGYW1pbHlTdHJpbmcpIHtcbiAgICAvLyBTVkcgb24gdGhlIHdlYiBhbGxvd3MgZm9yIG11bHRpcGxlIGZvbnQtZmFtaWxpZXMgdG8gYmUgc3BlY2lmaWVkLlxuICAgIC8vIEZvciBjb21wYXRpYmlsaXR5LCB3ZSBleHRyYWN0IHRoZSBmaXJzdCBmb250LWZhbWlseSwgaG9waW5nXG4gICAgLy8gd2UnbGwgZ2V0IGEgbWF0Y2guXG4gICAgcmV0dXJuIGZvbnRGYW1pbHlTdHJpbmcgPyBmb250RmFtaWx5U3RyaW5nLnNwbGl0KGNvbW1hUmVnKVswXVxuICAgICAgICAucmVwbGFjZShmb250RmFtaWx5UHJlZml4LCAnJylcbiAgICAgICAgLnJlcGxhY2UoZm9udEZhbWlseVN1ZmZpeCwgJycpIDogbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VGb250U3RyaW5nKGZvbnQpIHtcbiAgICBpZiAoY2FjaGVkRm9udE9iamVjdHNGcm9tU3RyaW5nLmhhc093blByb3BlcnR5KGZvbnQpKSB7XG4gICAgICAgIHJldHVybiBjYWNoZWRGb250T2JqZWN0c0Zyb21TdHJpbmdbZm9udF07XG4gICAgfVxuICAgIGxldCBtYXRjaCA9IGZvbnRSZWdFeHAuZXhlYyhmb250KTtcbiAgICBpZiAoIW1hdGNoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBsZXQgZm9udEZhbWlseSA9IGV4dHJhY3RTaW5nbGVGb250RmFtaWx5KG1hdGNoWzNdKTtcbiAgICBsZXQgZm9udFNpemUgPSArbWF0Y2hbMl0gfHwgMTI7XG4gICAgbGV0IGlzQm9sZCA9IC9ib2xkLy5leGVjKG1hdGNoWzFdKTtcbiAgICBsZXQgaXNJdGFsaWMgPSAvaXRhbGljLy5leGVjKG1hdGNoWzFdKTtcbiAgICBjYWNoZWRGb250T2JqZWN0c0Zyb21TdHJpbmdbZm9udF0gPSB7XG4gICAgICAgIGZvbnRGYW1pbHk6IGZvbnRGYW1pbHksXG4gICAgICAgIGZvbnRTaXplOiBmb250U2l6ZSxcbiAgICAgICAgZm9udFdlaWdodDogaXNCb2xkID8gJ2JvbGQnIDogJ25vcm1hbCcsXG4gICAgICAgIGZvbnRTdHlsZTogaXNJdGFsaWMgPyAnaXRhbGljJyA6ICdub3JtYWwnXG4gICAgfTtcbiAgICByZXR1cm4gY2FjaGVkRm9udE9iamVjdHNGcm9tU3RyaW5nW2ZvbnRdO1xufVxuXG5mdW5jdGlvbiBleHRyYWN0Rm9udChwcm9wcykge1xuICAgIGxldCBmb250ID0gcHJvcHMuZm9udDtcbiAgICBsZXQgZm9udFNpemUgPSArcHJvcHMuZm9udFNpemU7XG5cbiAgICBsZXQgb3duZWRGb250ID0ge1xuICAgICAgICBmb250RmFtaWx5OiBleHRyYWN0U2luZ2xlRm9udEZhbWlseShwcm9wcy5mb250RmFtaWx5KSxcbiAgICAgICAgZm9udFNpemU6IGlzTmFOKGZvbnRTaXplKSA/IG51bGwgOiBmb250U2l6ZSxcbiAgICAgICAgZm9udFdlaWdodDogcHJvcHMuZm9udFdlaWdodCxcbiAgICAgICAgZm9udFN0eWxlOiBwcm9wcy5mb250U3R5bGVcbiAgICB9O1xuXG4gICAgaWYgKHR5cGVvZiBwcm9wcy5mb250ID09PSAnc3RyaW5nJykge1xuICAgICAgICBmb250ID0gcGFyc2VGb250U3RyaW5nKHByb3BzLmZvbnQpO1xuICAgIH1cbiAgICBvd25lZEZvbnQgPSBfLnBpY2tCeShvd25lZEZvbnQsIHByb3AgPT4gIV8uaXNOaWwocHJvcCkpO1xuXG4gICAgcmV0dXJuIF8uZGVmYXVsdHMob3duZWRGb250LCBmb250KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VEZWx0YShkZWx0YSkge1xuICAgIGlmICh0eXBlb2YgZGVsdGEgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGlmIChpc05hTigrZGVsdGEpKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVsdGEudHJpbSgpLnJlcGxhY2UoY29tbWFSZWcsICcgJykuc3BsaXQoc3BhY2VSZWcpLm1hcChkID0+ICtkIHx8IDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFsrZGVsdGFdO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZGVsdGEgPT09ICdudW1iZXInKSB7XG4gICAgICAgIHJldHVybiBbZGVsdGFdO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHByb3BzLCBjb250YWluZXIpIHtcbiAgICBjb25zdCB7XG4gICAgICAgIHgsXG4gICAgICAgIHksXG4gICAgICAgIGR4LFxuICAgICAgICBkeSxcbiAgICAgICAgdGV4dEFuY2hvcixcbiAgICAgICAgc3RhcnRPZmZzZXRcbiAgICB9ID0gcHJvcHM7XG5cblxuICAgIGNvbnN0IGRlbHRhWCA9IHBhcnNlRGVsdGEoZHgpO1xuICAgIGNvbnN0IGRlbHRhWSA9IHBhcnNlRGVsdGEoZHkpO1xuICAgIGxldCB7IGNoaWxkcmVuIH0gPSBwcm9wcztcbiAgICBsZXQgY29udGVudCA9IG51bGw7XG5cblxuICAgIGlmICh0eXBlb2YgY2hpbGRyZW4gPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBjaGlsZHJlbiA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgY29uc3QgY2hpbGRyZW5TdHJpbmcgPSBjaGlsZHJlbi50b1N0cmluZygpO1xuICAgICAgICBpZiAoY29udGFpbmVyKSB7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IDxUU3Bhbj57Y2hpbGRyZW5TdHJpbmd9PC9UU3Bhbj47XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb250ZW50ID0gY2hpbGRyZW5TdHJpbmc7XG4gICAgICAgICAgICBjaGlsZHJlbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKENoaWxkcmVuLmNvdW50KGNoaWxkcmVuKSA+IDEgfHwgQXJyYXkuaXNBcnJheShjaGlsZHJlbikpIHtcbiAgICAgICAgY2hpbGRyZW4gPSBDaGlsZHJlbi5tYXAoY2hpbGRyZW4sIGNoaWxkID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgY2hpbGQgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBjaGlsZCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gPFRTcGFuPntjaGlsZC50b1N0cmluZygpfTwvVFNwYW4+O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIHRleHRBbmNob3I6IGFuY2hvcnNbdGV4dEFuY2hvcl0gfHwgMCxcbiAgICAgICAgZm9udDogZXh0cmFjdEZvbnQocHJvcHMpLFxuICAgICAgICBjaGlsZHJlbixcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgZGVsdGFYLFxuICAgICAgICBkZWx0YVksXG4gICAgICAgIHN0YXJ0T2Zmc2V0OiAoc3RhcnRPZmZzZXQgfHwgMCkudG9TdHJpbmcoKSxcbiAgICAgICAgcG9zaXRpb25YOiBfLmlzTmlsKHgpID8gbnVsbCA6IHgudG9TdHJpbmcoKSxcbiAgICAgICAgcG9zaXRpb25ZOiBfLmlzTmlsKHkpID8gbnVsbCA6IHkudG9TdHJpbmcoKVxuICAgIH07XG59XG4iXX0=