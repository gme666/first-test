fdc598c357746b50725a843aea1df667
Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};exports.





























































































































































































































































































findElement=findElement;exports.












getCurrent=getCurrent;var _reactNative=require('react-native');var _lodash=require('lodash.isequal');var _lodash2=_interopRequireDefault(_lodash);var _ActionConst=require('./ActionConst');var ActionConst=_interopRequireWildcard(_ActionConst);var _Actions=require('./Actions');var _Util=require('./Util');var _State=require('./State');function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj;}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key))newObj[key]=obj[key];}}newObj.default=obj;return newObj;}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function checkPropertiesEqual(action,lastAction){for(var _iterator=Object.keys(action),_isArray=Array.isArray(_iterator),_i=0,_iterator=_isArray?_iterator:_iterator[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var _ref;if(_isArray){if(_i>=_iterator.length)break;_ref=_iterator[_i++];}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value;}var key=_ref;if(['key','type','parent'].indexOf(key)===-1){if(!(0,_lodash2.default)(action[key],lastAction[key])&&typeof action[key]!=='function'&&typeof lastAction[key]!=='function'){return false;}}}return true;}function resetHistoryStack(state){var newState=state;if(newState.children){newState.index=0;var i=void 0;for(i=0;i<newState.children.length;i+=1){var el=newState.children[i];if(el.initial){newState.index=i;if(!newState.tabs){newState.children=[resetHistoryStack(el)];}else{newState.children[i]=resetHistoryStack(el);}}else{newState.children[i]=resetHistoryStack(el);}}}return newState;}function refreshTopChild(children,refresh){if(refresh){var topChild=children[children.length-1];return[].concat(_toConsumableArray(children.slice(0,-1)),[_extends({},topChild,refresh)]);}return children;}function inject(state,action,props,scenes){var condition=_Actions.ActionMap[action.type]===ActionConst.REFRESH?state.key===props.key||state.sceneKey===action.key:state.sceneKey===props.parent;if(!condition){if(state.children){var res=state.children.map(function(el){return inject(el,action,props,scenes);});var changed=false;var changedIndex=-1;for(var i=0;i<res.length;i+=1){if(res[i]!==state.children[i]){changed=true;changedIndex=i;break;}}return changed?_extends({},state,{children:res,index:changedIndex}):state;}return state;}var ind=void 0;switch(_Actions.ActionMap[action.type]){case ActionConst.POP_TO:{var targetIndex=action.targetIndex;return _extends({},state,{index:targetIndex,children:refreshTopChild(state.children.slice(0,targetIndex+1),action.refresh)});}case ActionConst.BACK:case ActionConst.BACK_ACTION:{(0,_Util.assert)(!state.tabs,'pop() operation cannot be run on tab bar (tabs=true)');if(state.index===0){return state;}var popNum=1;if(action.popNum){(0,_Util.assert)(typeof action.popNum==='number','The data is the number of scenes you want to pop, it must be Number');popNum=action.popNum;(0,_Util.assert)(popNum%1===0,'The data is the number of scenes you want to pop, it must be integer.');(0,_Util.assert)(popNum>1,'The data is the number of scenes you want to pop, it must be bigger than 1.');(0,_Util.assert)(popNum<=state.index,'The data is the number of scenes you want to pop, '+"it must be smaller than scenes stack's length.");}return _extends({},state,{index:state.index-popNum,from:state.children[state.children.length-popNum],children:refreshTopChild(state.children.slice(0,-1*popNum),action.refresh)});}case ActionConst.ANDROID_BACK:{if(_reactNative.Platform.OS==='android'){(0,_Util.assert)(state.index>0,'You are already in the root scene.');}return _extends({},state,{index:state.index-1,from:state.children[state.children.length-1],children:refreshTopChild(state.children.slice(0,-1),action.refresh)});}case ActionConst.POP_AND_REPLACE:{(0,_Util.assert)(!state.tabs,'pop() operation cannot be run on tab bar (tabs=true)');(0,_Util.assert)(state.index>0,'You are already in the root scene.');var _popNum=1;if(action.popNum){(0,_Util.assert)(typeof action.popNum==='number','The data is the number of scenes you want to pop, it must be Number');_popNum=action.popNum;(0,_Util.assert)(_popNum%1===0,'The data is the number of scenes you want to pop, it must be integer.');(0,_Util.assert)(_popNum>1,'The data is the number of scenes you want to pop, it must be bigger than 1.');(0,_Util.assert)(_popNum<=state.index,'The data is the number of scenes you want to pop, '+"it must be smaller than scenes stack's length.");}state=_extends({},state,{index:state.index-_popNum,from:state.children[state.children.length-_popNum],children:state.children.slice(0,-1*_popNum)});if(state.children[state.index].sceneKey===action.key){return state;}var newAction=_extends({duration:0},action);delete newAction.popNum;var newProps=_extends({},props);delete newProps.popNum;state.children[state.children.length-1]=(0,_State.getInitialState)(newProps,scenes,state.index,newAction);return _extends({},state,{children:state.children});}case ActionConst.REFRESH:return props.base?_extends({navBar:state.navBar},scenes.rootProps,props,{key:state.key,from:null}):_extends({},state,props,{key:state.key,from:null});case ActionConst.PUSH_OR_POP:ind=state.children.findIndex(function(el){return el.sceneKey===action.key;});if(ind!==-1){return _extends({},state,{index:ind,from:state.children[state.index],children:refreshTopChild(state.children.slice(0,ind+1),action.refresh)});}return _extends({},state,{index:state.index+1,from:null,children:[].concat(_toConsumableArray(state.children),[(0,_State.getInitialState)(props,scenes,state.index+1,action)])});case ActionConst.PUSH:if(state.children[state.index].sceneKey===action.key&&!props.clone&&checkPropertiesEqual(action,state.children[state.index])){return state;}return _extends({},state,{index:state.index+1,from:null,children:[].concat(_toConsumableArray(state.children),[(0,_State.getInitialState)(props,scenes,state.index+1,action)])});case ActionConst.JUMP:{(0,_Util.assert)(state.tabs,'Parent='+state.key+' is not tab bar, jump action is not valid');ind=-1;state.children.forEach(function(c,i){if(c.sceneKey===action.key){ind=i;}});(0,_Util.assert)(ind!==-1,'Cannot find route with key='+action.key+' for parent='+state.key);var activeChild=state.children[state.index];var incomingChild=state.children[ind];var incomingChildHadTabs=incomingChild.tabs;var incomingChildWasActive=incomingChild.children.length>1;var activeChildIsIncomingChild=activeChild.sceneKey===action.key;if(incomingChildHadTabs||!incomingChildWasActive||activeChildIsIncomingChild){state.children[ind]=(0,_State.getInitialState)(_extends({},props),scenes,state.index,_extends({},action,{parentIndex:state.children[ind].parentIndex}));}if(action.unmountScenes){var rState=resetHistoryStack(state);return _extends({},rState,{index:ind});}return _extends({},state,{index:ind});}case ActionConst.REPLACE:if(state.children[state.index].sceneKey===action.key){return state;}state.children[state.children.length-1]=(0,_State.getInitialState)(props,scenes,state.index,action);return _extends({},state,{children:state.children});case ActionConst.RESET:if(state.children[state.index].sceneKey===action.key){return state;}state.children=state.children.splice(0,1);state.children[0]=(0,_State.getInitialState)(props,scenes,0,action);return _extends({},state,{index:0,from:null,children:state.children});default:return state;}}function findElement(state,key,type){if(_Actions.ActionMap[type]===ActionConst.REFRESH&&state.key===key||state.sceneKey===key){return state;}if(state.children){for(var _iterator2=state.children,_isArray2=Array.isArray(_iterator2),_i2=0,_iterator2=_isArray2?_iterator2:_iterator2[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var _ref2;if(_isArray2){if(_i2>=_iterator2.length)break;_ref2=_iterator2[_i2++];}else{_i2=_iterator2.next();if(_i2.done)break;_ref2=_i2.value;}var child=_ref2;var current=findElement(child,key,type);if(current)return current;}}return null;}function getCurrent(state){
if(!state.children){
return state;
}
return getCurrent(state.children[state.index]);
}

function update(state,action){

var props=_extends({},state.scenes[action.key],action);
(0,_Util.assert)(props.parent,'No parent is defined for route='+action.key);
return inject(state,action,props,state.scenes);
}

function reducer(_ref3){var initialState=_ref3.initialState,scenes=_ref3.scenes;
(0,_Util.assert)(initialState,'initialState should not be null');
(0,_Util.assert)(initialState.key,'initialState.key should not be null');
(0,_Util.assert)(scenes,'scenes should not be null');
return function(stateParam,actionParam){
var state=stateParam;
var action=actionParam;
state=state||_extends({},initialState,{scenes:scenes});
(0,_Util.assert)(action,'action should be defined');
(0,_Util.assert)(action.type,'action type should be defined');
(0,_Util.assert)(state.scenes,'state.scenes is missed');

if(action.key){
if(_Actions.ActionMap[action.type]===ActionConst.REFRESH){
var key=action.key;
var child=findElement(state,key,action.type)||state.scenes[key];
var sceneKey=child.sceneKey;
if(child.base){
child=_extends({},state.scenes[child.base],child);
(0,_Util.assert)(state.scenes[child.base],'No scene exists for base='+child.base);
key=state.scenes[child.base].key;
sceneKey=state.scenes[child.base].sceneKey;
}
(0,_Util.assert)(child,'missed child data for key='+key);

var evaluated={};
Object.keys(action).forEach(function(el){
if(typeof action[el]==='function'&&typeof child[el]!=='undefined'&&
typeof child[el]!==typeof action[el]){
evaluated[el]=action[el](child[el],child);
}
});
action=_extends({},child,action,evaluated,{sceneKey:sceneKey,key:key});


}else{
var scene=state.scenes[action.key];
(0,_Util.assert)(scene,'missed route data for key='+action.key);

if(scene.clone){
action.parent=getCurrent(state).parent;
}
}
}else{

if(_Actions.ActionMap[action.type]===ActionConst.BACK_ACTION||
_Actions.ActionMap[action.type]===ActionConst.BACK||
_Actions.ActionMap[action.type]===ActionConst.ANDROID_BACK||
_Actions.ActionMap[action.type]===ActionConst.POP_AND_REPLACE||
_Actions.ActionMap[action.type]===ActionConst.REFRESH||
_Actions.ActionMap[action.type]===ActionConst.POP_TO){
if(!action.key&&!action.parent){
action=_extends({},getCurrent(state),action);
}
}


if(_Actions.ActionMap[action.type]===ActionConst.POP_TO){





var target=action.data||action.scene;
(0,_Util.assert)(target,'PopTo() must be called with a single argument: '+
'either the scene name (string) or an object with within the scene property '+
'carrying the target scene to pop to');

var targetEl=findElement(state,target,action.type);
(0,_Util.assert)(targetEl,'Cannot find element name named '+target+' within current state');


var parent=targetEl.sceneKey;
var targetIndex=0;


if(!targetEl.children){
var targetParent=findElement(state,targetEl.parent,action.type);
(0,_Util.assert)(targetParent,'Cannot find parent for target '+target);
parent=targetParent.sceneKey;

targetIndex=targetParent.children.indexOf(targetEl);
(0,_Util.assert)(targetIndex>-1,target+' does not belong to '+targetParent.sceneKey);
}

action.parent=parent;
action.targetIndex=targetIndex;
}


if(_Actions.ActionMap[action.type]===ActionConst.BACK_ACTION||
_Actions.ActionMap[action.type]===ActionConst.BACK||
_Actions.ActionMap[action.type]===ActionConst.ANDROID_BACK||
_Actions.ActionMap[action.type]===ActionConst.POP_AND_REPLACE){
var _parent=action.parent||state.scenes[action.key].parent;
var el=findElement(state,_parent,action.type);
while(el.parent&&(el.children.length<=1||el.tabs)){
el=findElement(state,el.parent,action.type);
(0,_Util.assert)(el,'Cannot find element for parent='+el.parent+' within current state');
}
action.parent=el.sceneKey;
}
}

switch(_Actions.ActionMap[action.type]){
case ActionConst.BACK:
case ActionConst.BACK_ACTION:
case ActionConst.POP_AND_REPLACE:
case ActionConst.POP_TO:
case ActionConst.REFRESH:
case ActionConst.PUSH:
case ActionConst.PUSH_OR_POP:
case ActionConst.JUMP:
case ActionConst.REPLACE:
case ActionConst.RESET:
case ActionConst.ANDROID_BACK:
return update(state,action);

default:
return state;}


};
}exports.default=

reducer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlZHVjZXIuanMiXSwibmFtZXMiOlsiZmluZEVsZW1lbnQiLCJnZXRDdXJyZW50IiwiQWN0aW9uQ29uc3QiLCJjaGVja1Byb3BlcnRpZXNFcXVhbCIsImFjdGlvbiIsImxhc3RBY3Rpb24iLCJPYmplY3QiLCJrZXlzIiwia2V5IiwiaW5kZXhPZiIsInJlc2V0SGlzdG9yeVN0YWNrIiwic3RhdGUiLCJuZXdTdGF0ZSIsImNoaWxkcmVuIiwiaW5kZXgiLCJpIiwibGVuZ3RoIiwiZWwiLCJpbml0aWFsIiwidGFicyIsInJlZnJlc2hUb3BDaGlsZCIsInJlZnJlc2giLCJ0b3BDaGlsZCIsInNsaWNlIiwiaW5qZWN0IiwicHJvcHMiLCJzY2VuZXMiLCJjb25kaXRpb24iLCJ0eXBlIiwiUkVGUkVTSCIsInNjZW5lS2V5IiwicGFyZW50IiwicmVzIiwibWFwIiwiY2hhbmdlZCIsImNoYW5nZWRJbmRleCIsImluZCIsIlBPUF9UTyIsInRhcmdldEluZGV4IiwiQkFDSyIsIkJBQ0tfQUNUSU9OIiwicG9wTnVtIiwiZnJvbSIsIkFORFJPSURfQkFDSyIsIk9TIiwiUE9QX0FORF9SRVBMQUNFIiwibmV3QWN0aW9uIiwiZHVyYXRpb24iLCJuZXdQcm9wcyIsImJhc2UiLCJuYXZCYXIiLCJyb290UHJvcHMiLCJQVVNIX09SX1BPUCIsImZpbmRJbmRleCIsIlBVU0giLCJjbG9uZSIsIkpVTVAiLCJmb3JFYWNoIiwiYyIsImFjdGl2ZUNoaWxkIiwiaW5jb21pbmdDaGlsZCIsImluY29taW5nQ2hpbGRIYWRUYWJzIiwiaW5jb21pbmdDaGlsZFdhc0FjdGl2ZSIsImFjdGl2ZUNoaWxkSXNJbmNvbWluZ0NoaWxkIiwicGFyZW50SW5kZXgiLCJ1bm1vdW50U2NlbmVzIiwiclN0YXRlIiwiUkVQTEFDRSIsIlJFU0VUIiwic3BsaWNlIiwiY2hpbGQiLCJjdXJyZW50IiwidXBkYXRlIiwicmVkdWNlciIsImluaXRpYWxTdGF0ZSIsInN0YXRlUGFyYW0iLCJhY3Rpb25QYXJhbSIsImV2YWx1YXRlZCIsInNjZW5lIiwidGFyZ2V0IiwiZGF0YSIsInRhcmdldEVsIiwidGFyZ2V0UGFyZW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBOFJnQkEsVyxDQUFBQSxXOzs7Ozs7Ozs7Ozs7O0FBYUFDLFUsQ0FBQUEsVSxDQWhTaEIseUNBQ0Esc0MsNkNBQ0EsMEMsR0FBWUMsWSx1Q0FDWixrQ0FDQSw0QkFDQSw4QixxZUFFQSxRQUFTQyxxQkFBVCxDQUE4QkMsTUFBOUIsQ0FBc0NDLFVBQXRDLENBQWtELENBQ2hELGtCQUFrQkMsT0FBT0MsSUFBUCxDQUFZSCxNQUFaLENBQWxCLDRJQUF1Qyx1SUFBNUJJLElBQTRCLE1BQ3JDLEdBQUksQ0FBQyxLQUFELENBQVEsTUFBUixDQUFnQixRQUFoQixFQUEwQkMsT0FBMUIsQ0FBa0NELEdBQWxDLElBQTJDLENBQUMsQ0FBaEQsQ0FBbUQsQ0FDakQsR0FBSSxDQUFDLHFCQUFRSixPQUFPSSxHQUFQLENBQVIsQ0FBcUJILFdBQVdHLEdBQVgsQ0FBckIsQ0FBRCxFQUEyQyxNQUFPSixRQUFPSSxHQUFQLENBQVAsR0FBdUIsVUFBbEUsRUFBa0YsTUFBT0gsWUFBV0csR0FBWCxDQUFQLEdBQTJCLFVBQWpILENBQThILENBQzVILE1BQU8sTUFBUCxDQUNELENBQ0YsQ0FDRixDQUNELE1BQU8sS0FBUCxDQUNELENBRUQsUUFBU0Usa0JBQVQsQ0FBMkJDLEtBQTNCLENB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ckMsYUFBWXNDLFdBQWpCO0FBQ0EsSUFBS3RDLGFBQVkyQyxlQUFqQjtBQUNBLElBQUszQyxhQUFZbUMsTUFBakI7QUFDQSxJQUFLbkMsYUFBWTJCLE9BQWpCO0FBQ0EsSUFBSzNCLGFBQVlvRCxJQUFqQjtBQUNBLElBQUtwRCxhQUFZa0QsV0FBakI7QUFDQSxJQUFLbEQsYUFBWXNELElBQWpCO0FBQ0EsSUFBS3RELGFBQVlpRSxPQUFqQjtBQUNBLElBQUtqRSxhQUFZa0UsS0FBakI7QUFDQSxJQUFLbEUsYUFBWXlDLFlBQWpCO0FBQ0UsTUFBTzZCLFFBQU83RCxLQUFQLENBQWNQLE1BQWQsQ0FBUDs7QUFFRjtBQUNFLE1BQU9PLE1BQVAsQ0FmSjs7O0FBa0JELENBdEhEO0FBdUhELEM7O0FBRWM4RCxPIiwiZmlsZSI6IlJlZHVjZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBQYXZlbCBBa3Nvbm92XG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqL1xuXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqL1xuXG5pbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgaXNFcXVhbCBmcm9tICdsb2Rhc2guaXNlcXVhbCc7XG5pbXBvcnQgKiBhcyBBY3Rpb25Db25zdCBmcm9tICcuL0FjdGlvbkNvbnN0JztcbmltcG9ydCB7IEFjdGlvbk1hcCB9IGZyb20gJy4vQWN0aW9ucyc7XG5pbXBvcnQgeyBhc3NlcnQgfSBmcm9tICcuL1V0aWwnO1xuaW1wb3J0IHsgZ2V0SW5pdGlhbFN0YXRlIH0gZnJvbSAnLi9TdGF0ZSc7XG5cbmZ1bmN0aW9uIGNoZWNrUHJvcGVydGllc0VxdWFsKGFjdGlvbiwgbGFzdEFjdGlvbikge1xuICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhhY3Rpb24pKSB7XG4gICAgaWYgKFsna2V5JywgJ3R5cGUnLCAncGFyZW50J10uaW5kZXhPZihrZXkpID09PSAtMSkge1xuICAgICAgaWYgKCFpc0VxdWFsKGFjdGlvbltrZXldLCBsYXN0QWN0aW9uW2tleV0pICYmICh0eXBlb2YgYWN0aW9uW2tleV0gIT09ICdmdW5jdGlvbicpICYmICh0eXBlb2YgbGFzdEFjdGlvbltrZXldICE9PSAnZnVuY3Rpb24nKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiByZXNldEhpc3RvcnlTdGFjayhzdGF0ZSkge1xuICBjb25zdCBuZXdTdGF0ZSA9IHN0YXRlO1xuXG4gIGlmIChuZXdTdGF0ZS5jaGlsZHJlbikge1xuICAgIG5ld1N0YXRlLmluZGV4ID0gMDtcblxuICAgIGxldCBpO1xuICAgIGZvciAoaSA9IDA7IGkgPCBuZXdTdGF0ZS5jaGlsZHJlbi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgY29uc3QgZWwgPSBuZXdTdGF0ZS5jaGlsZHJlbltpXTtcblxuICAgICAgaWYgKGVsLmluaXRpYWwpIHtcbiAgICAgICAgbmV3U3RhdGUuaW5kZXggPSBpO1xuXG4gICAgICAgIGlmICghbmV3U3RhdGUudGFicykge1xuICAgICAgICAgIG5ld1N0YXRlLmNoaWxkcmVuID0gW3Jlc2V0SGlzdG9yeVN0YWNrKGVsKV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV3U3RhdGUuY2hpbGRyZW5baV0gPSByZXNldEhpc3RvcnlTdGFjayhlbCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld1N0YXRlLmNoaWxkcmVuW2ldID0gcmVzZXRIaXN0b3J5U3RhY2soZWwpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gbmV3U3RhdGU7XG59XG5cbmZ1bmN0aW9uIHJlZnJlc2hUb3BDaGlsZChjaGlsZHJlbiwgcmVmcmVzaCkge1xuICBpZiAocmVmcmVzaCkge1xuICAgIGNvbnN0IHRvcENoaWxkID0gY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0gMV07XG4gICAgcmV0dXJuIFsuLi5jaGlsZHJlbi5zbGljZSgwLCAtMSksIHsgLi4udG9wQ2hpbGQsIC4uLnJlZnJlc2ggfV07XG4gIH1cbiAgcmV0dXJuIGNoaWxkcmVuO1xufVxuXG5mdW5jdGlvbiBpbmplY3Qoc3RhdGUsIGFjdGlvbiwgcHJvcHMsIHNjZW5lcykge1xuICBjb25zdCBjb25kaXRpb24gPSBBY3Rpb25NYXBbYWN0aW9uLnR5cGVdID09PSBBY3Rpb25Db25zdC5SRUZSRVNIID8gc3RhdGUua2V5ID09PSBwcm9wcy5rZXkgfHxcbiAgICBzdGF0ZS5zY2VuZUtleSA9PT0gYWN0aW9uLmtleSA6IHN0YXRlLnNjZW5lS2V5ID09PSBwcm9wcy5wYXJlbnQ7XG4gIC8vIGNvbnNvbGUubG9nKFwiSU5KRUNUOlwiLCBhY3Rpb24ua2V5LCBzdGF0ZS5zY2VuZUtleSwgY29uZGl0aW9uKTtcbiAgaWYgKCFjb25kaXRpb24pIHtcbiAgICBpZiAoc3RhdGUuY2hpbGRyZW4pIHtcbiAgICAgIGNvbnN0IHJlcyA9IHN0YXRlLmNoaWxkcmVuLm1hcChlbCA9PiBpbmplY3QoZWwsIGFjdGlvbiwgcHJvcHMsIHNjZW5lcykpO1xuICAgICAgbGV0IGNoYW5nZWQgPSBmYWxzZTtcbiAgICAgIGxldCBjaGFuZ2VkSW5kZXggPSAtMTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChyZXNbaV0gIT09IHN0YXRlLmNoaWxkcmVuW2ldKSB7XG4gICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgY2hhbmdlZEluZGV4ID0gaTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNoYW5nZWQgPyB7IC4uLnN0YXRlLCBjaGlsZHJlbjogcmVzLCBpbmRleDogY2hhbmdlZEluZGV4IH0gOiBzdGF0ZTtcbiAgICB9XG4gICAgcmV0dXJuIHN0YXRlO1xuICB9XG4gIGxldCBpbmQ7XG5cbiAgc3dpdGNoIChBY3Rpb25NYXBbYWN0aW9uLnR5cGVdKSB7XG4gICAgY2FzZSBBY3Rpb25Db25zdC5QT1BfVE86IHtcbiAgICAgIGNvbnN0IHRhcmdldEluZGV4ID0gYWN0aW9uLnRhcmdldEluZGV4O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgaW5kZXg6IHRhcmdldEluZGV4LFxuICAgICAgICBjaGlsZHJlbjogcmVmcmVzaFRvcENoaWxkKHN0YXRlLmNoaWxkcmVuLnNsaWNlKDAsICh0YXJnZXRJbmRleCArIDEpKSwgYWN0aW9uLnJlZnJlc2gpLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBjYXNlIEFjdGlvbkNvbnN0LkJBQ0s6XG4gICAgY2FzZSBBY3Rpb25Db25zdC5CQUNLX0FDVElPTjoge1xuICAgICAgYXNzZXJ0KCFzdGF0ZS50YWJzLCAncG9wKCkgb3BlcmF0aW9uIGNhbm5vdCBiZSBydW4gb24gdGFiIGJhciAodGFicz10cnVlKScpO1xuXG4gICAgICBpZiAoc3RhdGUuaW5kZXggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuXG4gICAgICBsZXQgcG9wTnVtID0gMTtcbiAgICAgIGlmIChhY3Rpb24ucG9wTnVtKSB7XG4gICAgICAgIGFzc2VydCh0eXBlb2YgKGFjdGlvbi5wb3BOdW0pID09PSAnbnVtYmVyJyxcbiAgICAgICAgICAnVGhlIGRhdGEgaXMgdGhlIG51bWJlciBvZiBzY2VuZXMgeW91IHdhbnQgdG8gcG9wLCBpdCBtdXN0IGJlIE51bWJlcicpO1xuICAgICAgICBwb3BOdW0gPSBhY3Rpb24ucG9wTnVtO1xuICAgICAgICBhc3NlcnQocG9wTnVtICUgMSA9PT0gMCxcbiAgICAgICAgICAnVGhlIGRhdGEgaXMgdGhlIG51bWJlciBvZiBzY2VuZXMgeW91IHdhbnQgdG8gcG9wLCBpdCBtdXN0IGJlIGludGVnZXIuJyk7XG4gICAgICAgIGFzc2VydChwb3BOdW0gPiAxLFxuICAgICAgICAgICdUaGUgZGF0YSBpcyB0aGUgbnVtYmVyIG9mIHNjZW5lcyB5b3Ugd2FudCB0byBwb3AsIGl0IG11c3QgYmUgYmlnZ2VyIHRoYW4gMS4nKTtcbiAgICAgICAgYXNzZXJ0KHBvcE51bSA8PSBzdGF0ZS5pbmRleCxcbiAgICAgICAgICAnVGhlIGRhdGEgaXMgdGhlIG51bWJlciBvZiBzY2VuZXMgeW91IHdhbnQgdG8gcG9wLCAnICtcbiAgICAgICAgICBcIml0IG11c3QgYmUgc21hbGxlciB0aGFuIHNjZW5lcyBzdGFjaydzIGxlbmd0aC5cIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLnN0YXRlLFxuICAgICAgICBpbmRleDogc3RhdGUuaW5kZXggLSBwb3BOdW0sXG4gICAgICAgIGZyb206IHN0YXRlLmNoaWxkcmVuW3N0YXRlLmNoaWxkcmVuLmxlbmd0aCAtIHBvcE51bV0sXG4gICAgICAgIGNoaWxkcmVuOiByZWZyZXNoVG9wQ2hpbGQoc3RhdGUuY2hpbGRyZW4uc2xpY2UoMCwgLTEgKiBwb3BOdW0pLCBhY3Rpb24ucmVmcmVzaCksXG4gICAgICB9O1xuICAgIH1cbiAgICBjYXNlIEFjdGlvbkNvbnN0LkFORFJPSURfQkFDSzoge1xuICAgICAgaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcpIHtcbiAgICAgICAgYXNzZXJ0KHN0YXRlLmluZGV4ID4gMCwgJ1lvdSBhcmUgYWxyZWFkeSBpbiB0aGUgcm9vdCBzY2VuZS4nKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGluZGV4OiBzdGF0ZS5pbmRleCAtIDEsXG4gICAgICAgIGZyb206IHN0YXRlLmNoaWxkcmVuW3N0YXRlLmNoaWxkcmVuLmxlbmd0aCAtIDFdLFxuICAgICAgICBjaGlsZHJlbjogcmVmcmVzaFRvcENoaWxkKHN0YXRlLmNoaWxkcmVuLnNsaWNlKDAsIC0xKSwgYWN0aW9uLnJlZnJlc2gpLFxuICAgICAgfTtcbiAgICB9XG4gICAgLy8gVGhpcyBhY3Rpb24gd2lsbCBwb3AgdGhlIHNjZW5lIHN0YWNrIGFuZCB0aGVuIHJlcGxhY2UgY3VycmVudCBzY2VuZSBpbiBvbmUgZ29cbiAgICBjYXNlIEFjdGlvbkNvbnN0LlBPUF9BTkRfUkVQTEFDRToge1xuICAgICAgYXNzZXJ0KCFzdGF0ZS50YWJzLCAncG9wKCkgb3BlcmF0aW9uIGNhbm5vdCBiZSBydW4gb24gdGFiIGJhciAodGFicz10cnVlKScpO1xuICAgICAgYXNzZXJ0KHN0YXRlLmluZGV4ID4gMCwgJ1lvdSBhcmUgYWxyZWFkeSBpbiB0aGUgcm9vdCBzY2VuZS4nKTtcblxuICAgICAgbGV0IHBvcE51bSA9IDE7XG4gICAgICBpZiAoYWN0aW9uLnBvcE51bSkge1xuICAgICAgICBhc3NlcnQodHlwZW9mIChhY3Rpb24ucG9wTnVtKSA9PT0gJ251bWJlcicsXG4gICAgICAgICAgJ1RoZSBkYXRhIGlzIHRoZSBudW1iZXIgb2Ygc2NlbmVzIHlvdSB3YW50IHRvIHBvcCwgaXQgbXVzdCBiZSBOdW1iZXInKTtcbiAgICAgICAgcG9wTnVtID0gYWN0aW9uLnBvcE51bTtcbiAgICAgICAgYXNzZXJ0KHBvcE51bSAlIDEgPT09IDAsXG4gICAgICAgICAgJ1RoZSBkYXRhIGlzIHRoZSBudW1iZXIgb2Ygc2NlbmVzIHlvdSB3YW50IHRvIHBvcCwgaXQgbXVzdCBiZSBpbnRlZ2VyLicpO1xuICAgICAgICBhc3NlcnQocG9wTnVtID4gMSxcbiAgICAgICAgICAnVGhlIGRhdGEgaXMgdGhlIG51bWJlciBvZiBzY2VuZXMgeW91IHdhbnQgdG8gcG9wLCBpdCBtdXN0IGJlIGJpZ2dlciB0aGFuIDEuJyk7XG4gICAgICAgIGFzc2VydChwb3BOdW0gPD0gc3RhdGUuaW5kZXgsXG4gICAgICAgICAgJ1RoZSBkYXRhIGlzIHRoZSBudW1iZXIgb2Ygc2NlbmVzIHlvdSB3YW50IHRvIHBvcCwgJyArXG4gICAgICAgICAgXCJpdCBtdXN0IGJlIHNtYWxsZXIgdGhhbiBzY2VuZXMgc3RhY2sncyBsZW5ndGguXCIpO1xuICAgICAgfVxuXG4gICAgICBzdGF0ZSA9IHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGluZGV4OiBzdGF0ZS5pbmRleCAtIHBvcE51bSxcbiAgICAgICAgZnJvbTogc3RhdGUuY2hpbGRyZW5bc3RhdGUuY2hpbGRyZW4ubGVuZ3RoIC0gcG9wTnVtXSxcbiAgICAgICAgY2hpbGRyZW46IHN0YXRlLmNoaWxkcmVuLnNsaWNlKDAsIC0xICogcG9wTnVtKSxcbiAgICAgIH07XG5cbiAgICAgIGlmIChzdGF0ZS5jaGlsZHJlbltzdGF0ZS5pbmRleF0uc2NlbmVLZXkgPT09IGFjdGlvbi5rZXkpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBuZXdBY3Rpb24gPSB7XG4gICAgICAgIGR1cmF0aW9uOiAwLCAgLy8gZG8gbm90IGFuaW1hdGVcbiAgICAgICAgLi4uYWN0aW9uLFxuICAgICAgfTtcbiAgICAgIGRlbGV0ZSBuZXdBY3Rpb24ucG9wTnVtO1xuXG4gICAgICBjb25zdCBuZXdQcm9wcyA9IHsgLi4ucHJvcHMgfTtcbiAgICAgIGRlbGV0ZSBuZXdQcm9wcy5wb3BOdW07XG5cbiAgICAgIHN0YXRlLmNoaWxkcmVuW3N0YXRlLmNoaWxkcmVuLmxlbmd0aCAtIDFdID0gZ2V0SW5pdGlhbFN0YXRlKFxuICAgICAgICBuZXdQcm9wcyxcbiAgICAgICAgc2NlbmVzLFxuICAgICAgICBzdGF0ZS5pbmRleCxcbiAgICAgICAgbmV3QWN0aW9uLFxuICAgICAgKTtcblxuICAgICAgcmV0dXJuIHsgLi4uc3RhdGUsIGNoaWxkcmVuOiBzdGF0ZS5jaGlsZHJlbiB9O1xuICAgIH1cbiAgICBjYXNlIEFjdGlvbkNvbnN0LlJFRlJFU0g6XG4gICAgICByZXR1cm4gcHJvcHMuYmFzZSA/IHtcbiAgICAgICAgbmF2QmFyOiBzdGF0ZS5uYXZCYXIsXG4gICAgICAgIC4uLnNjZW5lcy5yb290UHJvcHMsXG4gICAgICAgIC4uLnByb3BzLFxuICAgICAgICBrZXk6IHN0YXRlLmtleSxcbiAgICAgICAgZnJvbTogbnVsbCxcbiAgICAgIH1cbiAgICAgICAgOiB7XG4gICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgLi4ucHJvcHMsXG4gICAgICAgICAga2V5OiBzdGF0ZS5rZXksXG4gICAgICAgICAgZnJvbTogbnVsbCxcbiAgICAgICAgfTtcbiAgICBjYXNlIEFjdGlvbkNvbnN0LlBVU0hfT1JfUE9QOlxuICAgICAgaW5kID0gc3RhdGUuY2hpbGRyZW4uZmluZEluZGV4KGVsID0+IGVsLnNjZW5lS2V5ID09PSBhY3Rpb24ua2V5KTtcbiAgICAgIGlmIChpbmQgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgICAgaW5kZXg6IGluZCxcbiAgICAgICAgICBmcm9tOiBzdGF0ZS5jaGlsZHJlbltzdGF0ZS5pbmRleF0sXG4gICAgICAgICAgY2hpbGRyZW46IHJlZnJlc2hUb3BDaGlsZChzdGF0ZS5jaGlsZHJlbi5zbGljZSgwLCBpbmQgKyAxKSwgYWN0aW9uLnJlZnJlc2gpLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGluZGV4OiBzdGF0ZS5pbmRleCArIDEsXG4gICAgICAgIGZyb206IG51bGwsXG4gICAgICAgIGNoaWxkcmVuOiBbLi4uc3RhdGUuY2hpbGRyZW4sIGdldEluaXRpYWxTdGF0ZShwcm9wcywgc2NlbmVzLCBzdGF0ZS5pbmRleCArIDEsIGFjdGlvbildLFxuICAgICAgfTtcbiAgICBjYXNlIEFjdGlvbkNvbnN0LlBVU0g6XG4gICAgICBpZiAoc3RhdGUuY2hpbGRyZW5bc3RhdGUuaW5kZXhdLnNjZW5lS2V5ID09PSBhY3Rpb24ua2V5ICYmICFwcm9wcy5jbG9uZVxuICAgICAgICAmJiBjaGVja1Byb3BlcnRpZXNFcXVhbChhY3Rpb24sIHN0YXRlLmNoaWxkcmVuW3N0YXRlLmluZGV4XSkpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGluZGV4OiBzdGF0ZS5pbmRleCArIDEsXG4gICAgICAgIGZyb206IG51bGwsXG4gICAgICAgIGNoaWxkcmVuOiBbLi4uc3RhdGUuY2hpbGRyZW4sIGdldEluaXRpYWxTdGF0ZShwcm9wcywgc2NlbmVzLCBzdGF0ZS5pbmRleCArIDEsIGFjdGlvbildLFxuICAgICAgfTtcbiAgICBjYXNlIEFjdGlvbkNvbnN0LkpVTVA6IHtcbiAgICAgIGFzc2VydChzdGF0ZS50YWJzLCBgUGFyZW50PSR7c3RhdGUua2V5fSBpcyBub3QgdGFiIGJhciwganVtcCBhY3Rpb24gaXMgbm90IHZhbGlkYCk7XG4gICAgICBpbmQgPSAtMTtcbiAgICAgIHN0YXRlLmNoaWxkcmVuLmZvckVhY2goKGMsIGkpID0+IHsgaWYgKGMuc2NlbmVLZXkgPT09IGFjdGlvbi5rZXkpIHsgaW5kID0gaTsgfSB9KTtcbiAgICAgIGFzc2VydChpbmQgIT09IC0xLCBgQ2Fubm90IGZpbmQgcm91dGUgd2l0aCBrZXk9JHthY3Rpb24ua2V5fSBmb3IgcGFyZW50PSR7c3RhdGUua2V5fWApO1xuXG4gICAgICBjb25zdCBhY3RpdmVDaGlsZCA9IHN0YXRlLmNoaWxkcmVuW3N0YXRlLmluZGV4XTtcbiAgICAgIGNvbnN0IGluY29taW5nQ2hpbGQgPSBzdGF0ZS5jaGlsZHJlbltpbmRdO1xuXG4gICAgICBjb25zdCBpbmNvbWluZ0NoaWxkSGFkVGFicyA9IGluY29taW5nQ2hpbGQudGFicztcbiAgICAgIGNvbnN0IGluY29taW5nQ2hpbGRXYXNBY3RpdmUgPSBpbmNvbWluZ0NoaWxkLmNoaWxkcmVuLmxlbmd0aCA+IDE7XG4gICAgICBjb25zdCBhY3RpdmVDaGlsZElzSW5jb21pbmdDaGlsZCA9IGFjdGl2ZUNoaWxkLnNjZW5lS2V5ID09PSBhY3Rpb24ua2V5O1xuICAgICAgaWYgKGluY29taW5nQ2hpbGRIYWRUYWJzIHx8ICFpbmNvbWluZ0NoaWxkV2FzQWN0aXZlIHx8IGFjdGl2ZUNoaWxkSXNJbmNvbWluZ0NoaWxkKSB7XG4gICAgICAgIHN0YXRlLmNoaWxkcmVuW2luZF0gPSBnZXRJbml0aWFsU3RhdGUoXG4gICAgICAgICAgeyAuLi5wcm9wcyB9LFxuICAgICAgICAgIHNjZW5lcyxcbiAgICAgICAgICBzdGF0ZS5pbmRleCxcbiAgICAgICAgICB7IC4uLmFjdGlvbiwgcGFyZW50SW5kZXg6IHN0YXRlLmNoaWxkcmVuW2luZF0ucGFyZW50SW5kZXggfSxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGFjdGlvbi51bm1vdW50U2NlbmVzKSB7XG4gICAgICAgIGNvbnN0IHJTdGF0ZSA9IHJlc2V0SGlzdG9yeVN0YWNrKHN0YXRlKTtcbiAgICAgICAgcmV0dXJuIHsgLi4uclN0YXRlLCBpbmRleDogaW5kIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBpbmRleDogaW5kIH07XG4gICAgfVxuICAgIGNhc2UgQWN0aW9uQ29uc3QuUkVQTEFDRTpcbiAgICAgIGlmIChzdGF0ZS5jaGlsZHJlbltzdGF0ZS5pbmRleF0uc2NlbmVLZXkgPT09IGFjdGlvbi5rZXkpIHtcbiAgICAgICAgcmV0dXJuIHN0YXRlO1xuICAgICAgfVxuXG4gICAgICBzdGF0ZS5jaGlsZHJlbltzdGF0ZS5jaGlsZHJlbi5sZW5ndGggLSAxXSA9IGdldEluaXRpYWxTdGF0ZShcbiAgICAgICAgcHJvcHMsXG4gICAgICAgIHNjZW5lcyxcbiAgICAgICAgc3RhdGUuaW5kZXgsXG4gICAgICAgIGFjdGlvbixcbiAgICAgICk7XG5cbiAgICAgIHJldHVybiB7IC4uLnN0YXRlLCBjaGlsZHJlbjogc3RhdGUuY2hpbGRyZW4gfTtcbiAgICBjYXNlIEFjdGlvbkNvbnN0LlJFU0VUOlxuICAgICAgaWYgKHN0YXRlLmNoaWxkcmVuW3N0YXRlLmluZGV4XS5zY2VuZUtleSA9PT0gYWN0aW9uLmtleSkge1xuICAgICAgICByZXR1cm4gc3RhdGU7XG4gICAgICB9XG5cbiAgICAgIHN0YXRlLmNoaWxkcmVuID0gc3RhdGUuY2hpbGRyZW4uc3BsaWNlKDAsIDEpO1xuICAgICAgc3RhdGUuY2hpbGRyZW5bMF0gPSBnZXRJbml0aWFsU3RhdGUocHJvcHMsIHNjZW5lcywgMCwgYWN0aW9uKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uc3RhdGUsXG4gICAgICAgIGluZGV4OiAwLFxuICAgICAgICBmcm9tOiBudWxsLFxuICAgICAgICBjaGlsZHJlbjogc3RhdGUuY2hpbGRyZW4sXG4gICAgICB9O1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gc3RhdGU7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRFbGVtZW50KHN0YXRlLCBrZXksIHR5cGUpIHtcbiAgaWYgKChBY3Rpb25NYXBbdHlwZV0gPT09IEFjdGlvbkNvbnN0LlJFRlJFU0ggJiYgc3RhdGUua2V5ID09PSBrZXkpIHx8IHN0YXRlLnNjZW5lS2V5ID09PSBrZXkpIHtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cbiAgaWYgKHN0YXRlLmNoaWxkcmVuKSB7XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiBzdGF0ZS5jaGlsZHJlbikge1xuICAgICAgY29uc3QgY3VycmVudCA9IGZpbmRFbGVtZW50KGNoaWxkLCBrZXksIHR5cGUpO1xuICAgICAgaWYgKGN1cnJlbnQpIHJldHVybiBjdXJyZW50O1xuICAgIH1cbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnQoc3RhdGUpIHtcbiAgaWYgKCFzdGF0ZS5jaGlsZHJlbikge1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuICByZXR1cm4gZ2V0Q3VycmVudChzdGF0ZS5jaGlsZHJlbltzdGF0ZS5pbmRleF0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGUoc3RhdGUsIGFjdGlvbikge1xuICAvLyBmaW5kIHBhcmVudCBpbiB0aGUgc3RhdGVcbiAgY29uc3QgcHJvcHMgPSB7IC4uLnN0YXRlLnNjZW5lc1thY3Rpb24ua2V5XSwgLi4uYWN0aW9uIH07XG4gIGFzc2VydChwcm9wcy5wYXJlbnQsIGBObyBwYXJlbnQgaXMgZGVmaW5lZCBmb3Igcm91dGU9JHthY3Rpb24ua2V5fWApO1xuICByZXR1cm4gaW5qZWN0KHN0YXRlLCBhY3Rpb24sIHByb3BzLCBzdGF0ZS5zY2VuZXMpO1xufVxuXG5mdW5jdGlvbiByZWR1Y2VyKHsgaW5pdGlhbFN0YXRlLCBzY2VuZXMgfSkge1xuICBhc3NlcnQoaW5pdGlhbFN0YXRlLCAnaW5pdGlhbFN0YXRlIHNob3VsZCBub3QgYmUgbnVsbCcpO1xuICBhc3NlcnQoaW5pdGlhbFN0YXRlLmtleSwgJ2luaXRpYWxTdGF0ZS5rZXkgc2hvdWxkIG5vdCBiZSBudWxsJyk7XG4gIGFzc2VydChzY2VuZXMsICdzY2VuZXMgc2hvdWxkIG5vdCBiZSBudWxsJyk7XG4gIHJldHVybiAoc3RhdGVQYXJhbSwgYWN0aW9uUGFyYW0pID0+IHtcbiAgICBsZXQgc3RhdGUgPSBzdGF0ZVBhcmFtO1xuICAgIGxldCBhY3Rpb24gPSBhY3Rpb25QYXJhbTtcbiAgICBzdGF0ZSA9IHN0YXRlIHx8IHsgLi4uaW5pdGlhbFN0YXRlLCBzY2VuZXMgfTtcbiAgICBhc3NlcnQoYWN0aW9uLCAnYWN0aW9uIHNob3VsZCBiZSBkZWZpbmVkJyk7XG4gICAgYXNzZXJ0KGFjdGlvbi50eXBlLCAnYWN0aW9uIHR5cGUgc2hvdWxkIGJlIGRlZmluZWQnKTtcbiAgICBhc3NlcnQoc3RhdGUuc2NlbmVzLCAnc3RhdGUuc2NlbmVzIGlzIG1pc3NlZCcpO1xuXG4gICAgaWYgKGFjdGlvbi5rZXkpIHtcbiAgICAgIGlmIChBY3Rpb25NYXBbYWN0aW9uLnR5cGVdID09PSBBY3Rpb25Db25zdC5SRUZSRVNIKSB7XG4gICAgICAgIGxldCBrZXkgPSBhY3Rpb24ua2V5O1xuICAgICAgICBsZXQgY2hpbGQgPSBmaW5kRWxlbWVudChzdGF0ZSwga2V5LCBhY3Rpb24udHlwZSkgfHwgc3RhdGUuc2NlbmVzW2tleV07XG4gICAgICAgIGxldCBzY2VuZUtleSA9IGNoaWxkLnNjZW5lS2V5O1xuICAgICAgICBpZiAoY2hpbGQuYmFzZSkge1xuICAgICAgICAgIGNoaWxkID0geyAuLi5zdGF0ZS5zY2VuZXNbY2hpbGQuYmFzZV0sIC4uLmNoaWxkIH07XG4gICAgICAgICAgYXNzZXJ0KHN0YXRlLnNjZW5lc1tjaGlsZC5iYXNlXSwgYE5vIHNjZW5lIGV4aXN0cyBmb3IgYmFzZT0ke2NoaWxkLmJhc2V9YCk7XG4gICAgICAgICAga2V5ID0gc3RhdGUuc2NlbmVzW2NoaWxkLmJhc2VdLmtleTtcbiAgICAgICAgICBzY2VuZUtleSA9IHN0YXRlLnNjZW5lc1tjaGlsZC5iYXNlXS5zY2VuZUtleTtcbiAgICAgICAgfVxuICAgICAgICBhc3NlcnQoY2hpbGQsIGBtaXNzZWQgY2hpbGQgZGF0YSBmb3Iga2V5PSR7a2V5fWApO1xuICAgICAgICAvLyBldmFsdWF0ZSBmdW5jdGlvbnMgd2l0aGluIGFjdGlvbnMgdG8gYWxsb3cgY29uZGl0aW9uYWwgc2V0LCBsaWtlIHN3aXRjaCB2YWx1ZXNcbiAgICAgICAgY29uc3QgZXZhbHVhdGVkID0ge307XG4gICAgICAgIE9iamVjdC5rZXlzKGFjdGlvbikuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgICAgICBpZiAodHlwZW9mIGFjdGlvbltlbF0gPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGNoaWxkW2VsXSAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgICYmIHR5cGVvZiBjaGlsZFtlbF0gIT09IHR5cGVvZiBhY3Rpb25bZWxdKSB7XG4gICAgICAgICAgICBldmFsdWF0ZWRbZWxdID0gYWN0aW9uW2VsXShjaGlsZFtlbF0sIGNoaWxkKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBhY3Rpb24gPSB7IC4uLmNoaWxkLCAuLi5hY3Rpb24sIC4uLmV2YWx1YXRlZCwgc2NlbmVLZXksIGtleSB9O1xuXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiUkVGUkVTSCBBQ1RJT046XCIsIGFjdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzY2VuZSA9IHN0YXRlLnNjZW5lc1thY3Rpb24ua2V5XTtcbiAgICAgICAgYXNzZXJ0KHNjZW5lLCBgbWlzc2VkIHJvdXRlIGRhdGEgZm9yIGtleT0ke2FjdGlvbi5rZXl9YCk7XG4gICAgICAgIC8vIGNsb25lIHNjZW5lXG4gICAgICAgIGlmIChzY2VuZS5jbG9uZSkge1xuICAgICAgICAgIGFjdGlvbi5wYXJlbnQgPSBnZXRDdXJyZW50KHN0YXRlKS5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc2V0IGN1cnJlbnQgcm91dGUgZm9yIHBvcCBhY3Rpb24gb3IgcmVmcmVzaCBhY3Rpb25cbiAgICAgIGlmIChBY3Rpb25NYXBbYWN0aW9uLnR5cGVdID09PSBBY3Rpb25Db25zdC5CQUNLX0FDVElPTiB8fFxuICAgICAgICBBY3Rpb25NYXBbYWN0aW9uLnR5cGVdID09PSBBY3Rpb25Db25zdC5CQUNLIHx8XG4gICAgICAgIEFjdGlvbk1hcFthY3Rpb24udHlwZV0gPT09IEFjdGlvbkNvbnN0LkFORFJPSURfQkFDSyB8fFxuICAgICAgICBBY3Rpb25NYXBbYWN0aW9uLnR5cGVdID09PSBBY3Rpb25Db25zdC5QT1BfQU5EX1JFUExBQ0UgfHxcbiAgICAgICAgQWN0aW9uTWFwW2FjdGlvbi50eXBlXSA9PT0gQWN0aW9uQ29uc3QuUkVGUkVTSCB8fFxuICAgICAgICBBY3Rpb25NYXBbYWN0aW9uLnR5cGVdID09PSBBY3Rpb25Db25zdC5QT1BfVE8pIHtcbiAgICAgICAgaWYgKCFhY3Rpb24ua2V5ICYmICFhY3Rpb24ucGFyZW50KSB7XG4gICAgICAgICAgYWN0aW9uID0geyAuLi5nZXRDdXJyZW50KHN0YXRlKSwgLi4uYWN0aW9uIH07XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gRmluZCB0aGUgcGFyZW50IGFuZCBpbmRleCBvZiB0aGUgZnV0dXJlIHN0YXRlXG4gICAgICBpZiAoQWN0aW9uTWFwW2FjdGlvbi50eXBlXSA9PT0gQWN0aW9uQ29uc3QuUE9QX1RPKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGlmIGEgc3RyaW5nIGlzIHBhc3NlZCBhcyBvbmx5IGFyZ3VtZW50XG4gICAgICAgICAqIEFjdGlvbnMuZmlsdGVyUGFyYW0gd2lsbCBwdXQgaXQgaW4gdGhlIGRhdGEgcHJvcGVydHlcbiAgICAgICAgICogb3RoZXJ3aXNlIGxvb2sgZm9yIHRoZSBzY2VuZSBwcm9wZXJ0eVxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3QgdGFyZ2V0ID0gYWN0aW9uLmRhdGEgfHwgYWN0aW9uLnNjZW5lO1xuICAgICAgICBhc3NlcnQodGFyZ2V0LCAnUG9wVG8oKSBtdXN0IGJlIGNhbGxlZCB3aXRoIGEgc2luZ2xlIGFyZ3VtZW50OiAnICtcbiAgICAgICAgICAnZWl0aGVyIHRoZSBzY2VuZSBuYW1lIChzdHJpbmcpIG9yIGFuIG9iamVjdCB3aXRoIHdpdGhpbiB0aGUgc2NlbmUgcHJvcGVydHkgJyArXG4gICAgICAgICAgJ2NhcnJ5aW5nIHRoZSB0YXJnZXQgc2NlbmUgdG8gcG9wIHRvJyk7XG5cbiAgICAgICAgY29uc3QgdGFyZ2V0RWwgPSBmaW5kRWxlbWVudChzdGF0ZSwgdGFyZ2V0LCBhY3Rpb24udHlwZSk7XG4gICAgICAgIGFzc2VydCh0YXJnZXRFbCwgYENhbm5vdCBmaW5kIGVsZW1lbnQgbmFtZSBuYW1lZCAke3RhcmdldH0gd2l0aGluIGN1cnJlbnQgc3RhdGVgKTtcblxuICAgICAgICAvLyB0YXJnZXQgaXMgYSBub2RlXG4gICAgICAgIGxldCBwYXJlbnQgPSB0YXJnZXRFbC5zY2VuZUtleTtcbiAgICAgICAgbGV0IHRhcmdldEluZGV4ID0gMDtcblxuICAgICAgICAvLyB0YXJnZXQgaXMgY2hpbGQgb2YgYSBub2RlXG4gICAgICAgIGlmICghdGFyZ2V0RWwuY2hpbGRyZW4pIHtcbiAgICAgICAgICBjb25zdCB0YXJnZXRQYXJlbnQgPSBmaW5kRWxlbWVudChzdGF0ZSwgdGFyZ2V0RWwucGFyZW50LCBhY3Rpb24udHlwZSk7XG4gICAgICAgICAgYXNzZXJ0KHRhcmdldFBhcmVudCwgYENhbm5vdCBmaW5kIHBhcmVudCBmb3IgdGFyZ2V0ICR7dGFyZ2V0fWApO1xuICAgICAgICAgIHBhcmVudCA9IHRhcmdldFBhcmVudC5zY2VuZUtleTtcblxuICAgICAgICAgIHRhcmdldEluZGV4ID0gdGFyZ2V0UGFyZW50LmNoaWxkcmVuLmluZGV4T2YodGFyZ2V0RWwpO1xuICAgICAgICAgIGFzc2VydCh0YXJnZXRJbmRleCA+IC0xLCBgJHt0YXJnZXR9IGRvZXMgbm90IGJlbG9uZyB0byAke3RhcmdldFBhcmVudC5zY2VuZUtleX1gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFjdGlvbi5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIGFjdGlvbi50YXJnZXRJbmRleCA9IHRhcmdldEluZGV4O1xuICAgICAgfVxuXG4gICAgICAvLyByZWN1cnNpdmUgcG9wIHBhcmVudFxuICAgICAgaWYgKEFjdGlvbk1hcFthY3Rpb24udHlwZV0gPT09IEFjdGlvbkNvbnN0LkJBQ0tfQUNUSU9OIHx8XG4gICAgICAgIEFjdGlvbk1hcFthY3Rpb24udHlwZV0gPT09IEFjdGlvbkNvbnN0LkJBQ0sgfHxcbiAgICAgICAgQWN0aW9uTWFwW2FjdGlvbi50eXBlXSA9PT0gQWN0aW9uQ29uc3QuQU5EUk9JRF9CQUNLIHx8XG4gICAgICAgIEFjdGlvbk1hcFthY3Rpb24udHlwZV0gPT09IEFjdGlvbkNvbnN0LlBPUF9BTkRfUkVQTEFDRSkge1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBhY3Rpb24ucGFyZW50IHx8IHN0YXRlLnNjZW5lc1thY3Rpb24ua2V5XS5wYXJlbnQ7XG4gICAgICAgIGxldCBlbCA9IGZpbmRFbGVtZW50KHN0YXRlLCBwYXJlbnQsIGFjdGlvbi50eXBlKTtcbiAgICAgICAgd2hpbGUgKGVsLnBhcmVudCAmJiAoZWwuY2hpbGRyZW4ubGVuZ3RoIDw9IDEgfHwgZWwudGFicykpIHtcbiAgICAgICAgICBlbCA9IGZpbmRFbGVtZW50KHN0YXRlLCBlbC5wYXJlbnQsIGFjdGlvbi50eXBlKTtcbiAgICAgICAgICBhc3NlcnQoZWwsIGBDYW5ub3QgZmluZCBlbGVtZW50IGZvciBwYXJlbnQ9JHtlbC5wYXJlbnR9IHdpdGhpbiBjdXJyZW50IHN0YXRlYCk7XG4gICAgICAgIH1cbiAgICAgICAgYWN0aW9uLnBhcmVudCA9IGVsLnNjZW5lS2V5O1xuICAgICAgfVxuICAgIH1cblxuICAgIHN3aXRjaCAoQWN0aW9uTWFwW2FjdGlvbi50eXBlXSkge1xuICAgICAgY2FzZSBBY3Rpb25Db25zdC5CQUNLOlxuICAgICAgY2FzZSBBY3Rpb25Db25zdC5CQUNLX0FDVElPTjpcbiAgICAgIGNhc2UgQWN0aW9uQ29uc3QuUE9QX0FORF9SRVBMQUNFOlxuICAgICAgY2FzZSBBY3Rpb25Db25zdC5QT1BfVE86XG4gICAgICBjYXNlIEFjdGlvbkNvbnN0LlJFRlJFU0g6XG4gICAgICBjYXNlIEFjdGlvbkNvbnN0LlBVU0g6XG4gICAgICBjYXNlIEFjdGlvbkNvbnN0LlBVU0hfT1JfUE9QOlxuICAgICAgY2FzZSBBY3Rpb25Db25zdC5KVU1QOlxuICAgICAgY2FzZSBBY3Rpb25Db25zdC5SRVBMQUNFOlxuICAgICAgY2FzZSBBY3Rpb25Db25zdC5SRVNFVDpcbiAgICAgIGNhc2UgQWN0aW9uQ29uc3QuQU5EUk9JRF9CQUNLOlxuICAgICAgICByZXR1cm4gdXBkYXRlKHN0YXRlLCBhY3Rpb24pO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gc3RhdGU7XG5cbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBkZWZhdWx0IHJlZHVjZXI7XG4iXX0=