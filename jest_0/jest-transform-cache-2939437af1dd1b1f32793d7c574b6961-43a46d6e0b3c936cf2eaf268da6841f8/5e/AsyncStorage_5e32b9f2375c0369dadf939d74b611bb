e5383b57a08dce2d8db6d8f2ef15c2c1













'use strict';var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[];var _n=true;var _d=false;var _e=undefined;try{for(var _i=arr[typeof Symbol==='function'?Symbol.iterator:'@@iterator'](),_s;!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"])_i["return"]();}finally{if(_d)throw _e;}}return _arr;}return function(arr,i){if(Array.isArray(arr)){return arr;}else if((typeof Symbol==='function'?Symbol.iterator:'@@iterator')in Object(arr)){return sliceIterator(arr,i);}else{throw new TypeError("Invalid attempt to destructure non-iterable instance");}};}();

var NativeModules=require('NativeModules');


var RCTAsyncStorage=NativeModules.AsyncRocksDBStorage||
NativeModules.AsyncSQLiteDBStorage||
NativeModules.AsyncLocalStorage;










































var AsyncStorage={
_getRequests:[],
_getKeys:[],
_immediate:null,









getItem:function getItem(
key,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiGet([key],function(errors,result){

var value=result&&result[0]&&result[0][1]?result[0][1]:null;
var errs=convertErrors(errors);
callback&&callback(errs&&errs[0],value);
if(errs){
reject(errs[0]);
}else{
resolve(value);
}
});
});
},









setItem:function setItem(
key,
value,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiSet([[key,value]],function(errors){
var errs=convertErrors(errors);
callback&&callback(errs&&errs[0]);
if(errs){
reject(errs[0]);
}else{
resolve(null);
}
});
});
},








removeItem:function removeItem(
key,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiRemove([key],function(errors){
var errs=convertErrors(errors);
callback&&callback(errs&&errs[0]);
if(errs){
reject(errs[0]);
}else{
resolve(null);
}
});
});
},




































mergeItem:function mergeItem(
key,
value,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiMerge([[key,value]],function(errors){
var errs=convertErrors(errors);
callback&&callback(errs&&errs[0]);
if(errs){
reject(errs[0]);
}else{
resolve(null);
}
});
});
},








clear:function clear(callback){
return new Promise(function(resolve,reject){
RCTAsyncStorage.clear(function(error){
callback&&callback(convertError(error));
if(error&&convertError(error)){
reject(convertError(error));
}else{
resolve(null);
}
});
});
},









getAllKeys:function getAllKeys(callback){
return new Promise(function(resolve,reject){
RCTAsyncStorage.getAllKeys(function(error,keys){
callback&&callback(convertError(error),keys);
if(error){
reject(convertError(error));
}else{
resolve(keys);
}
});
});
},












flushGetRequests:function flushGetRequests(){
var getRequests=this._getRequests;
var getKeys=this._getKeys;

this._getRequests=[];
this._getKeys=[];

RCTAsyncStorage.multiGet(getKeys,function(errors,result){






var map={};
result&&result.forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];map[key]=value;return value;});
var reqLength=getRequests.length;
for(var i=0;i<reqLength;i++){
var request=getRequests[i];
var requestKeys=request.keys;
var requestResult=requestKeys.map(function(key){return[key,map[key]];});
request.callback&&request.callback(null,requestResult);
request.resolve&&request.resolve(requestResult);
}
});
},





























multiGet:function multiGet(
keys,
callback)
{var _this=this;
if(!this._immediate){
this._immediate=setImmediate(function(){
_this._immediate=null;
_this.flushGetRequests();
});
}

var getRequest={
keys:keys,
callback:callback,

keyIndex:this._getKeys.length,
resolve:null,
reject:null};


var promiseResult=new Promise(function(resolve,reject){
getRequest.resolve=resolve;
getRequest.reject=reject;
});

this._getRequests.push(getRequest);

keys.forEach(function(key){
if(_this._getKeys.indexOf(key)===-1){
_this._getKeys.push(key);
}
});

return promiseResult;
},

















multiSet:function multiSet(
keyValuePairs,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiSet(keyValuePairs,function(errors){
var error=convertErrors(errors);
callback&&callback(error);
if(error){
reject(error);
}else{
resolve(null);
}
});
});
},

















multiRemove:function multiRemove(
keys,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiRemove(keys,function(errors){
var error=convertErrors(errors);
callback&&callback(error);
if(error){
reject(error);
}else{
resolve(null);
}
});
});
},



























































multiMerge:function multiMerge(
keyValuePairs,
callback)
{
return new Promise(function(resolve,reject){
RCTAsyncStorage.multiMerge(keyValuePairs,function(errors){
var error=convertErrors(errors);
callback&&callback(error);
if(error){
reject(error);
}else{
resolve(null);
}
});
});
}};



if(!RCTAsyncStorage.multiMerge){
delete AsyncStorage.mergeItem;
delete AsyncStorage.multiMerge;
}

function convertErrors(errs){
if(!errs){
return null;
}
return(Array.isArray(errs)?errs:[errs]).map(function(e){return convertError(e);});
}

function convertError(error){
if(!error){
return null;
}
var out=new Error(error.message);
out.key=error.key;
return out;
}

module.exports=AsyncStorage;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFzeW5jU3RvcmFnZS5qcyJdLCJuYW1lcyI6WyJOYXRpdmVNb2R1bGVzIiwicmVxdWlyZSIsIlJDVEFzeW5jU3RvcmFnZSIsIkFzeW5jUm9ja3NEQlN0b3JhZ2UiLCJBc3luY1NRTGl0ZURCU3RvcmFnZSIsIkFzeW5jTG9jYWxTdG9yYWdlIiwiQXN5bmNTdG9yYWdlIiwiX2dldFJlcXVlc3RzIiwiX2dldEtleXMiLCJfaW1tZWRpYXRlIiwiZ2V0SXRlbSIsImtleSIsImNhbGxiYWNrIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJtdWx0aUdldCIsImVycm9ycyIsInJlc3VsdCIsInZhbHVlIiwiZXJycyIsImNvbnZlcnRFcnJvcnMiLCJzZXRJdGVtIiwibXVsdGlTZXQiLCJyZW1vdmVJdGVtIiwibXVsdGlSZW1vdmUiLCJtZXJnZUl0ZW0iLCJtdWx0aU1lcmdlIiwiY2xlYXIiLCJlcnJvciIsImNvbnZlcnRFcnJvciIsImdldEFsbEtleXMiLCJrZXlzIiwiZmx1c2hHZXRSZXF1ZXN0cyIsImdldFJlcXVlc3RzIiwiZ2V0S2V5cyIsIm1hcCIsImZvckVhY2giLCJyZXFMZW5ndGgiLCJsZW5ndGgiLCJpIiwicmVxdWVzdCIsInJlcXVlc3RLZXlzIiwicmVxdWVzdFJlc3VsdCIsInNldEltbWVkaWF0ZSIsImdldFJlcXVlc3QiLCJrZXlJbmRleCIsInByb21pc2VSZXN1bHQiLCJwdXNoIiwiaW5kZXhPZiIsImtleVZhbHVlUGFpcnMiLCJBcnJheSIsImlzQXJyYXkiLCJlIiwib3V0IiwiRXJyb3IiLCJtZXNzYWdlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQWFBLGE7O0FBRUEsR0FBTUEsZUFBZ0JDLFFBQVEsZUFBUixDQUF0Qjs7O0FBR0EsR0FBTUMsaUJBQWtCRixjQUFjRyxtQkFBZDtBQUN0QkgsY0FBY0ksb0JBRFE7QUFFdEJKLGNBQWNLLGlCQUZoQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QXRCLENBQTZCO0FBQzNCLEdBQUksQ0FBQ0EsS0FBTCxDQUFZO0FBQ1YsTUFBTyxLQUFQO0FBQ0Q7QUFDRCxHQUFJeUIsS0FBTSxHQUFJQyxNQUFKLENBQVUxQixNQUFNMkIsT0FBaEIsQ0FBVjtBQUNBRixJQUFJM0MsR0FBSixDQUFVa0IsTUFBTWxCLEdBQWhCO0FBQ0EsTUFBTzJDLElBQVA7QUFDRDs7QUFFREcsT0FBT0MsT0FBUCxDQUFpQnBELFlBQWpCIiwiZmlsZSI6IkFzeW5jU3RvcmFnZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cbiAqXG4gKiBAcHJvdmlkZXNNb2R1bGUgQXN5bmNTdG9yYWdlXG4gKiBAbm9mbG93XG4gKiBAZmxvdy13ZWFrXG4gKiBAanNkb2NcbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBOYXRpdmVNb2R1bGVzID0gcmVxdWlyZSgnTmF0aXZlTW9kdWxlcycpO1xuXG4vLyBVc2UgUm9ja3NEQiBpZiBhdmFpbGFibGUsIHRoZW4gU1FMaXRlLCB0aGVuIGZpbGUgc3RvcmFnZS5cbmNvbnN0IFJDVEFzeW5jU3RvcmFnZSA9IE5hdGl2ZU1vZHVsZXMuQXN5bmNSb2Nrc0RCU3RvcmFnZSB8fFxuICBOYXRpdmVNb2R1bGVzLkFzeW5jU1FMaXRlREJTdG9yYWdlIHx8XG4gIE5hdGl2ZU1vZHVsZXMuQXN5bmNMb2NhbFN0b3JhZ2U7XG5cbi8qKlxuICogQGNsYXNzXG4gKiBAZGVzY3JpcHRpb25cbiAqIGBBc3luY1N0b3JhZ2VgIGlzIGEgc2ltcGxlLCB1bmVuY3J5cHRlZCwgYXN5bmNocm9ub3VzLCBwZXJzaXN0ZW50LCBrZXktdmFsdWUgc3RvcmFnZVxuICogc3lzdGVtIHRoYXQgaXMgZ2xvYmFsIHRvIHRoZSBhcHAuICBJdCBzaG91bGQgYmUgdXNlZCBpbnN0ZWFkIG9mIExvY2FsU3RvcmFnZS5cbiAqXG4gKiBJdCBpcyByZWNvbW1lbmRlZCB0aGF0IHlvdSB1c2UgYW4gYWJzdHJhY3Rpb24gb24gdG9wIG9mIGBBc3luY1N0b3JhZ2VgXG4gKiBpbnN0ZWFkIG9mIGBBc3luY1N0b3JhZ2VgIGRpcmVjdGx5IGZvciBhbnl0aGluZyBtb3JlIHRoYW4gbGlnaHQgdXNhZ2Ugc2luY2VcbiAqIGl0IG9wZXJhdGVzIGdsb2JhbGx5LlxuICpcbiAqIE9uIGlPUywgYEFzeW5jU3RvcmFnZWAgaXMgYmFja2VkIGJ5IG5hdGl2ZSBjb2RlIHRoYXQgc3RvcmVzIHNtYWxsIHZhbHVlcyBpbiBhXG4gKiBzZXJpYWxpemVkIGRpY3Rpb25hcnkgYW5kIGxhcmdlciB2YWx1ZXMgaW4gc2VwYXJhdGUgZmlsZXMuIE9uIEFuZHJvaWQsXG4gKiBgQXN5bmNTdG9yYWdlYCB3aWxsIHVzZSBlaXRoZXIgW1JvY2tzREJdKGh0dHA6Ly9yb2Nrc2RiLm9yZy8pIG9yIFNRTGl0ZVxuICogYmFzZWQgb24gd2hhdCBpcyBhdmFpbGFibGUuXG4gKlxuICogVGhlIGBBc3luY1N0b3JhZ2VgIEphdmFTY3JpcHQgY29kZSBpcyBhIHNpbXBsZSBmYWNhZGUgdGhhdCBwcm92aWRlcyBhIGNsZWFyXG4gKiBKYXZhU2NyaXB0IEFQSSwgcmVhbCBgRXJyb3JgIG9iamVjdHMsIGFuZCBzaW1wbGUgbm9uLW11bHRpIGZ1bmN0aW9ucy4gRWFjaFxuICogbWV0aG9kIGluIHRoZSBBUEkgcmV0dXJucyBhIGBQcm9taXNlYCBvYmplY3QuXG4gKlxuICogUGVyc2lzdGluZyBkYXRhOlxuICogYGBgXG4gKiB0cnkge1xuICogICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbSgnQE15U3VwZXJTdG9yZTprZXknLCAnSSBsaWtlIHRvIHNhdmUgaXQuJyk7XG4gKiB9IGNhdGNoIChlcnJvcikge1xuICogICAvLyBFcnJvciBzYXZpbmcgZGF0YVxuICogfVxuICogYGBgXG4gKlxuICogRmV0Y2hpbmcgZGF0YTpcbiAqIGBgYFxuICogdHJ5IHtcbiAqICAgY29uc3QgdmFsdWUgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbSgnQE15U3VwZXJTdG9yZTprZXknKTtcbiAqICAgaWYgKHZhbHVlICE9PSBudWxsKXtcbiAqICAgICAvLyBXZSBoYXZlIGRhdGEhIVxuICogICAgIGNvbnNvbGUubG9nKHZhbHVlKTtcbiAqICAgfVxuICogfSBjYXRjaCAoZXJyb3IpIHtcbiAqICAgLy8gRXJyb3IgcmV0cmlldmluZyBkYXRhXG4gKiB9XG4gKiBgYGBcbiAqL1xudmFyIEFzeW5jU3RvcmFnZSA9IHtcbiAgX2dldFJlcXVlc3RzOiAoW106IEFycmF5PGFueT4pLFxuICBfZ2V0S2V5czogKFtdOiBBcnJheTxzdHJpbmc+KSxcbiAgX2ltbWVkaWF0ZTogKG51bGw6ID9udW1iZXIpLFxuXG4gIC8qKlxuICAgKiBGZXRjaGVzIGFuIGl0ZW0gZm9yIGEgYGtleWAgYW5kIGludm9rZXMgYSBjYWxsYmFjayB1cG9uIGNvbXBsZXRpb24uXG4gICAqIFJldHVybnMgYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKiBAcGFyYW0ga2V5IEtleSBvZiB0aGUgaXRlbSB0byBmZXRjaC5cbiAgICogQHBhcmFtIGNhbGxiYWNrIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2l0aCBhIHJlc3VsdCBpZiBmb3VuZCBvclxuICAgKiAgICBhbnkgZXJyb3IuXG4gICAqIEByZXR1cm5zIEEgYFByb21pc2VgIG9iamVjdC5cbiAgICovXG4gIGdldEl0ZW06IGZ1bmN0aW9uKFxuICAgIGtleTogc3RyaW5nLFxuICAgIGNhbGxiYWNrPzogPyhlcnJvcjogP0Vycm9yLCByZXN1bHQ6ID9zdHJpbmcpID0+IHZvaWRcbiAgKTogUHJvbWlzZSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIFJDVEFzeW5jU3RvcmFnZS5tdWx0aUdldChba2V5XSwgZnVuY3Rpb24oZXJyb3JzLCByZXN1bHQpIHtcbiAgICAgICAgLy8gVW5wYWNrIHJlc3VsdCB0byBnZXQgdmFsdWUgZnJvbSBbW2tleSx2YWx1ZV1dXG4gICAgICAgIHZhciB2YWx1ZSA9IChyZXN1bHQgJiYgcmVzdWx0WzBdICYmIHJlc3VsdFswXVsxXSkgPyByZXN1bHRbMF1bMV0gOiBudWxsO1xuICAgICAgICB2YXIgZXJycyA9IGNvbnZlcnRFcnJvcnMoZXJyb3JzKTtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZXJycyAmJiBlcnJzWzBdLCB2YWx1ZSk7XG4gICAgICAgIGlmIChlcnJzKSB7XG4gICAgICAgICAgcmVqZWN0KGVycnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUodmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogU2V0cyB0aGUgdmFsdWUgZm9yIGEgYGtleWAgYW5kIGludm9rZXMgYSBjYWxsYmFjayB1cG9uIGNvbXBsZXRpb24uXG4gICAqIFJldHVybnMgYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKiBAcGFyYW0ga2V5IEtleSBvZiB0aGUgaXRlbSB0byBzZXQuXG4gICAqIEBwYXJhbSB2YWx1ZSBWYWx1ZSB0byBzZXQgZm9yIHRoZSBga2V5YC5cbiAgICogQHBhcmFtIGNhbGxiYWNrIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2l0aCBhbnkgZXJyb3IuXG4gICAqIEByZXR1cm5zIEEgYFByb21pc2VgIG9iamVjdC5cbiAgICovXG4gIHNldEl0ZW06IGZ1bmN0aW9uKFxuICAgIGtleTogc3RyaW5nLFxuICAgIHZhbHVlOiBzdHJpbmcsXG4gICAgY2FsbGJhY2s/OiA/KGVycm9yOiA/RXJyb3IpID0+IHZvaWRcbiAgKTogUHJvbWlzZSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIFJDVEFzeW5jU3RvcmFnZS5tdWx0aVNldChbW2tleSx2YWx1ZV1dLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgdmFyIGVycnMgPSBjb252ZXJ0RXJyb3JzKGVycm9ycyk7XG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycnMgJiYgZXJyc1swXSk7XG4gICAgICAgIGlmIChlcnJzKSB7XG4gICAgICAgICAgcmVqZWN0KGVycnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBSZW1vdmVzIGFuIGl0ZW0gZm9yIGEgYGtleWAgYW5kIGludm9rZXMgYSBjYWxsYmFjayB1cG9uIGNvbXBsZXRpb24uXG4gICAqIFJldHVybnMgYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKiBAcGFyYW0ga2V5IEtleSBvZiB0aGUgaXRlbSB0byByZW1vdmUuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdpdGggYW55IGVycm9yLlxuICAgKiBAcmV0dXJucyBBIGBQcm9taXNlYCBvYmplY3QuXG4gICAqL1xuICByZW1vdmVJdGVtOiBmdW5jdGlvbihcbiAgICBrZXk6IHN0cmluZyxcbiAgICBjYWxsYmFjaz86ID8oZXJyb3I6ID9FcnJvcikgPT4gdm9pZFxuICApOiBQcm9taXNlIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgUkNUQXN5bmNTdG9yYWdlLm11bHRpUmVtb3ZlKFtrZXldLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgdmFyIGVycnMgPSBjb252ZXJ0RXJyb3JzKGVycm9ycyk7XG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycnMgJiYgZXJyc1swXSk7XG4gICAgICAgIGlmIChlcnJzKSB7XG4gICAgICAgICAgcmVqZWN0KGVycnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBNZXJnZXMgYW4gZXhpc3RpbmcgYGtleWAgdmFsdWUgd2l0aCBhbiBpbnB1dCB2YWx1ZSwgYXNzdW1pbmcgYm90aCB2YWx1ZXNcbiAgICogYXJlIHN0cmluZ2lmaWVkIEpTT04uIFJldHVybnMgYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKlxuICAgKiAqKk5PVEU6KiogVGhpcyBpcyBub3Qgc3VwcG9ydGVkIGJ5IGFsbCBuYXRpdmUgaW1wbGVtZW50YXRpb25zLlxuICAgKlxuICAgKiBAcGFyYW0ga2V5IEtleSBvZiB0aGUgaXRlbSB0byBtb2RpZnkuXG4gICAqIEBwYXJhbSB2YWx1ZSBOZXcgdmFsdWUgdG8gbWVyZ2UgZm9yIHRoZSBga2V5YC5cbiAgICogQHBhcmFtIGNhbGxiYWNrIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2l0aCBhbnkgZXJyb3IuXG4gICAqIEByZXR1cm5zIEEgYFByb21pc2VgIG9iamVjdC5cbiAgICpcbiAgICogQGV4YW1wbGUgPGNhcHRpb24+RXhhbXBsZTwvY2FwdGlvbj5cbiAgICogbGV0IFVJRDEyM19vYmplY3QgPSB7XG4gICAqICBuYW1lOiAnQ2hyaXMnLFxuICAgKiAgYWdlOiAzMCxcbiAgICogIHRyYWl0czoge2hhaXI6ICdicm93bicsIGV5ZXM6ICdicm93bid9LFxuICAgKiB9O1xuICAgKiAvLyBZb3Ugb25seSBuZWVkIHRvIGRlZmluZSB3aGF0IHdpbGwgYmUgYWRkZWQgb3IgdXBkYXRlZFxuICAgKiBsZXQgVUlEMTIzX2RlbHRhID0ge1xuICAgKiAgYWdlOiAzMSxcbiAgICogIHRyYWl0czoge2V5ZXM6ICdibHVlJywgc2hvZV9zaXplOiAxMH1cbiAgICogfTtcbiAgICpcbiAgICogQXN5bmNTdG9yYWdlLnNldEl0ZW0oJ1VJRDEyMycsIEpTT04uc3RyaW5naWZ5KFVJRDEyM19vYmplY3QpLCAoKSA9PiB7XG4gICAqICAgQXN5bmNTdG9yYWdlLm1lcmdlSXRlbSgnVUlEMTIzJywgSlNPTi5zdHJpbmdpZnkoVUlEMTIzX2RlbHRhKSwgKCkgPT4ge1xuICAgKiAgICAgQXN5bmNTdG9yYWdlLmdldEl0ZW0oJ1VJRDEyMycsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgKiAgICAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgKiAgICAgfSk7XG4gICAqICAgfSk7XG4gICAqIH0pO1xuICAgKlxuICAgKiAvLyBDb25zb2xlIGxvZyByZXN1bHQ6XG4gICAqIC8vID0+IHsnbmFtZSc6J0NocmlzJywnYWdlJzozMSwndHJhaXRzJzpcbiAgICogLy8gICAgeydzaG9lX3NpemUnOjEwLCdoYWlyJzonYnJvd24nLCdleWVzJzonYmx1ZSd9fVxuICAgKi9cbiAgbWVyZ2VJdGVtOiBmdW5jdGlvbihcbiAgICBrZXk6IHN0cmluZyxcbiAgICB2YWx1ZTogc3RyaW5nLFxuICAgIGNhbGxiYWNrPzogPyhlcnJvcjogP0Vycm9yKSA9PiB2b2lkXG4gICk6IFByb21pc2Uge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlNZXJnZShbW2tleSx2YWx1ZV1dLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgdmFyIGVycnMgPSBjb252ZXJ0RXJyb3JzKGVycm9ycyk7XG4gICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGVycnMgJiYgZXJyc1swXSk7XG4gICAgICAgIGlmIChlcnJzKSB7XG4gICAgICAgICAgcmVqZWN0KGVycnNbMF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBFcmFzZXMgKmFsbCogYEFzeW5jU3RvcmFnZWAgZm9yIGFsbCBjbGllbnRzLCBsaWJyYXJpZXMsIGV0Yy4gIFlvdSBwcm9iYWJseVxuICAgKiBkb24ndCB3YW50IHRvIGNhbGwgdGhpczsgdXNlIGByZW1vdmVJdGVtYCBvciBgbXVsdGlSZW1vdmVgIHRvIGNsZWFyIG9ubHlcbiAgICogeW91ciBhcHAncyBrZXlzLiBSZXR1cm5zIGEgYFByb21pc2VgIG9iamVjdC5cbiAgICogQHBhcmFtIGNhbGxiYWNrIEZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBjYWxsZWQgd2l0aCBhbnkgZXJyb3IuXG4gICAqIEByZXR1cm5zIEEgYFByb21pc2VgIG9iamVjdC5cbiAgICovXG4gIGNsZWFyOiBmdW5jdGlvbihjYWxsYmFjaz86ID8oZXJyb3I6ID9FcnJvcikgPT4gdm9pZCk6IFByb21pc2Uge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UuY2xlYXIoZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soY29udmVydEVycm9yKGVycm9yKSk7XG4gICAgICAgIGlmIChlcnJvciAmJiBjb252ZXJ0RXJyb3IoZXJyb3IpKXtcbiAgICAgICAgICByZWplY3QoY29udmVydEVycm9yKGVycm9yKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEdldHMgKmFsbCoga2V5cyBrbm93biB0byB5b3VyIGFwcDsgZm9yIGFsbCBjYWxsZXJzLCBsaWJyYXJpZXMsIGV0Yy5cbiAgICogUmV0dXJucyBhIGBQcm9taXNlYCBvYmplY3QuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHRoZSBrZXlzIGZvdW5kIGFuZCBhbnkgZXJyb3IuXG4gICAqIEByZXR1cm5zIEEgYFByb21pc2VgIG9iamVjdC5cbiAgICpcbiAgICogRXhhbXBsZTogc2VlIHRoZSBgbXVsdGlHZXRgIGV4YW1wbGUuXG4gICAqL1xuICBnZXRBbGxLZXlzOiBmdW5jdGlvbihjYWxsYmFjaz86ID8oZXJyb3I6ID9FcnJvciwga2V5czogP0FycmF5PHN0cmluZz4pID0+IHZvaWQpOiBQcm9taXNlIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgUkNUQXN5bmNTdG9yYWdlLmdldEFsbEtleXMoZnVuY3Rpb24oZXJyb3IsIGtleXMpIHtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soY29udmVydEVycm9yKGVycm9yKSwga2V5cyk7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChjb252ZXJ0RXJyb3IoZXJyb3IpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXNvbHZlKGtleXMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSxcblxuICAvKipcbiAgICogVGhlIGZvbGxvd2luZyBiYXRjaGVkIGZ1bmN0aW9ucyBhcmUgdXNlZnVsIGZvciBleGVjdXRpbmcgYSBsb3Qgb2ZcbiAgICogb3BlcmF0aW9ucyBhdCBvbmNlLCBhbGxvd2luZyBmb3IgbmF0aXZlIG9wdGltaXphdGlvbnMgYW5kIHByb3ZpZGUgdGhlXG4gICAqIGNvbnZlbmllbmNlIG9mIGEgc2luZ2xlIGNhbGxiYWNrIGFmdGVyIGFsbCBvcGVyYXRpb25zIGFyZSBjb21wbGV0ZS5cbiAgICpcbiAgICogVGhlc2UgZnVuY3Rpb25zIHJldHVybiBhcnJheXMgb2YgZXJyb3JzLCBwb3RlbnRpYWxseSBvbmUgZm9yIGV2ZXJ5IGtleS5cbiAgICogRm9yIGtleS1zcGVjaWZpYyBlcnJvcnMsIHRoZSBFcnJvciBvYmplY3Qgd2lsbCBoYXZlIGEga2V5IHByb3BlcnR5IHRvXG4gICAqIGluZGljYXRlIHdoaWNoIGtleSBjYXVzZWQgdGhlIGVycm9yLlxuICAgKi9cblxuICAvKiogRmx1c2hlcyBhbnkgcGVuZGluZyByZXF1ZXN0cyB1c2luZyBhIHNpbmdsZSBiYXRjaCBjYWxsIHRvIGdldCB0aGUgZGF0YS4gKi9cbiAgZmx1c2hHZXRSZXF1ZXN0czogZnVuY3Rpb24oKTogdm9pZCB7XG4gICAgY29uc3QgZ2V0UmVxdWVzdHMgPSB0aGlzLl9nZXRSZXF1ZXN0cztcbiAgICBjb25zdCBnZXRLZXlzID0gdGhpcy5fZ2V0S2V5cztcblxuICAgIHRoaXMuX2dldFJlcXVlc3RzID0gW107XG4gICAgdGhpcy5fZ2V0S2V5cyA9IFtdO1xuXG4gICAgUkNUQXN5bmNTdG9yYWdlLm11bHRpR2V0KGdldEtleXMsIGZ1bmN0aW9uKGVycm9ycywgcmVzdWx0KSB7XG4gICAgICAvLyBFdmVuIHRob3VnaCB0aGUgcnVudGltZSBjb21wbGV4aXR5IG9mIHRoaXMgaXMgdGhlb3JldGljYWxseSB3b3JzZSB2cyBpZiB3ZSB1c2VkIGEgbWFwLFxuICAgICAgLy8gaXQncyBtdWNoLCBtdWNoIGZhc3RlciBpbiBwcmFjdGljZSBmb3IgdGhlIGRhdGEgc2V0cyB3ZSBkZWFsIHdpdGggKHdlIGF2b2lkXG4gICAgICAvLyBhbGxvY2F0aW5nIHJlc3VsdCBwYWlyIGFycmF5cykuIFRoaXMgd2FzIGhlYXZpbHkgYmVuY2htYXJrZWQuXG4gICAgICAvL1xuICAgICAgLy8gSXMgdGhlcmUgYSB3YXkgdG8gYXZvaWQgdXNpbmcgdGhlIG1hcCBidXQgZml4IHRoZSBidWcgaW4gdGhpcyBicmVha2luZyB0ZXN0P1xuICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL3JlYWN0LW5hdGl2ZS9jb21taXQvOGRkOGFkNzY1NzlkN2ZlZWYzNGMwMTRkMzg3YmYwMjA2NTY5MjI2NFxuICAgICAgY29uc3QgbWFwID0ge307XG4gICAgICByZXN1bHQgJiYgcmVzdWx0LmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4geyBtYXBba2V5XSA9IHZhbHVlOyByZXR1cm4gdmFsdWU7IH0pO1xuICAgICAgY29uc3QgcmVxTGVuZ3RoID0gZ2V0UmVxdWVzdHMubGVuZ3RoO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXFMZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gZ2V0UmVxdWVzdHNbaV07XG4gICAgICAgIGNvbnN0IHJlcXVlc3RLZXlzID0gcmVxdWVzdC5rZXlzO1xuICAgICAgICBjb25zdCByZXF1ZXN0UmVzdWx0ID0gcmVxdWVzdEtleXMubWFwKGtleSA9PiBba2V5LCBtYXBba2V5XV0pO1xuICAgICAgICByZXF1ZXN0LmNhbGxiYWNrICYmIHJlcXVlc3QuY2FsbGJhY2sobnVsbCwgcmVxdWVzdFJlc3VsdCk7XG4gICAgICAgIHJlcXVlc3QucmVzb2x2ZSAmJiByZXF1ZXN0LnJlc29sdmUocmVxdWVzdFJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFRoaXMgYWxsb3dzIHlvdSB0byBiYXRjaCB0aGUgZmV0Y2hpbmcgb2YgaXRlbXMgZ2l2ZW4gYW4gYXJyYXkgb2YgYGtleWBcbiAgICogaW5wdXRzLiBZb3VyIGNhbGxiYWNrIHdpbGwgYmUgaW52b2tlZCB3aXRoIGFuIGFycmF5IG9mIGNvcnJlc3BvbmRpbmdcbiAgICoga2V5LXZhbHVlIHBhaXJzIGZvdW5kOlxuICAgKlxuICAgKiBgYGBcbiAgICogbXVsdGlHZXQoWydrMScsICdrMiddLCBjYikgLT4gY2IoW1snazEnLCAndmFsMSddLCBbJ2syJywgJ3ZhbDInXV0pXG4gICAqIGBgYFxuICAgKlxuICAgKiBUaGUgbWV0aG9kIHJldHVybnMgYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0ga2V5cyBBcnJheSBvZiBrZXkgZm9yIHRoZSBpdGVtcyB0byBnZXQuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdpdGggYSBrZXktdmFsdWUgYXJyYXkgb2ZcbiAgICogICAgIHRoZSByZXN1bHRzLCBwbHVzIGFuIGFycmF5IG9mIGFueSBrZXktc3BlY2lmaWMgZXJyb3JzIGZvdW5kLlxuICAgKiBAcmV0dXJucyBBIGBQcm9taXNlYCBvYmplY3QuXG4gICAqXG4gICAqIEBleGFtcGxlIDxjYXB0aW9uPkV4YW1wbGU8L2NhcHRpb24+XG4gICAqXG4gICAqIEFzeW5jU3RvcmFnZS5nZXRBbGxLZXlzKChlcnIsIGtleXMpID0+IHtcbiAgICogICBBc3luY1N0b3JhZ2UubXVsdGlHZXQoa2V5cywgKGVyciwgc3RvcmVzKSA9PiB7XG4gICAqICAgIHN0b3Jlcy5tYXAoKHJlc3VsdCwgaSwgc3RvcmUpID0+IHtcbiAgICogICAgICAvLyBnZXQgYXQgZWFjaCBzdG9yZSdzIGtleS92YWx1ZSBzbyB5b3UgY2FuIHdvcmsgd2l0aCBpdFxuICAgKiAgICAgIGxldCBrZXkgPSBzdG9yZVtpXVswXTtcbiAgICogICAgICBsZXQgdmFsdWUgPSBzdG9yZVtpXVsxXTtcbiAgICogICAgIH0pO1xuICAgKiAgIH0pO1xuICAgKiB9KTtcbiAgICovXG4gIG11bHRpR2V0OiBmdW5jdGlvbihcbiAgICBrZXlzOiBBcnJheTxzdHJpbmc+LFxuICAgIGNhbGxiYWNrPzogPyhlcnJvcnM6ID9BcnJheTxFcnJvcj4sIHJlc3VsdDogP0FycmF5PEFycmF5PHN0cmluZz4+KSA9PiB2b2lkXG4gICk6IFByb21pc2Uge1xuICAgIGlmICghdGhpcy5faW1tZWRpYXRlKSB7XG4gICAgICB0aGlzLl9pbW1lZGlhdGUgPSBzZXRJbW1lZGlhdGUoKCkgPT4ge1xuICAgICAgICB0aGlzLl9pbW1lZGlhdGUgPSBudWxsO1xuICAgICAgICB0aGlzLmZsdXNoR2V0UmVxdWVzdHMoKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHZhciBnZXRSZXF1ZXN0ID0ge1xuICAgICAga2V5czoga2V5cyxcbiAgICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcbiAgICAgIC8vIGRvIHdlIG5lZWQgdGhpcz9cbiAgICAgIGtleUluZGV4OiB0aGlzLl9nZXRLZXlzLmxlbmd0aCxcbiAgICAgIHJlc29sdmU6IG51bGwsXG4gICAgICByZWplY3Q6IG51bGwsXG4gICAgfTtcblxuICAgIHZhciBwcm9taXNlUmVzdWx0ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZ2V0UmVxdWVzdC5yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgIGdldFJlcXVlc3QucmVqZWN0ID0gcmVqZWN0O1xuICAgIH0pO1xuXG4gICAgdGhpcy5fZ2V0UmVxdWVzdHMucHVzaChnZXRSZXF1ZXN0KTtcbiAgICAvLyBhdm9pZCBmZXRjaGluZyBkdXBsaWNhdGVzXG4gICAga2V5cy5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBpZiAodGhpcy5fZ2V0S2V5cy5pbmRleE9mKGtleSkgPT09IC0xKSB7XG4gICAgICAgIHRoaXMuX2dldEtleXMucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHByb21pc2VSZXN1bHQ7XG4gIH0sXG5cbiAgLyoqXG4gICAqIFVzZSB0aGlzIGFzIGEgYmF0Y2ggb3BlcmF0aW9uIGZvciBzdG9yaW5nIG11bHRpcGxlIGtleS12YWx1ZSBwYWlycy4gV2hlblxuICAgKiB0aGUgb3BlcmF0aW9uIGNvbXBsZXRlcyB5b3UnbGwgZ2V0IGEgc2luZ2xlIGNhbGxiYWNrIHdpdGggYW55IGVycm9yczpcbiAgICpcbiAgICogYGBgXG4gICAqIG11bHRpU2V0KFtbJ2sxJywgJ3ZhbDEnXSwgWydrMicsICd2YWwyJ11dLCBjYik7XG4gICAqIGBgYFxuICAgKlxuICAgKiBUaGUgbWV0aG9kIHJldHVybnMgYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0ga2V5VmFsdWVQYWlycyBBcnJheSBvZiBrZXktdmFsdWUgYXJyYXkgZm9yIHRoZSBpdGVtcyB0byBzZXQuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHdpdGggYW4gYXJyYXkgb2YgYW55XG4gICAqICAgIGtleS1zcGVjaWZpYyBlcnJvcnMgZm91bmQuXG4gICAqIEByZXR1cm5zIEEgYFByb21pc2VgIG9iamVjdC5cbiAgICogRXhhbXBsZTogc2VlIHRoZSBgbXVsdGlNZXJnZWAgZXhhbXBsZS5cbiAgICovXG4gIG11bHRpU2V0OiBmdW5jdGlvbihcbiAgICBrZXlWYWx1ZVBhaXJzOiBBcnJheTxBcnJheTxzdHJpbmc+PixcbiAgICBjYWxsYmFjaz86ID8oZXJyb3JzOiA/QXJyYXk8RXJyb3I+KSA9PiB2b2lkXG4gICk6IFByb21pc2Uge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlTZXQoa2V5VmFsdWVQYWlycywgZnVuY3Rpb24oZXJyb3JzKSB7XG4gICAgICAgIHZhciBlcnJvciA9IGNvbnZlcnRFcnJvcnMoZXJyb3JzKTtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soZXJyb3IpO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBDYWxsIHRoaXMgdG8gYmF0Y2ggdGhlIGRlbGV0aW9uIG9mIGFsbCBrZXlzIGluIHRoZSBga2V5c2AgYXJyYXkuIFJldHVybnNcbiAgICogYSBgUHJvbWlzZWAgb2JqZWN0LlxuICAgKlxuICAgKiBAcGFyYW0ga2V5cyBBcnJheSBvZiBrZXkgZm9yIHRoZSBpdGVtcyB0byBkZWxldGUuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBGdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIGFuIGFycmF5IG9mIGFueSBrZXktc3BlY2lmaWNcbiAgICogICAgZXJyb3JzIGZvdW5kLlxuICAgKiBAcmV0dXJucyBBIGBQcm9taXNlYCBvYmplY3QuXG4gICAqXG4gICAqIEBleGFtcGxlIDxjYXB0aW9uPkV4YW1wbGU8L2NhcHRpb24+XG4gICAqIGxldCBrZXlzID0gWydrMScsICdrMiddO1xuICAgKiBBc3luY1N0b3JhZ2UubXVsdGlSZW1vdmUoa2V5cywgKGVycikgPT4ge1xuICAgKiAgIC8vIGtleXMgazEgJiBrMiByZW1vdmVkLCBpZiB0aGV5IGV4aXN0ZWRcbiAgICogICAvLyBkbyBtb3N0IHN0dWZmIGFmdGVyIHJlbW92YWwgKGlmIHlvdSB3YW50KVxuICAgKiB9KTtcbiAgICovXG4gIG11bHRpUmVtb3ZlOiBmdW5jdGlvbihcbiAgICBrZXlzOiBBcnJheTxzdHJpbmc+LFxuICAgIGNhbGxiYWNrPzogPyhlcnJvcnM6ID9BcnJheTxFcnJvcj4pID0+IHZvaWRcbiAgKTogUHJvbWlzZSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIFJDVEFzeW5jU3RvcmFnZS5tdWx0aVJlbW92ZShrZXlzLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgdmFyIGVycm9yID0gY29udmVydEVycm9ycyhlcnJvcnMpO1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlcnJvcik7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG5cbiAgLyoqXG4gICAqIEJhdGNoIG9wZXJhdGlvbiB0byBtZXJnZSBpbiBleGlzdGluZyBhbmQgbmV3IHZhbHVlcyBmb3IgYSBnaXZlbiBzZXQgb2ZcbiAgICoga2V5cy4gVGhpcyBhc3N1bWVzIHRoYXQgdGhlIHZhbHVlcyBhcmUgc3RyaW5naWZpZWQgSlNPTi4gUmV0dXJucyBhXG4gICAqIGBQcm9taXNlYCBvYmplY3QuXG4gICAqXG4gICAqICoqTk9URSoqOiBUaGlzIGlzIG5vdCBzdXBwb3J0ZWQgYnkgYWxsIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMuXG4gICAqXG4gICAqIEBwYXJhbSBrZXlWYWx1ZVBhaXJzIEFycmF5IG9mIGtleS12YWx1ZSBhcnJheSBmb3IgdGhlIGl0ZW1zIHRvIG1lcmdlLlxuICAgKiBAcGFyYW0gY2FsbGJhY2sgRnVuY3Rpb24gdGhhdCB3aWxsIGJlIGNhbGxlZCB3aXRoIGFuIGFycmF5IG9mIGFueVxuICAgKiAgICBrZXktc3BlY2lmaWMgZXJyb3JzIGZvdW5kLlxuICAgKiBAcmV0dXJucyBBIGBQcm9taXNlYCBvYmplY3QuXG4gICAqXG4gICAqIEBleGFtcGxlIDxjYXB0aW9uPkV4YW1wbGU8L2NhcHRpb24+XG4gICAqIC8vIGZpcnN0IHVzZXIsIGluaXRpYWwgdmFsdWVzXG4gICAqIGxldCBVSUQyMzRfb2JqZWN0ID0ge1xuICAgKiAgbmFtZTogJ0NocmlzJyxcbiAgICogIGFnZTogMzAsXG4gICAqICB0cmFpdHM6IHtoYWlyOiAnYnJvd24nLCBleWVzOiAnYnJvd24nfSxcbiAgICogfTtcbiAgICpcbiAgICogLy8gZmlyc3QgdXNlciwgZGVsdGEgdmFsdWVzXG4gICAqIGxldCBVSUQyMzRfZGVsdGEgPSB7XG4gICAqICBhZ2U6IDMxLFxuICAgKiAgdHJhaXRzOiB7ZXllczogJ2JsdWUnLCBzaG9lX3NpemU6IDEwfSxcbiAgICogfTtcbiAgICpcbiAgICogLy8gc2Vjb25kIHVzZXIsIGluaXRpYWwgdmFsdWVzXG4gICAqIGxldCBVSUQzNDVfb2JqZWN0ID0ge1xuICAgKiAgbmFtZTogJ01hcmdlJyxcbiAgICogIGFnZTogMjUsXG4gICAqICB0cmFpdHM6IHtoYWlyOiAnYmxvbmRlJywgZXllczogJ2JsdWUnfSxcbiAgICogfTtcbiAgICpcbiAgICogLy8gc2Vjb25kIHVzZXIsIGRlbHRhIHZhbHVlc1xuICAgKiBsZXQgVUlEMzQ1X2RlbHRhID0ge1xuICAgKiAgYWdlOiAyNixcbiAgICogIHRyYWl0czoge2V5ZXM6ICdncmVlbicsIHNob2Vfc2l6ZTogNn0sXG4gICAqIH07XG4gICAqXG4gICAqIGxldCBtdWx0aV9zZXRfcGFpcnMgICA9IFtbJ1VJRDIzNCcsIEpTT04uc3RyaW5naWZ5KFVJRDIzNF9vYmplY3QpXSwgWydVSUQzNDUnLCBKU09OLnN0cmluZ2lmeShVSUQzNDVfb2JqZWN0KV1dXG4gICAqIGxldCBtdWx0aV9tZXJnZV9wYWlycyA9IFtbJ1VJRDIzNCcsIEpTT04uc3RyaW5naWZ5KFVJRDIzNF9kZWx0YSldLCBbJ1VJRDM0NScsIEpTT04uc3RyaW5naWZ5KFVJRDM0NV9kZWx0YSldXVxuICAgKlxuICAgKiBBc3luY1N0b3JhZ2UubXVsdGlTZXQobXVsdGlfc2V0X3BhaXJzLCAoZXJyKSA9PiB7XG4gICAqICAgQXN5bmNTdG9yYWdlLm11bHRpTWVyZ2UobXVsdGlfbWVyZ2VfcGFpcnMsIChlcnIpID0+IHtcbiAgICogICAgIEFzeW5jU3RvcmFnZS5tdWx0aUdldChbJ1VJRDIzNCcsJ1VJRDM0NSddLCAoZXJyLCBzdG9yZXMpID0+IHtcbiAgICogICAgICAgc3RvcmVzLm1hcCggKHJlc3VsdCwgaSwgc3RvcmUpID0+IHtcbiAgICogICAgICAgICBsZXQga2V5ID0gc3RvcmVbaV1bMF07XG4gICAqICAgICAgICAgbGV0IHZhbCA9IHN0b3JlW2ldWzFdO1xuICAgKiAgICAgICAgIGNvbnNvbGUubG9nKGtleSwgdmFsKTtcbiAgICogICAgICAgfSk7XG4gICAqICAgICB9KTtcbiAgICogICB9KTtcbiAgICogfSk7XG4gICAqXG4gICAqIC8vIENvbnNvbGUgbG9nIHJlc3VsdHM6XG4gICAqIC8vID0+IFVJRDIzNCB7XCJuYW1lXCI6XCJDaHJpc1wiLFwiYWdlXCI6MzEsXCJ0cmFpdHNcIjp7XCJzaG9lX3NpemVcIjoxMCxcImhhaXJcIjpcImJyb3duXCIsXCJleWVzXCI6XCJibHVlXCJ9fVxuICAgKiAvLyA9PiBVSUQzNDUge1wibmFtZVwiOlwiTWFyZ2VcIixcImFnZVwiOjI2LFwidHJhaXRzXCI6e1wic2hvZV9zaXplXCI6NixcImhhaXJcIjpcImJsb25kZVwiLFwiZXllc1wiOlwiZ3JlZW5cIn19XG4gICAqL1xuICBtdWx0aU1lcmdlOiBmdW5jdGlvbihcbiAgICBrZXlWYWx1ZVBhaXJzOiBBcnJheTxBcnJheTxzdHJpbmc+PixcbiAgICBjYWxsYmFjaz86ID8oZXJyb3JzOiA/QXJyYXk8RXJyb3I+KSA9PiB2b2lkXG4gICk6IFByb21pc2Uge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBSQ1RBc3luY1N0b3JhZ2UubXVsdGlNZXJnZShrZXlWYWx1ZVBhaXJzLCBmdW5jdGlvbihlcnJvcnMpIHtcbiAgICAgICAgdmFyIGVycm9yID0gY29udmVydEVycm9ycyhlcnJvcnMpO1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhlcnJvcik7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG59O1xuXG4vLyBOb3QgYWxsIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbnMgc3VwcG9ydCBtZXJnZS5cbmlmICghUkNUQXN5bmNTdG9yYWdlLm11bHRpTWVyZ2UpIHtcbiAgZGVsZXRlIEFzeW5jU3RvcmFnZS5tZXJnZUl0ZW07XG4gIGRlbGV0ZSBBc3luY1N0b3JhZ2UubXVsdGlNZXJnZTtcbn1cblxuZnVuY3Rpb24gY29udmVydEVycm9ycyhlcnJzKSB7XG4gIGlmICghZXJycykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiAoQXJyYXkuaXNBcnJheShlcnJzKSA/IGVycnMgOiBbZXJyc10pLm1hcCgoZSkgPT4gY29udmVydEVycm9yKGUpKTtcbn1cblxuZnVuY3Rpb24gY29udmVydEVycm9yKGVycm9yKSB7XG4gIGlmICghZXJyb3IpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICB2YXIgb3V0ID0gbmV3IEVycm9yKGVycm9yLm1lc3NhZ2UpO1xuICBvdXQua2V5ID0gZXJyb3Iua2V5OyAvLyBmbG93IGRvZXNuJ3QgbGlrZSB0aGlzIDooXG4gIHJldHVybiBvdXQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQXN5bmNTdG9yYWdlO1xuIl19